(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-50856f1c"],{"034d":function(e,t,a){},"0798":function(e,t,a){},"0825":function(e,t,a){"use strict";a("0b39")},"0b39":function(e,t,a){},"0cbd":function(e,t,a){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",{class:["portal-add-popup",e.checkBoxClass]},[t("el-dialog",{staticClass:"search",attrs:{title:e.addForm.title,visible:e.searchVisible,width:"800px","close-on-click-modal":!1,"before-close":e.cancel},on:{"update:visible":function(t){e.searchVisible=t}}},[e.isShowSearch?t("portal-form",{ref:"searchList",attrs:{"form-data":e.formData,"form-config-list":e.formConfigList,needOperateBtn:!0,"form-rules":e.tempFormRules,searchBtnLoading:e.searchLoading,needBottomLine:!0,smallAutoColumn:e.smallAutoColumn,bigAutoColumn:e.bigAutoColumn},on:{"common-enter-event":e.search,"reset-btn-click":e.reset,"search-btn-click":e.search}}):e._e(),t("table-page",{ref:"data-table",attrs:{size:"small",isSingleCheck:e.isSingleCheck,"is-check":e.isCheck,"is-check-memory":!0,"is-search":e.refreshTableFlag,"has-pagination":e.hasPagination,columns:e.addForm.columns,pagination:e.paginationConfig,getTableData:e.getTableData,"init-checks":e.multipleChecks,"id-key":e.addForm.idKey},on:{fetchData:e.fetchData,"selection-change":e.onSelectionChange,"single-selection-change":e.singelSekectionChange},scopedSlots:e._u([e._l(e.addForm.columns.filter(e=>e.__slotName),(function(t){return{key:t.__slotName,fn:function(a){return[e._t(t.__slotName,null,{row:a.data.row})]}}}))],null,!0)}),t("div",{attrs:{slot:"footer"},slot:"footer"},[e.isShowCloseBtn?t("div",[t("el-button",{attrs:{id:"cancel",size:"small"},on:{click:e.cancel}},[e._v(e._s(e.$t("common.button.close"))+" ")])],1):t("div",[t("el-button",{attrs:{id:"cancel",size:"small"},on:{click:e.cancel}},[e._v(e._s(e.$t("common.button.cancel"))+" ")]),t("el-button",{attrs:{id:"confirm",size:"small",type:"primary"},on:{click:e.submit}},[e._v(" "+e._s(e.$t("common.button.confirm"))+" ")])],1)])],1)],1)},n=[],o=a("3186"),r=a("4c09"),s={name:"addPrompt",components:{TablePage:r["a"],PortalForm:o["a"]},props:{searchVisible:{type:Boolean,default:!1},hasCheckBox:{type:Boolean,default:!0},hasPagination:{type:Boolean,default:!1},isCheck:{type:Boolean,default:!1},isCheckMemory:{type:Boolean,default:!1},isShowCloseBtn:{type:Boolean,default:!1},tableData:{type:Array,default:()=>[]},initChecks:{type:Array,default:()=>[]},options:{type:Object,default:()=>({})},addForm:{type:Object,default:()=>{}},submitCallBack:{type:String,default:()=>""},childSearch:{type:Function,default:null},smallAutoColumn:{type:Number,default:2,validate:e=>!(24%e)},bigAutoColumn:{type:Number,default:2,validate:e=>!(24%e)},isShowSearch:{type:Boolean,default:!0},isSingleCheck:{type:Boolean,default:!1}},watch:{searchVisible(e){e&&(this.refreshTableFlag=!0,this.multipleSelection=this.getCheckedSelection()),this.firstLoadTableEnd=!1}},data(){return{tempFormRules:{propertyName:[{required:!1,message:"Please enter",trigger:"blur"}]},paginationConfig:{total:this.addForm.columns&&this.addForm.columns.length||0,pageIndex:1,pageSize:5,layout:"total,prev, pager, next"},multipleSelection:[],multipleSelectionCache:{},uncommitSelectionache:{},refreshTableFlag:!1,searchLoading:!1,param:{},multipleChecks:this.initChecks,initChecksCache:this.initChecks,firstLoadTableEnd:!1,singelSekectionChangeData:""}},computed:{formConfigList(){return this.addForm.searchForm&&this.addForm.searchForm.formConf||[{label:this.addForm["label"],key:"propertyName",prop:"name",comp:"el-input",bind:{clearable:!0,placeholder:this.$t("common.placeholder.enter")}}]},formData(){return this.addForm.searchForm&&this.addForm.searchForm.formData},checkBoxClass(){const e=this.hasCheckBox;return e?"checkbox-on":"checkbox-off"}},methods:{singelSekectionChange(e){this.singelSekectionChangeData=e},getCheckedSelection(){const e=this.addForm.idKey||"id",t=this.initChecks.map(t=>t[e]),a=this.getObjFlatValue(this.multipleSelectionCache,e);return a?a.filter(a=>t.includes(a[e])):[]},fetchData(e){this.paginationConfig.total=e.total,this.searchLoading=!1,this.$emit("data-fetcher",e)},filterListByField(e,t){return e.reduce((e,a)=>{if(!e.length)return[...e,a];const i=e.some(e=>e[t]===a[t]);return i?e:[...e,a]},[])},getObjFlatValue(e,t){let a=Object.values(e);return a=a.reduce((e,t)=>e.length?[...e,...t]:[...t],[]),a=this.filterListByField(a,t),a},onSelectionChange(e){const t=this.addForm.idKey||"id",a=this.paginationConfig.pageIndex;let i=this.initChecksCache,n=this.multipleSelectionCache[a]||[];const o=e.map(e=>e[t]),r=n.filter(e=>!o.includes(e[t])),s=r.map(e=>e[t]);i=i.filter(e=>!s.includes(e[t])),this.initChecksCache=[...i],this.multipleSelectionCache[a]=[...e],this.multipleSelection=this.getObjFlatValue(this.multipleSelectionCache,t),this.uncommitSelectionache={...this.multipleSelectionCache}},async getTableData(e){let t=null;const a=this.addForm.idKey||"id";this.tableData.length>0?t=this.tableData:(this.param.searchKey&&(e.searchKey=this.param.searchKey),t=await this.childSearch(e));const i=this.getObjFlatValue(this.uncommitSelectionache,a),n=this.firstLoadTableEnd?this.initChecksCache:this.initChecks;this.firstLoadTableEnd=!0;const o=[...n,...i],r=o.map(e=>e[a]),s=t.list||[],l=s.some(e=>r.includes(e[a]));let c=[];return l&&(c=o),window.requestIdleCallback(()=>{this.multipleChecks=c}),this.refreshTableFlag=!1,t},search(e){this.param.pageNo=1,this.param.pageSize=10,this.param.searchKey=e,this.searchLoading=!0,this.$emit("update:search",this.param);try{this.$refs["data-table"].queryData(!0)}finally{this.searchLoading=!1}},reset(){if(this.formData)for(let e in this.formData)this.formData[e]=null;this.refreshTableFlag=!0,this.firstLoadTableEnd=!1},submit(){const e=this.options;this.isSingleCheck&&(this.multipleSelection=this.singelSekectionChangeData),this.$emit("submit-call-back",this.multipleSelection,e),this.$emit("update:searchVisible",!1),this.multipleChecks=[]},cancel(){this.$emit("update:searchVisible",!1),this.multipleChecks=[]}},created(){},mounted(){},activated(){}},l=s,c=(a("7f3c"),a("2877")),d=Object(c["a"])(l,i,n,!1,null,"51661ae8",null);t["a"]=d.exports},"0fb1":function(e,t,a){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",{class:{"portal-add-popup":!0,[e.checkBoxClass]:!0,"portal-add-popup--no-pagination":!e.hasPagination}},[t("el-dialog",{staticClass:"search",attrs:{title:e.addForm.title,visible:e.productVisible,width:"800px","close-on-click-modal":!1,"before-close":e.cancel},on:{"update:visible":function(t){e.productVisible=t}}},[t("div",{staticClass:"topTitle"},[e._v(e._s(e.$t("IDC.orgCustomer.selectedProduct")))]),t("div",{staticClass:"selected-container"},[t("div",{staticClass:"show-selected-div"},e._l(e.getObjFlatValue(e.uncommitSelectionache,e.addForm.idKey),(function(a,i){return t("el-tag",{key:i,attrs:{type:"info",closable:!0},on:{close:function(t){return e.removeSelected(a)}}},[e._v(" "+e._s(a.productName)+" ")])})),1)]),t("table-page",{ref:"data-table",attrs:{size:"small",idKey:"productId","is-check":e.isCheck,"is-check-memory":!0,"is-search":e.refreshTableFlag,"has-pagination":e.hasPagination,columns:e.addForm.columns,pagination:e.paginationConfig,getTableData:e.getTableData,"init-checks":e.multipleChecks,"id-key":e.addForm.idKey,"expand-row-keys":e.expands,sortArr:["productName","productDesc"]},on:{fetchData:e.fetchData,"selection-change":e.onSelectionChange}}),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{id:"cancel",size:"small"},on:{click:e.cancel}},[e._v(e._s(e.$t("common.button.cancel"))+" ")]),t("el-button",{directives:[{name:"preventReClick",rawName:"v-preventReClick"}],attrs:{id:"confirm",size:"small",type:"primary"},on:{click:e.submit}},[e._v(" "+e._s(e.$t("common.button.confirm"))+" ")])],1)],1)],1)},n=[],o=a("4c09"),r={name:"addPrompt",components:{TablePage:o["a"]},props:{productVisible:{type:Boolean,default:!1},hasCheckBox:{type:Boolean,default:!0},hasPagination:{type:Boolean,default:!1},isCheck:{type:Boolean,default:!1},isCheckMemory:{type:Boolean,default:!1},isShowCloseBtn:{type:Boolean,default:!1},tableData:{type:Array,default:()=>[]},initChecks:{type:Array,default:()=>[]},options:{type:Object,default:()=>({})},addForm:{type:Object,default:()=>{}},submitCallBack:{type:String,default:()=>""},childSearch:{type:Function,default:null},smallAutoColumn:{type:Number,default:3,validate:e=>!(24%e)},bigAutoColumn:{type:Number,default:4,validate:e=>!(24%e)}},watch:{productVisible(e){e&&(this.refreshTableFlag=!0,this.multipleSelection=this.getCheckedSelection()),this.firstLoadTableEnd=!1}},data(){return{expands:[],paginationConfig:{total:this.addForm&&this.addForm.columns&&this.addForm.columns.length||0,pageIndex:1,pageSize:5},multipleSelection:[],multipleSelectionCache:{},uncommitSelectionache:{},refreshTableFlag:!1,searchLoading:!1,param:{},multipleChecks:this.initChecks,initChecksCache:this.initChecks,firstLoadTableEnd:!1}},computed:{formConfigList(){return this.addForm&&this.addForm.searchForm&&this.addForm.searchForm.formConf},formData(){return this.addForm&&this.addForm.searchForm&&this.addForm.searchForm.formData},checkBoxClass(){const e=this.hasCheckBox;return e?"checkbox-on":"checkbox-off"}},methods:{getCheckedSelection(){const e=this.addForm.idKey||"id",t=this.initChecks.map(t=>t[e]),a=this.getObjFlatValue(this.multipleSelectionCache,e);return a?a.filter(a=>t.includes(a[e])):[]},fetchData(e){this.paginationConfig.total=e.total,this.searchLoading=!1,this.$emit("data-fetcher",e)},filterListByField(e,t){return e.reduce((e,a)=>{if(!e.length)return[...e,a];const i=e.some(e=>e[t]===a[t]);return i?e:[...e,a]},[])},getObjFlatValue(e,t){let a=Object.values(e);return a=a.reduce((e,t)=>e.length?[...e,...t]:[...t],[]),a=this.filterListByField(a,t),a},onSelectionChange(e){const t=this.addForm.idKey,a=this.paginationConfig.pageIndex;let i=this.initChecksCache,n=this.multipleSelectionCache[a]||[];const o=e.map(e=>e[t]),r=n.filter(e=>!o.includes(e[t])),s=r.map(e=>e[t]);i=i.filter(e=>!s.includes(e[t])),this.initChecksCache=[...i],this.multipleSelectionCache[a]=[...e],this.multipleSelection=this.getObjFlatValue(this.multipleSelectionCache,t),this.uncommitSelectionache={...this.multipleSelectionCache}},async getTableData(e){let t=null;const a=this.addForm.idKey;this.tableData.length>0?t=this.tableData:(this.param.searchKey&&(e.searchKey=this.param.searchKey),t=await this.childSearch(e));const i=this.getObjFlatValue(this.uncommitSelectionache,a),n=this.firstLoadTableEnd?this.initChecksCache:this.initChecks;this.firstLoadTableEnd=!0;const o=[...n,...i],r=o.map(e=>e[a]),s=t.list||[],l=s.some(e=>r.includes(e[a]));let c=[];return l&&(c=o),window.requestIdleCallback(()=>{this.multipleChecks=c}),this.refreshTableFlag=!1,t},submit(){const e=this.options;this.$emit("submit-call-back",this.multipleSelection,e),this.$emit("update:productVisible",!1),this.multipleChecks=[]},cancel(){this.$emit("update:productVisible",!1),this.multipleChecks=[]},handleSelect(e){let t=e.data.row.productId;-1===this.expands.indexOf(t)?this.expands.push(t):this.expands.splice(this.expands.indexOf(t),1)},removeSelected(e){this.$refs["data-table"].$refs.tableRef.toggleRowSelection(e)}},filters:{obj2str(e){const t=[];return t.push(Object.values(e)[1]),t.join(",")}},created(){},mounted(){},activated(){}},s=r,l=(a("953e"),a("2877")),c=Object(l["a"])(s,i,n,!1,null,"40730a68",null);t["a"]=c.exports},"0fc4":function(e,t,a){e.exports={activeMenuColor:"#366bfc",primaryColor:"#366bfc",menuColor:"#5c5c5c",fillEmphasisColor:"#5c5c5c",fillLightColor:"#fafafa",fillStrongColor:"#c7c7c7",fillRegularColor:"#f0f0f0",fillColorDark:"#e0e0e0",lineStrongColor:"#8f8f8f",textEmphasisColor:"#282828",backgroundColor:"#fff",statusErrorColor:"#ff4040",statusSuccessColor:"#27bf88",statusColorwarning:"#ff7420",statusColorSAecondaryWarning:"#faaf0c",statusNoticeColor:"#338bff",statusDark:"#c7c7c7",initialColor:"#E0E0E0",statusNoticeBackgroundColor:"#F0F9FF",statusErrorBackgroundColor:"#FFF2F0",statusSuccessBackgroundColor:"#F0FFF7",statusSecondaryWarningBackgroundColor:"#FFFBE6",statusWarningBackgroundColor:"#FFF6E6",statusDarkBackgroundColor:"#FAFAFA",lineColorBlue:"#ADD9FF",lineColorError:"#FFC1BA",lineColorGreen:"#A5E6C6",lineColorWarning:"#FFF7ed"}},"107c":function(e,t,a){"use strict";a("a857")},"138f":function(e,t,a){"use strict";a("99ce")},"1c9c":function(e,t,a){},"1d77":function(e,t,a){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"simple-collapse"},[t("div",{staticClass:"simple-collapse__header",class:e.disabled?"is-disabled":"",on:{click:e.toggle}},[e.showArrowIcon?t("i",{staticClass:"el-icon-arrow-right",class:e.actived?"opened":""}):e._e(),t("span",{staticClass:"simple-collapse__header-value"},[e._v(e._s(e.title))])]),t("el-collapse-transition",[t("div",{directives:[{name:"show",rawName:"v-show",value:e.actived,expression:"actived"}],staticClass:"el-collapse-item__wrap simple-collapse__content"},[e._t("default")],2)])],1)},n=[],o={name:"CodesOrgCollapse",props:{title:{type:String,default:""},opened:{type:Boolean,default:!0},showArrowIcon:{type:Boolean,default:!1},disabled:{type:Boolean,default:!0}},data(){return{actived:this.opened}},mounted(){},methods:{toggle(){this.disabled||(this.actived=!this.actived)}}},r=o,s=(a("0825"),a("2877")),l=Object(s["a"])(r,i,n,!1,null,"09328b30",null);t["a"]=l.exports},"1e7b":function(e,t,a){},"28ba":function(e,t,a){"use strict";a("0fc4")},"2fa9":function(e,t,a){},"336a":function(e,t,a){},"3d79":function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"d",(function(){return f})),a.d(t,"b",(function(){return w})),a.d(t,"c",(function(){return D}));var i=a("02e3"),n=a("cb9d"),o=a("5a0c"),r=a.n(o);const s={COMP_DISPLAY:"dd/MM/yyyy HH:mm",DAYJS_DISPLAY:"DD/MM/YYYY HH:mm",COMP_VALUE:"yyyy-MM-dd HH:mm",DAYJS:"YYYY-MM-DD HH:mm"},l={pattern:/^((13[5-9])|(1[4-9][0-9]))[0-9]{8}$/,message:"Please Enter a correct IMSI.",trigger:"blur"},c={type:"email",message:"Please enter only letters(a-z),numbers(0-9),periods(.),and at(@).",trigger:"blur"},d=e=>e(new Error("Query short code exception."));let u=(e,t)=>({required:!0,trigger:["blur","change"],validator(t,a,i){let n="";if(!a)return n="Please select content",e.parentOrgName="",i(new Error(n));const o=a.length,r=4,s=12;if(o>=4&&o<=s)return i();n=`Must be between ${r} and ${s} characters`,e.parentOrgName="",i(new Error(n))}}),f=(e,t)=>({parentShortCode:[u(e,t),h(e,t),{trigger:"change"}],shortCode:[i["e"],i["n"],m()],merchName:[i["e"],y(e.orgNameRegex),b()],notificationChannel:[i["z"]],phoneNumber:[l,i["q"],v(e)],email:[c,i["q"],C(e)],language:[i["z"]],selectedProdList:[p(e)]});const p=e=>{const t=(t,a,i)=>{const n=e.selectedProdList;if(!n||!n.length)return i(new Error("Please select one product."));i()};return{validator:t}};let m=()=>{const e=(e,t,a)=>{Object(n["j"])(t).then(e=>{e.header&&e.header.success?"Invalid"===e.check?a(new Error("The Organization short code is invalid.")):"Exist"===e.check?a(new Error("The Organization Short Code Already Exsists.")):a():a(new Error("Query short code error."))}).catch(e=>d(a))};return{validator:e,trigger:"blur"}},h=(e,t)=>{const a=(a,i,o)=>{Object(n["j"])(i).then(a=>{if(!a.header||!a.header.success)return e.parentOrgName="",void o(new Error("Query short code error."));"Exist"===a.check?g(e,t,o):"Invalid"===a.check?(e.parentOrgName="",o(new Error("The short code is invalid."))):(e.parentOrgName="",o(new Error("The short code is not existed.")))}).catch(e=>d(o))};return{validator:a,trigger:"blur"}},g=(e,t,a)=>{t.identityModel="",t.subAgentExpansionModel="",Object(n["u"])({shortCode:e.parentShortCode}).then(i=>{if(i.header&&i.header.success&&i.organizationInfo){let n=i.organizationInfo;""===n.subAgentExpansionModel||"0003"===n.subAgentExpansionModel?(e.parentOrgName="",a(new Error("The short code does not allow sub-organizations."))):"0002"===n.subAgentExpansionModel?(e.parentId=n.organizationId,e.parentOrgName=n.organizationName,t.parentIdentityModel=n.subAgentExpansionModel,a()):n.subAgentExpansionModel!="000"+e.selectedProdList[0].productProperties.ORG_IDENTITY_MODEL?a(new Error("SelectedProduct not match subAgentExpansionModel.")):(e.parentId=n.organizationId,e.parentOrgName=n.organizationName,t.parentIdentityModel=n.subAgentExpansionModel,a())}}).catch(()=>{e.parentOrgName="",a(new Error("Query organization list exception."))})},b=()=>{const e=(e,t,a)=>{Object(n["g"])({merchantName:t}).then(e=>{e.header&&e.header.success?"Invalid"===e.check?a(new Error("The organization name is invalid.")):"Exist"===e.check?a(new Error("The organization name is existed.")):a():a(new Error("Query organization name error."))}).catch(()=>{a(new Error("Query organization name exception."))})};return{validator:e,trigger:"blur"}},y=e=>({validator:(t,a,i)=>{new RegExp(e).test(a)?i():i(new Error(e+"."))},trigger:"blur"}),v=e=>I(e,"1001"),C=e=>I(e,"1011"),I=(e,t)=>({validator:(a,i,n)=>{""===i&&e.notificationChannel===t?n(new Error("Please enter content")):n()},trigger:"blur"});const k={validationExpression:[i["e"],i["m"]],validationMode:[i["z"]],allowPartialPayement:[i["z"]]};let w=()=>({identityModel:[i["z"]],subAgentExpansionModel:[i["z"]],ruleProfile:[i["z"]],aggregatorModel:[i["z"]],centralOwnedModel:[i["z"]],...k});const D=(e,t,a)=>{let i=(e,i,n)=>{if("effectiveTime"===a?t.effectiveErrorMessage="":t.expireErrorMessage="",!t)return n();const o="The date must be later than  Effective Date.",l="The date must be earlier than  Expiry Date.",c=r()(t.effectiveTime,s.DAYJS),d=r()(t.expireTime,s.DAYJS),u=c<d;return u?n():"effectiveTime"===a?(t.effectiveErrorMessage=l,n(new Error(l))):"expireTime"===a?(t.expireErrorMessage=o,n(new Error(o))):void n(new Error("Invalid time."))};return[{required:!0,message:"Please enter context"},{validator:i,trigger:"change"}]}},"423d":function(e,t,a){e.exports={activeMenuColor:"#366bfc",primaryColor:"#366bfc",menuColor:"#5c5c5c",fillEmphasisColor:"#5c5c5c",fillLightColor:"#fafafa",fillStrongColor:"#c7c7c7",fillRegularColor:"#f0f0f0",fillColorDark:"#e0e0e0",lineStrongColor:"#8f8f8f",textEmphasisColor:"#282828",backgroundColor:"#fff",statusErrorColor:"#ff4040",statusSuccessColor:"#27bf88",statusColorwarning:"#ff7420",statusColorSAecondaryWarning:"#faaf0c",statusNoticeColor:"#338bff",statusDark:"#c7c7c7",initialColor:"#E0E0E0",statusNoticeBackgroundColor:"#F0F9FF",statusErrorBackgroundColor:"#FFF2F0",statusSuccessBackgroundColor:"#F0FFF7",statusSecondaryWarningBackgroundColor:"#FFFBE6",statusWarningBackgroundColor:"#FFF6E6",statusDarkBackgroundColor:"#FAFAFA",lineColorBlue:"#ADD9FF",lineColorError:"#FFC1BA",lineColorGreen:"#A5E6C6",lineColorWarning:"#FFF7ed"}},4396:function(e,t,a){"use strict";a("336a")},4710:function(e,t,a){},4824:function(e,t,a){"use strict";a("5a1b")},"4cd4":function(e,t,a){e.exports={activeMenuColor:"#366bfc",primaryColor:"#366bfc",menuColor:"#5c5c5c",fillEmphasisColor:"#5c5c5c",fillLightColor:"#fafafa",fillStrongColor:"#c7c7c7",fillRegularColor:"#f0f0f0",fillColorDark:"#e0e0e0",lineStrongColor:"#8f8f8f",textEmphasisColor:"#282828",backgroundColor:"#fff",statusErrorColor:"#ff4040",statusSuccessColor:"#27bf88",statusColorwarning:"#ff7420",statusColorSAecondaryWarning:"#faaf0c",statusNoticeColor:"#338bff",statusDark:"#c7c7c7",initialColor:"#E0E0E0",statusNoticeBackgroundColor:"#F0F9FF",statusErrorBackgroundColor:"#FFF2F0",statusSuccessBackgroundColor:"#F0FFF7",statusSecondaryWarningBackgroundColor:"#FFFBE6",statusWarningBackgroundColor:"#FFF6E6",statusDarkBackgroundColor:"#FAFAFA",lineColorBlue:"#ADD9FF",lineColorError:"#FFC1BA",lineColorGreen:"#A5E6C6",lineColorWarning:"#FFF7ed"}},"4e5c":function(e,t,a){"use strict";a("4710")},"5a1b":function(e,t,a){},6195:function(e,t,a){"use strict";var i,n,o=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.initLoading,expression:"initLoading"}],staticClass:"panel"},["detail"===e.pageType?t("el-row",[t("el-col",[t("div",{staticClass:"prompt-title"},[e._v(e._s(e.$t("IDC.revenueSettlementInfo.promptTitle")))])])],1):e._e(),e.isEditModel||"detail"!==e.pageType?e._e():t("el-row",[t("el-col",[t("el-button",{staticClass:"portal-operation-button",staticStyle:{"margin-bottom":"20px"},attrs:{size:"small",plain:""},on:{click:function(t){return e.setEditModel(!0)}}},[t("i",{staticClass:"el-icon-edit el-icon--right"}),e._v(e._s(e.$t("common.button.edit"))+" ")])],1)],1),t("el-form",{ref:"revenueForm",staticClass:"settlement-form",class:{viewModel:!e.isEditModel},attrs:{"label-position":"top",model:e.revenueFormData,rules:e.revenueRules}},[t("div",{staticClass:"content-wrapper"},[t("div",{staticClass:"sub-block"},[t("el-row",{attrs:{gutter:20}},[t("el-col",e._b({},"el-col",e.colOptions,!1),[t("el-form-item",{attrs:{prop:"profileName",label:e.$t("IDC.revenueSettlementInfo.revenueSettlementProfile")}},[e.isEditModel?[t("el-select",{attrs:{placeholder:"Please select",size:"small",clearable:""},on:{change:e.getProfileChange},nativeOn:{click:function(t){return e.getProfileClick.apply(null,arguments)}},model:{value:e.revenueFormData.profileId,callback:function(t){e.$set(e.revenueFormData,"profileId",t)},expression:"revenueFormData.profileId"}},e._l(e.profileList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)]:t("span",{domProps:{textContent:e._s(e.revenueFormData.profileName||"-")}})],2)],1),e.revenueFormData.isShowModel?[t("el-col",e._b({},"el-col",e.colOptions,!1),[t("el-form-item",{attrs:{prop:"periodicSwitch",label:e.$t("IDC.revenueSettlementInfo.periodicRevenueSettlement")}},[e.isEditModel?t("switch-with-text",{attrs:{value:e.revenueFormData.periodicSwitch,change:e.PeriodicHandleChange,bind:{size:"small"}},on:{"update:value":function(t){return e.$set(e.revenueFormData,"periodicSwitch",t)}}}):t("span",{domProps:{textContent:e._s(!0===e.revenueFormData.periodicSwitch?"ON":"OFF")}})],1)],1),e.revenueFormData.periodicSwitch?t("el-col",e._b({},"el-col",e.colOptions,!1),[t("el-form-item",{attrs:{prop:"intervalValue",label:e.$t("IDC.revenueSettlementInfo.settlementCycle")}},[e.isEditModel?t("div",{staticStyle:{display:"flex",gap:"4px"}},[t("el-input",{staticStyle:{width:"68%"},attrs:{size:"small"},model:{value:e.revenueFormData.intervalValue,callback:function(t){e.$set(e.revenueFormData,"intervalValue",t)},expression:"revenueFormData.intervalValue"}}),t("el-select",{staticStyle:{width:"32%"},attrs:{placeholder:"please select",size:"small"},on:{change:function(t){return e.onTimeUnitChange()}},model:{value:e.revenueFormData.intervalTypeCode,callback:function(t){e.$set(e.revenueFormData,"intervalTypeCode",t)},expression:"revenueFormData.intervalTypeCode"}},e._l(e.settlementCycleUnitList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1):t("span",{domProps:{textContent:e._s(e.revenueFormData.intervalValue+" "+e.getLableToOptions(e.revenueFormData.intervalTypeCode,e.settlementCycleUnitList))}})])],1):e._e(),e.revenueFormData.periodicSwitch?t("el-col",e._b({},"el-col",e.colOptions,!1),[t("el-form-item",{attrs:{label:e.$t("IDC.revenueSettlementInfo.startDate"),prop:"startDate"}},[e.isEditModel?t("el-date-picker",{attrs:{type:"date",size:"small",format:"dd/MM/yyyy",placeholder:"Please select date","value-format":"yyyy-MM-dd","picker-options":e.startDatePicker,clearable:!1},on:{change:e.startDateChange},model:{value:e.revenueFormData.startDate,callback:function(t){e.$set(e.revenueFormData,"startDate",t)},expression:"revenueFormData.startDate"}}):t("span",{domProps:{textContent:e._s(e.getDateFormat(e.revenueFormData.startDate))}})],1)],1):e._e(),e.revenueFormData.periodicSwitch?t("el-col",e._b({},"el-col",e.colOptions,!1),[t("el-form-item",{attrs:{label:e.$t("IDC.revenueSettlementInfo.endDate"),prop:"endDate"}},[e.isEditModel?t("el-date-picker",{attrs:{type:"date",size:"small",format:"dd/MM/yyyy",placeholder:"Please select date","value-format":"yyyy-MM-dd","picker-options":e.endDatePicker,clearable:!1},on:{change:e.endDateChange},model:{value:e.revenueFormData.endDate,callback:function(t){e.$set(e.revenueFormData,"endDate",t)},expression:"revenueFormData.endDate"}}):t("span",{domProps:{textContent:e._s(e.getDateFormat(e.revenueFormData.endDate))}})],1)],1):e._e()]:e._e(),e.revenueFormData.isShowModel?t("el-col",e._b({},"el-col",e.colOptions,!1),[t("el-form-item",{attrs:{label:e.$t("IDC.revenueSettlementInfo.manualInitiation"),prop:"manualWsSwitch"}},[e.isEditModel?t("switch-with-text",{attrs:{value:e.revenueFormData.manualWsSwitch,bind:{disabled:!0,size:"small"}},on:{"update:value":function(t){return e.$set(e.revenueFormData,"manualWsSwitch",t)}}}):t("span",{domProps:{textContent:e._s(!0===e.revenueFormData.manualWsSwitch?"ON":"OFF")}})],1)],1):e._e(),e.revenueFormData.isShowModel?t("el-col",e._b({},"el-col",e.colOptions,!1),[t("el-form-item",{attrs:{label:e.$t("IDC.revenueSettlementInfo.scheduledInitiation"),prop:"scheduledInitiation"}},[e.isEditModel?t("switch-with-text",{attrs:{value:e.revenueFormData.autoWsSwitch,bind:{disabled:!0,size:"small"}},on:{"update:value":function(t){return e.$set(e.revenueFormData,"autoWsSwitch",t)}}}):t("span",{domProps:{textContent:e._s(!0===e.revenueFormData.autoWsSwitch?"ON":"OFF")}})],1)],1):e._e()],2)],1),e.revenueFormData.isShowModel?t("section",{staticClass:"tabs-container",class:{create:"create"===e.pageType}},[t("el-tabs",{staticStyle:{"margin-right":"20px"},attrs:{id:"tab-pane",type:"border-card"},on:{"tab-click":e.handleTabClick},model:{value:e.activeTab,callback:function(t){e.activeTab=t},expression:"activeTab"}},e._l(e.revenueFormData.settlementProfileList,(function(a,i){return t("el-tab-pane",{key:a["fundingSourceCode"]+a["settlementAccountTypeId"]+a["currency"],attrs:{label:"Settlement "+(i+1),name:a["fundingSourceCode"]+a["settlementAccountTypeId"]+a["currency"]}},[t("div",{staticClass:"sub-block"},[t("el-row",{attrs:{gutter:20}},[t("el-col",e._b({},"el-col",e.colOptions,!1),[t("el-form-item",{attrs:{label:e.$t("IDC.revenueSettlementInfo.settAccountMinBalance")+e.showBalanceWithUnit(a.currency),prop:"settlementMinBalance"}},[e.isEditModel?t("el-input",{attrs:{clearable:"",size:"small"},on:{focus:function(t){return e.unInputMoney(t)},blur:function(t){return e.inputMoney(t)}},model:{value:a.settlementMinBalance,callback:function(t){e.$set(a,"settlementMinBalance",t)},expression:"item.settlementMinBalance"}}):t("span",{domProps:{textContent:e._s(a.settlementMinBalance)}})],1)],1)],1)],1),t("el-divider",{staticClass:"divider-margin-2"}),t("div",{staticClass:"sub-block"},[t("div",{staticClass:"sub-block__title sub-block__title--normal"},[e._v(" "+e._s(e.$t("IDC.revenueSettlementInfo.revenueSettlementConfiguration"))+" ")]),t("revenue-table-list",{attrs:{tableData:a.grossRevenueList,isEditModel:e.isEditModel,currency:a.currency}})],1),t("div",{staticClass:"sub-block margin-top-45"},[t("div",{staticClass:"sub-block__title sub-block__title--normal"},[e._v(" "+e._s(e.$t("IDC.revenueSettlementInfo.liabSettlementConfiguration"))+" ")]),t("liability-table-list",{attrs:{tableData:a.grossLiabilityList,isEditModel:e.isEditModel,currency:a.currency}})],1)],1)})),1)],1):e._e()])]),e.isEditModel&&e.isShowBtn?t("div",{staticClass:"page-bottom-wrap"},[t("div",[t("el-button",{staticClass:"cancel-button",attrs:{id:"cancel",size:"small"},on:{click:e.cancel}},[e._v("Cancel ")]),t("el-button",{directives:[{name:"preventReClick",rawName:"v-preventReClick"}],attrs:{id:"submitProduct",type:"primary",size:"small",loading:e.submitLoading},on:{click:e.submitEvn}},[e._v(" Submit ")])],1)]):e._e()],1)},r=[],s={name:"SwitchWithText",props:{value:{type:Boolean,default:()=>!0},change:{Type:Function,default:()=>{}},bind:{type:Object,default:()=>({})},activeText:{type:String,default:()=>"ON"},inactiveText:{type:String,default:()=>"OFF"},position:{type:String,default:()=>"right",validator:function(e){return["left","right","leftRight"].includes(e)}}},data(){return{val:this.value}},watch:{value(e){this.val=e}},methods:{getStatusText(e){return e?this.activeText:this.inactiveText},changeHandle(e){this.$emit("update:value",e),this.change(e)}},render(e){const t={};"right"===this.position&&(t.activeText=this.getStatusText(this.val)),"left"===this.position&&(t.inactiveText=this.getStatusText(this.val)),"leftRight"===this.position&&(t.inactiveText=this.inactiveText,t.activeText=this.activeText);const a=[];let i={};this.bind&&this.bind.class&&a.push(this.bind.class),this.bind&&this.bind.style&&(i={...i,...this.bind.style});const n={class:a,style:i,props:{...this.bind,...t,value:this.val},on:{change:this.changeHandle}};return e("el-switch",n)}},l=s,c=a("2877"),d=Object(c["a"])(l,i,n,!1,null,null,null),u=d.exports,f=a("e036"),p=function(){var e=this,t=e._self._c;return t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","row-style":{height:"56px"}}},[t("el-table-column",{attrs:{label:e.$t("IDC.revenueSettlementInfo.liabilityAccount"),prop:"accountTypeName","min-width":"168px"}}),t("el-table-column",{attrs:{label:e.$t("IDC.revenueSettlementInfo.targetBalance")+e.showBalanceWithUnit(e.currency),prop:"targetBalance",required:"","min-width":"158px","render-header":e.requiredStar},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"columns"},[t("el-tooltip",{attrs:{content:e.getContentTips(a.row,"target"),effect:"light",placement:"top-start","arrow-offset":16,"popper-class":"text-content-error-tooltip",disabled:a.row.targetDisabled}},[t("el-form-item",{attrs:{prop:"targetBalance",rules:e.checkRules(a.row,"target")}},[t("el-input",{staticStyle:{width:"100%"},attrs:{size:"small",type:"text",disabled:!e.isEditModel},on:{focus:function(t){return e.unInputMoney(t,a,"target")},blur:function(t){return e.inputMoney(t,a,"target")}},model:{value:a.row.targetBalance,callback:function(t){e.$set(a.row,"targetBalance",t)},expression:"scope.row.targetBalance"}})],1)],1)],1)]}}])}),t("el-table-column",{attrs:{label:e.$t("IDC.revenueSettlementInfo.settlementTriggerBalance")+e.showBalanceWithUnit(e.currency),prop:"triggerBalance","min-width":"208px","render-header":e.addRequiredStar},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"columns"},[t("el-tooltip",{attrs:{content:e.getContentTips(a.row,"trigger"),effect:"light",placement:"top-start","arrow-offset":16,"popper-class":"text-content-error-tooltip",disabled:a.row.triggerDisabled}},[t("el-form-item",{attrs:{prop:"triggerBalance",rules:e.checkRules(a.row,"trigger")}},[t("el-switch",{staticStyle:{"margin-right":"10px"},attrs:{"active-text":a.row.triggerSwitch?"ON":"OFF",disabled:!e.isEditModel},on:{change:function(t){return e.triggerHandleChange(a.row,a.$index)}},model:{value:a.row.triggerSwitch,callback:function(t){e.$set(a.row,"triggerSwitch",t)},expression:"scope.row.triggerSwitch"}}),a.row.triggerSwitch?t("el-input",{staticStyle:{width:"72%"},attrs:{size:"small",type:"text",disabled:!e.isEditModel},on:{focus:function(t){return e.unInputMoney(t,a,"trigger")},blur:function(t){return e.inputMoney(t,a,"trigger")}},model:{value:a.row.triggerBalance,callback:function(t){e.$set(a.row,"triggerBalance",t)},expression:"scope.row.triggerBalance"}}):e._e()],1)],1)],1)]}}])}),t("el-table-column",{attrs:{label:e.$t("IDC.revenueSettlementInfo.MinBalanceTrigger"),prop:"maxMinBalanceTrigger","min-width":"100px"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"columns"},[t("el-switch",{staticStyle:{width:"95px"},attrs:{"active-text":a.row.maxMinBalanceTrigger?"ON":"OFF",disabled:!e.isEditModel},model:{value:a.row.maxMinBalanceTrigger,callback:function(t){e.$set(a.row,"maxMinBalanceTrigger",t)},expression:"scope.row.maxMinBalanceTrigger"}})],1)]}}])})],1)},m=[],h=a("89b2"),g={name:"TblProductService",props:{tableData:{type:Array,default:()=>[]},isEditModel:{type:Boolean,default:!1},dateRange:{type:Object,default:()=>{}},currency:{type:String,default:""}},data(){return{services:[],amount:"",hasTriggerSwitch:!1}},computed:{},watch:{},methods:{deleteRow(e,t){t.splice(e,1)},inputMoney(e,t,a){let i=null;i="0"===e.target.value?Number(e.target.value):Number(e.target.value)||null,"trigger"===a?t.row.triggerBalance=Object(h["d"])(i):t.row.targetBalance=Object(h["d"])(i)},unInputMoney(e,t,a){e.target.value&&("trigger"===a?t.row.triggerBalance=Object(h["a"])(e.target.value):t.row.targetBalance=Object(h["a"])(e.target.value))},showBalanceWithUnit(e){return"USD"===e?"($)":`(${e})`},checkRules(e,t){return{trigger:"blur",validator:async(a,i,n)=>{let o=null!=e.triggerBalance&&0!=e.triggerBalance.length,r=null!=e.targetBalance&&0!=e.targetBalance.length,s=null==e.targetBalance;if(this.hasTriggerSwitch=e.triggerSwitch,o&&r){let a=Number(Object(h["a"])(e.triggerBalance)),i=Number(Object(h["a"])(e.targetBalance));switch(t){case"target":if(i<=a)return n(new Error("Please enter an amount less than "+e.triggerBalance));break;case"trigger":if(a>=i)return n(new Error("Please enter an amount greater than "+e.targetBalance));break}}else if(s){if("target"==t)return n(new Error("Please enter content"))}else if(r&&this.hasTriggerSwitch&&"trigger"==t)return n(new Error("Please enter content"));n()}}},getContentTips(e,t){let a=null!=e.triggerBalance&&0!=e.triggerBalance.length,i=null!=e.targetBalance&&0!=e.targetBalance.length,n=null==e.targetBalance,o=null==e.triggerBalance;this.hasTriggerSwitch=e.triggerSwitch;let r="";if(a&&i){let a=Number(Object(h["a"])(e.triggerBalance)),i=Number(Object(h["a"])(e.targetBalance));switch(t){case"target":if(i>a)return void(e.targetDisabled=!0);r="Please enter an amount greater than "+a,e.targetDisabled=!1;break;case"trigger":if(a<i)return void(e.triggerDisabled=!0);r="Please enter an amount less than "+i,e.triggerDisabled=!1;break}}else if(n&&a)r="Please enter content",e.targetDisabled=!1,e.triggerDisabled=!0;else if(i&&o&&this.hasTriggerSwitch)r="Please enter content",e.targetDisabled=!0,e.triggerDisabled=!1;else{if(i&&!this.hasTriggerSwitch)return e.targetDisabled=!0,void(e.triggerDisabled=!0);r="Please enter content",e.targetDisabled=!1,e.triggerDisabled=!1}return r},requiredStar(e,{column:t}){return[e("span",{class:"required-star",style:"margin-left: 8px"},t.label)]},addRequiredStar(e,{column:t}){return[e("span",{class:{"required-star":this.hasTriggerSwitch},style:"margin-left: 8px"},t.label)]},triggerHandleChange(e,t){if(this.hasTriggerSwitch=e.triggerSwitch,!e.triggerSwitch){let e=this.tableData;e[t].triggerBalance=null}}}},b=g,y=(a("b7e5"),a("631b"),Object(c["a"])(b,p,m,!1,null,"7f2ad130",null)),v=y.exports,C=function(){var e=this,t=e._self._c;return t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"","row-style":{height:"56px"}}},[t("el-table-column",{attrs:{label:e.$t("IDC.revenueSettlementInfo.revenueAccount"),prop:"accountTypeName","min-width":"168px"}}),t("el-table-column",{attrs:{label:e.$t("IDC.revenueSettlementInfo.targetBalance")+e.showBalanceWithUnit(e.currency),prop:"targetBalance",required:"","min-width":"158px","render-header":e.requiredStar},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"columns"},[t("el-tooltip",{attrs:{content:e.getContentTips(a.row,"target"),effect:"light",placement:"top-start","arrow-offset":16,"popper-class":"text-content-error-tooltip",disabled:a.row.targetDisabled}},[t("el-form-item",{attrs:{prop:"targetBalance",rules:e.isEditModel?e.checkRules(a.row,"target"):{}}},[t("el-input",{staticStyle:{width:"100%"},attrs:{size:"small",type:"text",disabled:!e.isEditModel},on:{focus:function(t){return e.unInputMoney(t,a,"target")},blur:function(t){return e.inputMoney(t,a,"target")}},model:{value:a.row.targetBalance,callback:function(t){e.$set(a.row,"targetBalance",t)},expression:"scope.row.targetBalance"}})],1)],1)],1)]}}])}),t("el-table-column",{attrs:{label:e.$t("IDC.revenueSettlementInfo.settlementTriggerBalance")+e.showBalanceWithUnit(e.currency),prop:"triggerBalance","min-width":"208px","render-header":e.addRequiredStar},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"columns"},[t("el-tooltip",{attrs:{content:e.getContentTips(a.row,"trigger"),effect:"light",placement:"top-start","arrow-offset":16,"popper-class":"text-content-error-tooltip",disabled:a.row.triggerDisabled}},[t("el-form-item",{attrs:{prop:"triggerBalance",rules:e.checkRules(a.row,"trigger")}},[t("el-switch",{staticStyle:{"margin-right":"10px"},attrs:{"active-text":a.row.triggerSwitch?"ON":"OFF",disabled:!e.isEditModel},on:{change:function(t){return e.triggerHandleChange(a.row,a.$index)}},model:{value:a.row.triggerSwitch,callback:function(t){e.$set(a.row,"triggerSwitch",t)},expression:"scope.row.triggerSwitch"}}),a.row.triggerSwitch?t("el-input",{staticStyle:{width:"72%"},attrs:{size:"small",type:"text",disabled:!e.isEditModel},on:{focus:function(t){return e.unInputMoney(t,a,"trigger")},blur:function(t){return e.inputMoney(t,a,"trigger")}},model:{value:a.row.triggerBalance,callback:function(t){e.$set(a.row,"triggerBalance",t)},expression:"scope.row.triggerBalance"}}):e._e()],1)],1)],1)]}}])}),t("el-table-column",{attrs:{label:e.$t("IDC.revenueSettlementInfo.maxBalanceTrigger"),prop:"maxMinBalanceTrigger","min-width":"100px"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"columns"},[t("el-switch",{staticStyle:{width:"95px"},attrs:{"active-text":a.row.maxMinBalanceTrigger?"ON":"OFF",disabled:!e.isEditModel},model:{value:a.row.maxMinBalanceTrigger,callback:function(t){e.$set(a.row,"maxMinBalanceTrigger",t)},expression:"scope.row.maxMinBalanceTrigger"}})],1)]}}])})],1)},I=[],k={name:"TblProductService",props:{tableData:{type:Array,default:()=>[]},isEditModel:{type:Boolean,default:!1},dateRange:{type:Object,default:()=>{}},currency:{type:String,default:""}},watch:{},data(){return{services:[],amount:"",hasTriggerSwitch:!1}},computed:{},methods:{deleteRow(e,t){t.splice(e,1)},inputMoney(e,t,a){let i=null;i="0"===e.target.value?Number(e.target.value):Number(e.target.value)||null,"trigger"===a?t.row.triggerBalance=Object(h["d"])(i):t.row.targetBalance=Object(h["d"])(i)},unInputMoney(e,t,a){e.target.value&&("trigger"===a?t.row.triggerBalance=Object(h["a"])(e.target.value):t.row.targetBalance=Object(h["a"])(e.target.value))},showBalanceWithUnit(e){return"USD"===e?"($)":`(${e})`},checkRules(e,t){return{trigger:"blur",validator:async(a,i,n)=>{let o=null!=e.triggerBalance&&0!=e.triggerBalance.length,r=null!=e.targetBalance&&0!=e.targetBalance.length,s=null==e.targetBalance;if(o&&r){let a=Number(Object(h["a"])(e.triggerBalance)),i=Number(Object(h["a"])(e.targetBalance));switch(t){case"target":if(i>=a)return n(new Error("Please enter an amount less than "+e.triggerBalance));break;case"trigger":if(a<=i)return n(new Error("Please enter an amount greater than "+e.targetBalance));break}}else if(s){if("target"==t)return n(new Error("Please enter content"))}else if(r&&this.hasTriggerSwitch&&"trigger"==t)return n(new Error("Please enter content"));n()}}},getContentTips(e,t){let a=null!=e.triggerBalance&&0!=e.triggerBalance.length,i=null!=e.targetBalance&&0!=e.targetBalance.length,n=null==e.targetBalance,o=null==e.triggerBalance;this.hasTriggerSwitch=e.triggerSwitch;let r="";if(a&&i){let a=Number(Object(h["a"])(e.triggerBalance)),i=Number(Object(h["a"])(e.targetBalance));switch(t){case"target":if(i<a)return void(e.targetDisabled=!0);r="Please enter an amount less than "+a,e.targetDisabled=!1;break;case"trigger":if(a>i)return void(e.triggerDisabled=!0);r="Please enter an amount greater than "+i,e.triggerDisabled=!1;break}}else if(n&&a)r="Please enter content",e.targetDisabled=!1,e.triggerDisabled=!0;else if(i&&o&&this.hasTriggerSwitch)r="Please enter content",e.targetDisabled=!0,e.triggerDisabled=!1;else{if(i&&!this.hasTriggerSwitch)return e.targetDisabled=!0,void(e.triggerDisabled=!0);r="Please enter content",e.targetDisabled=!1,e.triggerDisabled=!1}return r},requiredStar(e,{column:t}){return[e("span",{class:"required-star",style:"margin-left: 8px"},t.label)]},addRequiredStar(e,{column:t}){return[e("span",{class:{"required-star":this.hasTriggerSwitch},style:"margin-left: 8px"},t.label)]},triggerHandleChange(e,t){if(this.hasTriggerSwitch=e.triggerSwitch,!e.triggerSwitch){let e=this.tableData;e[t].triggerBalance=null}}}},w=k,D=(a("107c"),a("28ba"),Object(c["a"])(w,C,I,!1,null,"6a6e68d1",null)),S=D.exports,P=a("689d"),T=a("5a0c"),F=a.n(T),x={name:"RevenueSettlementInfo",components:{switchWithText:u,LiabilityTableList:v,RevenueTableList:S},props:{dataObj:{labels:Object,default(){return{}}},revenueFormData:{type:Object,default(){return{}}},panelActived:{type:Boolean,default:!1},isViewMode:{type:Boolean,default:!1},isShowBtn:{type:Boolean,default:!1},pageType:{type:String,default:""},identityId:{type:String,default:""},assignInfo:{type:Object,default:()=>{}}},data(){return{activeTab:"",tabName:"first",revenueRules:Object(h["c"])(this),submitLoading:!1,initLoading:!1,revenueSettlement:this.revenueFormData,isEditModel:!this.isViewMode,type:this.pageType,operationMode:"",profileList:[],distributionModelList:[],settlementTemplateList:[],settlementCycleUnitList:[],settlementConfigTemplate:[],settlementList:[],queryProfileInfo:{},remark:"",startDatePicker:{disabledDate:e=>{const t=this.revenueFormData.endDate;if(t)return e.getTime()>new Date(t).getTime()-864e5}},endDatePicker:{disabledDate:e=>{const t=this.revenueFormData.startDate;return t?e.getTime()<Date.now()||e.getTime()<new Date(t).getTime():e.getTime()<Date.now()}}}},watch:{panelActived:{handler(e){e&&this.initPanel()},immediate:!0},revenueSettlement:{handler(e){e&&this.$emit("update:revenueFormData",Object(P["b"])(e))},deep:!0},"revenueFormData.settlementProfileList":{handler(e){e&&e.length>0&&(this.activeTab=e[0]["fundingSourceCode"]+e[0]["settlementAccountTypeId"]+e[0]["currency"])},immediate:!0},isViewMode:{handler(e){this.isEditModel=!e},immediate:!0},pageType(e){this.type=e}},methods:{async initPanel(){this.initLoading=!0,this.revenueSettlement.isShowModel&&this.setEditModel(!1);const e=await this.getAllInitData();if(!e)return;if(!e.profileMap)return;const t=Object.entries(e.profileMap);this.profileList=t.map(([e,t])=>({label:t,value:e})),this.settlementCycleUnitList=e.settlementCycleUnitList&&e.settlementCycleUnitList.map(Object(P["f"])("key","value")),"detail"===this.type&&this.firstQueryOrgProfile(this.identityId),this.initLoading=!1},async getAllInitData(){try{const e=await Object(P["e"])({profileMap:Object(P["a"])(f["d"],"revenueTemplateNameMap",{}),settlementCycleUnitList:Object(P["a"])(f["a"],"dictList",{type:"SettlementPeriod"})});return e}catch(e){return null}},async firstQueryOrgProfile(e){this.initLoading=!0,this.setEditModel(!1);const t=await this.getOrgProfile({orgId:e});this.initLoading=!1,t?(this.revenueFormData.isShowModel=!0,this.operationMode="2",this.setProfileConfig(t)):(this.revenueSettlement.isShowModel=!1,this.profileList=[],this.operationMode="1",this.revenueSettlement.profileId="",this.initLoading=!1)},async getOrgProfile({orgId:e,profileId:t}){let a={};e?a.orgId=e:a.profileId=t;const i=await Object(P["a"])(f["c"],"profile",a);return i},getProfileClick(){Object(P["a"])(f["d"],"revenueTemplateNameMap",{}).then(e=>{if(!e)return;const t=Object.entries(e);this.profileList=t.map(([e,t])=>({label:t,value:e}))})},async getProfileChange(e){if("detail"===this.type){const t="Changing the revenue settlement profile of the organization will delete data of the original revenue settlement profile. Are you sure to continue?";this.$confirm(t,"Confirm",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",closeOnClickModal:!1,type:"warning"}).then(async()=>{this.resetFields(),this.initLoading=!0,this.queryProfileData(e)})}else this.queryProfileData(e)},async queryProfileData(e){if(!e)return"detail"===this.type?(this.revenueFormData.isShowModel=!1,this.initLoading=!1,this.operationMode="3",this.profileList=[],void(this.revenueSettlement={template:!1,orgId:this.identityId})):void(this.revenueFormData.isShowModel=!1);this.revenueFormData.isShowModel=!0;const t=await this.getOrgProfile({profileId:e});this.initLoading=!1,t&&this.setProfileConfig(t)},setProfileConfig(e){const t=e.settlementProfileList.find(e=>e.settlementMinBalance)||{};this.revenueSettlement={...this.revenueFormData,...e,template:!1,settlementMinBalance:t.settlementMinBalance,orgId:this.identityId}},getLableToOptions(e,t){if(!e)return"-";if(!t||!t.length)return"";if("Please Select"===e)return"";const a=t.find(t=>t.value===e)||{};return a.label||"-"},PeriodicHandleChange(e){this.revenueFormData.periodicSwitch=e},startDateChange(e){this.revenueFormData.startDate=e},endDateChange(e){this.revenueFormData.endDate=e},handleTabClick(){},cancel(){this.$confirm("Are you sure to cancel the operation?","Cancel",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",closeOnClickModal:!1,type:"warning"}).then(()=>{this.firstQueryOrgProfile(this.identityId)})},onTimeUnitChange(){this.revenueFormData.intervalValue&&this.$refs["revenueForm"].validateField("intervalValue")},setStatus(){this.revenueFormData.isShowModel||"1"!==this.operationMode||(this.operationMode="3",this.revenueSettlement={template:!1,orgId:this.identityId})},excuteRevenueData(e){e.settlementProfileList.forEach(e=>{e.settlementMinBalance=Object(h["a"])(e.settlementMinBalance),e.grossLiabilityList.forEach(e=>{e.targetBalance=Object(h["a"])(e.targetBalance),e.triggerBalance=Object(h["a"])(e.triggerBalance)}),e.grossRevenueList.forEach(e=>{e.targetBalance=Object(h["a"])(e.targetBalance),e.triggerBalance=Object(h["a"])(e.triggerBalance)}),e.liabilityList.forEach(e=>{e.targetBalance=Object(h["a"])(e.targetBalance),e.triggerBalance=Object(h["a"])(e.triggerBalance)}),e.revenueList.forEach(e=>{e.targetBalance=Object(h["a"])(e.targetBalance),e.triggerBalance=Object(h["a"])(e.triggerBalance)})})},submitEvn(){this.setStatus(),"3"!==this.operationMode?this.$refs["revenueForm"].validateField(["targetBalance","triggerBalance"],e=>{if(e)return!1;this.submitEvnData()}):this.submitEvnData()},submitEvnData(){this.$refs["revenueForm"].validate(e=>{if(!e)return;let t={};"3"!==this.operationMode?(t=JSON.parse(JSON.stringify(this.revenueFormData)),this.excuteRevenueData(t)):t={template:!1,orgId:this.identityId},this.submitLoading=!0,this.$confirm("Are you sure to submit it?","Tips",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",closeOnClickModal:!1}).then(()=>{let e={operationMode:this.operationMode,profile:t};Object(f["e"])(e).then(e=>{e.header&&e.header.success&&(this.$modal.msgSuccess("orgRevenueSettlementProfile submitted successfully."),this.setEditModel(!1),this.firstQueryOrgProfile(this.identityId))}).finally(()=>{this.submitLoading=!1})})})},setEditModel(e){this.isEditModel=e,this.profileList=[],this.revenueSettlement.profileId?(this.revenueFormData.profileId="",this.revenueFormData.isShowModel=!0):this.revenueFormData.isShowModel=!1},resetFields(){this.$refs.revenueForm.resetFields()},inputMoney(e){let t=null;t="0"===e.target.value?Number(e.target.value):Number(e.target.value)||null,e.target.value=Object(h["d"])(t)},unInputMoney(e){e.target.value?this.revenueFormData.settlementMinBalance=Object(h["a"])(e.target.value):this.revenueFormData.settlementMinBalance=null},showBalanceWithUnit(e){return"USD"===e?"($)":`(${e})`},getDateFormat(e){return F()(e,"YYYY-MM-DD").format("DD/MM/YYYY")}},activated(){this.initPanel()}},O=x,M=(a("adbd"),a("ead9"),Object(c["a"])(O,o,r,!1,null,"33f68428",null));t["a"]=M.exports},6198:function(e,t,a){"use strict";a("bfbd")},6226:function(e,t,a){e.exports={activeMenuColor:"#366bfc",primaryColor:"#366bfc",menuColor:"#5c5c5c",fillEmphasisColor:"#5c5c5c",fillLightColor:"#fafafa",fillStrongColor:"#c7c7c7",fillRegularColor:"#f0f0f0",fillColorDark:"#e0e0e0",lineStrongColor:"#8f8f8f",textEmphasisColor:"#282828",backgroundColor:"#fff",statusErrorColor:"#ff4040",statusSuccessColor:"#27bf88",statusColorwarning:"#ff7420",statusColorSAecondaryWarning:"#faaf0c",statusNoticeColor:"#338bff",statusDark:"#c7c7c7",initialColor:"#E0E0E0",statusNoticeBackgroundColor:"#F0F9FF",statusErrorBackgroundColor:"#FFF2F0",statusSuccessBackgroundColor:"#F0FFF7",statusSecondaryWarningBackgroundColor:"#FFFBE6",statusWarningBackgroundColor:"#FFF6E6",statusDarkBackgroundColor:"#FAFAFA",lineColorBlue:"#ADD9FF",lineColorError:"#FFC1BA",lineColorGreen:"#A5E6C6",lineColorWarning:"#FFF7ed"}},"631b":function(e,t,a){"use strict";a("423d")},"67d5":function(e,t,a){"use strict";a("034d")},"689d":function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"e",(function(){return n})),a.d(t,"f",(function(){return o})),a.d(t,"c",(function(){return r})),a.d(t,"d",(function(){return s})),a.d(t,"b",(function(){return l}));const i=(e,t,...a)=>e(...a).then(e=>e.header&&e.header.success?e[t]:null).catch(()=>null),n=e=>{const t=Object.keys(e),a=Object.values(e);return Promise.all(a).then(e=>{const a=t.map((t,a)=>[t,e[a]]);return Object.fromEntries(a)})},o=(e,t,a=!1)=>i=>{const n={label:i[t],value:i[e]};return a?n:{...i,...n}},r=(e,t,a)=>{const i=e.find(e=>e[a]===t);return i},s=(e,t)=>{const a=r(e,t,"value")||{};return a["label"]},l=(e,t)=>{if(t||(t=new Map),!(e instanceof Object))return e;if(t.get(e))return t.get(e);let a;a=e instanceof Function?e.prototype?function(){return e.apply(this,arguments)}:(...t)=>e.call(void 0,...t):e instanceof Array?[]:e instanceof Date?new Date(e-0):e instanceof RegExp?new RegExp(e.sourceData,e.flags):{},t.set(e,a);for(let i in e)Object.hasOwnProperty.call(e,i)&&(a[i]=l(e[i],t));return a}},7335:function(e,t,a){e.exports={activeMenuColor:"#366bfc",primaryColor:"#366bfc",menuColor:"#5c5c5c",fillEmphasisColor:"#5c5c5c",fillLightColor:"#fafafa",fillStrongColor:"#c7c7c7",fillRegularColor:"#f0f0f0",fillColorDark:"#e0e0e0",lineStrongColor:"#8f8f8f",textEmphasisColor:"#282828",backgroundColor:"#fff",statusErrorColor:"#ff4040",statusSuccessColor:"#27bf88",statusColorwarning:"#ff7420",statusColorSAecondaryWarning:"#faaf0c",statusNoticeColor:"#338bff",statusDark:"#c7c7c7",initialColor:"#E0E0E0",statusNoticeBackgroundColor:"#F0F9FF",statusErrorBackgroundColor:"#FFF2F0",statusSuccessBackgroundColor:"#F0FFF7",statusSecondaryWarningBackgroundColor:"#FFFBE6",statusWarningBackgroundColor:"#FFF6E6",statusDarkBackgroundColor:"#FAFAFA",lineColorBlue:"#ADD9FF",lineColorError:"#FFC1BA",lineColorGreen:"#A5E6C6",lineColorWarning:"#FFF7ed"}},"786e":function(e,t,a){"use strict";a("4cd4")},7892:function(e,t,a){},"7c5e":function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return o})),a.d(t,"e",(function(){return r})),a.d(t,"a",(function(){return s})),a.d(t,"d",(function(){return l}));var i=a("d8d3");const n={NEW:"00",PENDING_ACTIVE:"02",ACTIVE:"03",SUSPENDED:"04",FROZEN:"05",CLOSED:"06",CAPPED:"07",DORMANT:"08"};function o(e){return i["c"][e]||"-"}function r(e){const t={[n.ACTIVE]:"ACTIVE",[n.SUSPENDED]:"SUSPENDED",[n.FROZEN]:"FROZEN"};return t[e]}const s={CAN_MAKE_AGGREGATOR:"0000",CAN_MAKE_OWNED:"0001",CAN_MAKE_ALLTYPE:"0002",NONEHIERARCHY:"0003",AGGREGATOR:"0100",CENTRAL_OWNED:"0101"},l=e=>{switch(e){case s.CAN_MAKE_AGGREGATOR:return"Can Make Aggregator";case s.CAN_MAKE_OWNED:return"Can Make Owned";case s.CAN_MAKE_ALLTYPE:return"Can Make AllType";case s.NONEHIERARCHY:return"NoneHierarchy";case s.AGGREGATOR:return"Aggregator";case s.CENTRAL_OWNED:return"Central Owned";default:return}}},"7f3c":function(e,t,a){"use strict";a("0798")},"89b2":function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"d",(function(){return o})),a.d(t,"c",(function(){return u})),a.d(t,"b",(function(){return f}));var i=a("02e3");let n=e=>e?(e=e.toString(),e=e.replace(/,/gi,""),e.indexOf(".00")>0&&(e=parseInt(e)),e):e,o=(e,t)=>{t=t||2;let a=",";if(null===e)return null;if("number"!==typeof e)throw new TypeError("The num parameter should be of the number type.");if(t<0)throw new Error("Parameter n should not be less than 0.");let i=parseInt(e)!==e,n=void 0!==t&&null!=t?t:1;return e=0===n?e.toFixed(n)+".":i?t?e.toFixed(t):e:e.toFixed(n),a=a||",",e=e.toString().replace(/(\d)(?=(\d{3})+\.)/g,(function(e,t){return t+a})),0!==t&&(i||t)||(e=e.substring(0,e.indexOf("."))),e},r=e=>({trigger:["blur","change"],required:!0,validator:(t,a,i)=>{let n=e.revenueFormData.intervalValue,o=e.revenueFormData.intervalTypeCode;return n&&o?n&&o&&(n>=1e4||n<=0)?i(new Error("Please enter a number between 1 and 9999.")):i():i(new Error("Please enter content"))}}),s=e=>({required:!0,validator:(t,a,i)=>{let n=e.revenueFormData.startDate;n||i(new Error("Please select content.")),i()},trigger:"change"}),l=e=>({required:!0,validator:(t,a,i)=>{e.subAgentExpansionModel||i(new Error("Please select content.")),i()},trigger:"change"}),c=e=>({required:!0,validator:(t,a,i)=>{e.subSettlementConfigTemplate||i(new Error("Please select content.")),i()},trigger:"change"}),d=()=>({trigger:"blur",validator:(e,t,a)=>{const i=t;t=n(i),t<-1e9?a(new Error("Please enter an amount greater than -1,000,000,000.")):t>1e9?a(new Error("Please enter an amount less than 1,000,000,000.")):a()}}),u=e=>({intervalValue:[r(e)],startDate:[s(e)],settlementMinBalance:[i["e"],d()],targetBalance:[i["e"],d()],triggerBalance:[i["e"],d()]}),f=e=>({subAgentExpansionModel:[l(e)],subSettlementConfigTemplate:[c(e)]})},"8b0f":function(e,t,a){"use strict";a("f71d")},"953e":function(e,t,a){"use strict";a("1e7b")},9981:function(e,t,a){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"create-success"},[e._m(0),e.iconText?t("div",{staticClass:"icon-text"},[e._v(e._s(e.iconText))]):e._e(),t("div",{staticClass:"success-info"},[e._v(e._s(e.successText))]),e.tip?t("div",{staticClass:"success-tip"},[e._v(e._s(e.tip))]):e._e(),t("div",{staticClass:"success-operate"},[t("span",{staticClass:"success-operate__pretext"},[e._v("You can:")]),e.detailText?t("span",{staticClass:"view-detail operate-btn",attrs:{id:"viewDetail"},on:{click:e.handleViewDetail}},[e._v(" "+e._s(e.detailText)+" ")]):e._e(),t("span",{staticClass:"operate-btn",attrs:{id:"continueAdd"},on:{click:e.handleContinueAddClick}},[e._v(e._s(e.addText))])])])},n=[function(){var e=this,t=e._self._c;return t("div",{staticClass:"check-icon"},[t("i",{staticClass:"el-icon-a-create-successsmall success-icon"})])}],o={name:"PortalCreateSuccess",props:{iconText:{type:String,default:""},successText:{type:String,default:"created successfully."},detailText:{type:String,default:"View Detail >>"},addText:{type:String,default:"Continue to Add >>"}},data(){return{tip:""}},methods:{handleViewDetail(){this.$emit("view-detail")},handleContinueAddClick(){this.$emit("continue-add")}}},r=o,s=(a("6198"),a("2877")),l=Object(s["a"])(r,i,n,!1,null,"c62ed3d4",null);t["a"]=l.exports},"99ce":function(e,t,a){},"9cd1":function(e,t,a){"use strict";a("6226")},a316:function(e,t,a){"use strict";a("cc28")},a546:function(e,t,a){},a857:function(e,t,a){},ac5c:function(e,t,a){"use strict";a("a546")},adbd:function(e,t,a){"use strict";a("2fa9")},b7e5:function(e,t,a){"use strict";a("7892")},bfbd:function(e,t,a){},cc28:function(e,t,a){},d3d3:function(e,t,a){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"footer-tap-button"},[t("div",{staticClass:"footer-tap-content",class:{"has-sidebar":e.hasSidebar}},[e.showCancel?t("el-button",{attrs:{id:"reset",type:"primary",plain:"",size:"small"},on:{click:e.resetHndle}},[e._v(e._s(e.$t("common.button.cancel")))]):e._e(),e.showCancel||e.hasOnlySubmitBtn?e._e():t("el-button",{attrs:{id:"reset",type:"primary",plain:"",size:"small"},on:{click:e.resetHndle}},[e._v(e._s(e.$t("common.button.reset")))]),e.showPrevious?t("el-button",{attrs:{id:"previous",size:"small",type:"primary",plain:""},on:{click:e.previousHandle}},[e._v(e._s(e.$t("common.button.prevent"))+" ")]):e._e(),e.showNext?t("el-button",{directives:[{name:"preventReClick",rawName:"v-preventReClick"}],attrs:{id:"next",size:"small",type:"primary",disabled:e.submitDisabled,loading:e.submitLoading},on:{click:e.nextHandle}},[e._v(e._s(e.$t("common.button.next")))]):t("el-button",{directives:[{name:"preventReClick",rawName:"v-preventReClick"}],attrs:{id:"Submit",size:"small",type:"primary",disabled:e.submitDisabled,loading:e.submitLoading},on:{click:e.submitHanle}},[e._v(" "+e._s(e.$t("common.button.submit"))+" ")])],1)])},n=[],o={name:"footer-tap-button",props:{activeName:{type:String,default:""},steps:{type:Array,default:()=>[]},submitLoading:{type:Boolean,default:!1},submitDisabled:{type:Boolean,default:!1},showCancel:{type:Boolean,default:!1},hasSidebar:{type:Boolean,default:!1},hasOnlySubmitBtn:{type:Boolean,default:!1}},data(){return{inputeValue:"",showQuickLinks:!1}},computed:{showNext(){const{steps:e,activeName:t}=this;return e.length&&e[e.length-1].name!==t},showPrevious(){const{steps:e,activeName:t}=this;return e.length&&e[0].name!==t}},methods:{resetHndle(){this.$emit("reset")},nextHandle(){this.$emit("next")},previousHandle(){this.$emit("previous")},submitHanle(){this.$emit("submit")}}},r=o,s=(a("67d5"),a("9cd1"),a("2877")),l=Object(s["a"])(r,i,n,!1,null,"6b579326",null);t["a"]=l.exports},e036:function(e,t,a){"use strict";a.d(t,"c",(function(){return n})),a.d(t,"d",(function(){return o})),a.d(t,"e",(function(){return r})),a.d(t,"b",(function(){return s})),a.d(t,"a",(function(){return l})),a.d(t,"f",(function(){return c}));var i=a("0bbd");function n(e){return Object(i["a"])({url:"/fintech/v1/settlement/revenue/org/queryOrgRevenueProfile",method:"post",data:e})}function o(e){return Object(i["a"])({url:"/fintech/v1/settlement/revenue/org/queryOrgRevenueTemplateNames",method:"post",data:e})}function r(e){return Object(i["a"])({url:"/fintech/v1/settlement/revenue/org/saveOrgRevenueProfile",method:"post",data:e})}function s(e){return Object(i["a"])({url:"/fintech/v1/settlement/queryCommissionCfg",method:"post",data:e})}function l(e){return Object(i["a"])({url:"/fintech/v1/settlement/dict/query",method:"post",data:e})}function c(e){return Object(i["a"])({url:"/fintech/v1/settlement/updateOrgCommiAgreement",method:"post",data:e})}},ead9:function(e,t,a){"use strict";a("7335")},eb59:function(e,t,a){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"steps-tabs-container"},[t("el-tabs",{staticClass:"info-tabs-container",staticStyle:{"margin-top":"20px","pointer-events":"none"},model:{value:e.tabsActiveName,callback:function(t){e.tabsActiveName=t},expression:"tabsActiveName"}},e._l(e.tabsPanel,(function(a,i){return t("el-tab-pane",{key:i,staticStyle:{"pointer-events":"auto"},attrs:{name:a.name}},[t("div",{attrs:{slot:"label"},slot:"label"},["COMPLETED"===e.getItemStatus(a,i)?t("div",{staticClass:"steps-container",class:{"complete-steps-container":"COMPLETED"===e.getItemStatus(a,i)}},[t("i",{staticClass:"el-icon-a-create-successsmall success-icon"})]):e._e(),"COMPLETED"!==e.getItemStatus(a,i)?t("div",{staticClass:"steps-container",class:{"active-steps-container":"ACTIVE"===e.getItemStatus(a,i)}},[e._v(" "+e._s(i+1)+" ")]):e._e(),t("div",{staticClass:"steps-title",class:{"active-steps-title":"ACTIVE"===e.getItemStatus(a,i)}},[e._v(" "+e._s(a.title)+" ")]),t("div",{staticClass:"steps-sub-title"},[e._v(e._s(a.subTitle))])]),e._t(a.name)],2)})),1)],1)},n=[],o={name:"StepsTabs",props:{activeName:{type:String,default:"first"},tabsPanel:{type:Array,default:()=>[]}},data(){return{tabsActiveName:""}},computed:{getItemStatus(){const e=this.activeName;return function(t,a){const i=this.tabsPanel.findIndex(t=>t.name===e);return a===i?"ACTIVE":a<i?"COMPLETED":"INACTIVE"}}},watch:{activeName(){this.tabsActiveName=this.activeName}},created(){this.tabsActiveName=this.activeName}},r=o,s=(a("fa55"),a("2877")),l=Object(s["a"])(r,i,n,!1,null,"5a4622ae",null);t["a"]=l.exports},f2e3:function(e,t,a){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{ref:"createBankAccountForm",staticClass:"add-form",attrs:{model:e.createBankAccountForm,"label-position":"top",size:"small",rules:e.formRules}},[t("el-row",{staticClass:"margin-bottom-20",attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("IDC.bankAccount.label.bankHeadOffice"),prop:"bankHeadOffice"}},[t("el-select",{attrs:{id:"bankHeadOffice",placeholder:e.$t("common.placeholder.select")},model:{value:e.createBankAccountForm.bankHeadOffice,callback:function(t){e.$set(e.createBankAccountForm,"bankHeadOffice",t)},expression:"createBankAccountForm.bankHeadOffice"}},e._l(e.bankHeadOfficeOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("IDC.bankAccount.label.bank"),prop:"bankId"}},[t("el-select",{attrs:{id:"bankId",placeholder:e.$t("common.placeholder.select")},model:{value:e.createBankAccountForm.bankId,callback:function(t){e.$set(e.createBankAccountForm,"bankId",t)},expression:"createBankAccountForm.bankId"}},e._l(e.bankOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),e.showBankBox?t("div",{staticClass:"bank-box"},e._l(e.bankDatas,(function(a){return t("div",{key:a.label,staticClass:"content-container"},[e._v(" "+e._s(a.label+": "+(a.content?a.content:"-"))+" ")])})),0):e._e(),t("el-row",{staticClass:"margin-bottom-20",attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("IDC.bankAccount.label.assetType"),prop:"assetType"}},[t("el-select",{attrs:{id:"assetType",placeholder:e.$t("common.placeholder.select")},model:{value:e.createBankAccountForm.assetType,callback:function(t){e.$set(e.createBankAccountForm,"assetType",t)},expression:"createBankAccountForm.assetType"}},e._l(e.assetTypeOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("IDC.bankAccount.label.currency"),prop:"currency"}},[t("el-select",{attrs:{id:"currency",placeholder:e.$t("common.placeholder.select")},model:{value:e.createBankAccountForm.currency,callback:function(t){e.$set(e.createBankAccountForm,"currency",t)},expression:"createBankAccountForm.currency"}},e._l(e.currencyOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),t("el-row",{staticClass:"margin-bottom-20",attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("IDC.bankAccount.label.accountName"),prop:"accountName"}},[t("el-input",{attrs:{id:"accountName",placeholder:e.$t("common.placeholder.enter")},model:{value:e.createBankAccountForm.accountName,callback:function(t){e.$set(e.createBankAccountForm,"accountName","string"===typeof t?t.trim():t)},expression:"createBankAccountForm.accountName"}})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("IDC.bankAccount.label.accountNumber"),prop:"accountNo"}},[t("el-input",{attrs:{id:"accountNo",placeholder:e.$t("common.placeholder.enter")},model:{value:e.createBankAccountForm.accountNo,callback:function(t){e.$set(e.createBankAccountForm,"accountNo","string"===typeof t?t.trim():t)},expression:"createBankAccountForm.accountNo"}})],1)],1)],1),t("el-row",{staticClass:"margin-bottom-20",attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{staticClass:"date-box",attrs:{label:e.$t("IDC.bankAccount.label.validityPeriod"),prop:"validityPeriod"}},[t("el-date-picker",{attrs:{type:"daterange","value-format":"yyyy-MM-dd HH:mm:ss.SSS",format:"dd/MM/yyyy","range-separator":"~","start-placeholder":e.$t("common.placeholder.select"),"end-placeholder":e.$t("common.placeholder.select")},model:{value:e.createBankAccountForm.validityPeriod,callback:function(t){e.$set(e.createBankAccountForm,"validityPeriod",t)},expression:"createBankAccountForm.validityPeriod"}}),t("i",{class:["el-icon-date","date-icon"]})],1)],1),t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("IDC.bankAccount.label.transferMode"),prop:"transferMode"}},[t("el-select",{attrs:{id:"transferMode",placeholder:e.$t("common.placeholder.select")},model:{value:e.createBankAccountForm.transferMode,callback:function(t){e.$set(e.createBankAccountForm,"transferMode",t)},expression:"createBankAccountForm.transferMode"}},e._l(e.transferModeOptions,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)],1)],1),t("el-row",{staticClass:"margin-bottom-20",attrs:{gutter:20}},[t("el-col",{attrs:{span:12}},[t("el-form-item",{attrs:{label:e.$t("IDC.bankAccount.label.iban"),prop:"iban"}},[t("el-input",{attrs:{id:"iban",placeholder:e.$t("common.placeholder.enter")},model:{value:e.createBankAccountForm.iban,callback:function(t){e.$set(e.createBankAccountForm,"iban","string"===typeof t?t.trim():t)},expression:"createBankAccountForm.iban"}})],1)],1)],1)],1)],1)},n=[],o=a("f33d"),r=a("02e3"),s={name:"BankAccountDialog",data(){return{currencyOptions:[],bankHeadOfficeOptions:[],bankOptions:[],assetTypeOptions:[],transferModeOptions:[],formRules:{bankHeadOffice:[r["z"]],bankId:[r["z"]],assetType:[r["z"]],currency:[r["z"]],accountName:[r["e"],r["w"],r["m"]],accountNo:[r["e"],r["y"],Object(r["d"])({minLen:10,maxLen:64})],iban:[r["w"],Object(r["d"])({minLen:0,maxLen:34})]},showBankBox:!1,bankDatas:[{label:this.$t("IDC.bankAccount.label.bankShortCode"),value:"bankShortCode"},{label:this.$t("IDC.bankAccount.label.bankAddress"),value:"bankAddress"},{label:this.$t("IDC.bankAccount.label.financeService"),value:"financeService"},{label:this.$t("IDC.bankAccount.label.trustBank"),value:"trustBankCode"}]}},props:["createBankAccountForm","identityId"],watch:{"createBankAccountForm.bankHeadOffice":{handler(){this.getBankList()},deep:!0},"createBankAccountForm.bankId":{handler(e){e?(this.$delete(this.bankDatas,"content"),this.getCurrentBankInfo({bankId:e}),this.showBankBox=!0):this.showBankBox=!1},deep:!0}},methods:{querySelectList(){this.getBankHeadOfficeList(),this.geCurrencyList(),this.getAssetTypeList(),this.getTransferMode()},async getBankHeadOfficeList(){this.bankHeadOfficeOptions=[];let e=await Object(o["c"])({});if(e.header&&e.header.success){let t=JSON.parse(e.jsonDataStr);t.map(e=>{let t={value:e.code,label:e.value};this.bankHeadOfficeOptions.push(t)})}},async getBankList(){this.bankOptions=[],this.createBankAccountForm.bankId="";let e={pageNo:1,pageSize:100,bankHeadOffice:this.createBankAccountForm.bankHeadOffice},t=await Object(o["h"])(e);t.header&&t.header.success&&t.banks&&t.banks.length>0&&t.banks.map(e=>{let t={value:e.bankId,label:e.bankName};this.bankOptions.push(t)})},async geCurrencyList(){this.currencyOptions=[];let e=await Object(o["i"])({dictType:"Currency"});if(e.header&&e.header.success){let t=JSON.parse(e.dataDictJson);t.map(e=>{let t={value:e.code,label:e.code};this.currencyOptions.push(t)})}},async getAssetTypeList(){this.assetTypeOptions=[];let e=await Object(o["i"])({dictType:"AssetType"});if(e.header&&e.header.success){let t=JSON.parse(e.dataDictJson);t.map(e=>{let t={value:e.code,label:e.name};this.assetTypeOptions.push(t)})}},async getTransferMode(){this.transferModeOptions=[];let e=await Object(o["e"])();if(e.header&&e.header.success){let t=JSON.parse(e.jsonDataStr);t.map(e=>{let t={value:e.code,label:e.value};this.transferModeOptions.push(t)})}},async getCurrentBankInfo(e){try{let t=await Object(o["d"])(e);if(t&&t.header.success){let e=[];for(const i in t.bank)"isDepositBank"===i&&!0===t.bank[i]&&e.push("Deposit Bank"),"isTrustBank"===i&&!0===t.bank[i]&&e.push("Trust Bank"),"isCardIssuingBank"===i&&!0===t.bank[i]&&e.push("Card Issuing Bank");let a=t.bankKYC.kycGroupList.filter(e=>1003===e.kycGroupId&&1007===e.kycFieldId);this.bankDatas.forEach(i=>{"financeService"===i.value?i.content=e.join(","):"trustBankCode"===i.value?i.content=t.bank.trustBankCode:"bankShortCode"===i.value?i.content=t.bank.bankShortCode:"bankAddress"===i.value&&(i.content=a.length?a[0].inputValue:"")}),this.bankDatas=JSON.parse(JSON.stringify(this.bankDatas))}}catch(t){}}},created(){this.querySelectList()},mounted(){}},l=s,c=(a("138f"),a("2877")),d=Object(c["a"])(l,i,n,!1,null,"667fcd56",null);t["a"]=d.exports},f306:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"org-create create-page-content"},[t("div",{directives:[{name:"show",rawName:"v-show",value:!e.createCompleted,expression:"!createCompleted"}]},[t("portal-header",{attrs:{projectObj:e.childTitleConfig,showBottomLine:!1,lazy:!0}}),t("div",[t("steps-tabs",{staticStyle:{padding:"0"},attrs:{activeName:e.activeName,"tabs-panel":e.tabsPanel}},[t("template",{slot:"first"},[e.identityInfo.orgNameRegex?t("identity-info",{ref:"identityTab",attrs:{type:e.type,identityInfo:e.identityInfo,assignInfo:e.assignInfo,isViewMode:!1,kycInfo:e.kycInfo,hasDefaultParentShortCode:e.hasDefaultParentShortCode},on:{"update:identityInfo":function(t){e.identityInfo=t},"update:identity-info":function(t){e.identityInfo=t},"update:assignInfo":function(t){e.assignInfo=t},"update:assign-info":function(t){e.assignInfo=t},"update:kycInfo":function(t){e.kycInfo=t},"update:kyc-info":function(t){e.kycInfo=t}}}):t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.detaileLoading,expression:"detaileLoading"}],style:e.styles})],1),t("template",{slot:"second"},["second"===e.activeName?t("assign-info",{ref:"assignInfoTab",attrs:{type:e.type,assignInfo:e.assignInfo,identityInfo:e.identityInfo,isViewMode:!1},on:{"update:assignInfo":function(t){e.assignInfo=t},"update:assign-info":function(t){e.assignInfo=t},"refresh-accountType":e.refreshAccountTypeEvn}}):e._e()],1),t("template",{slot:"third"},[t("identity-info",{attrs:{identityInfo:e.identityInfo,assignInfo:e.assignInfo,kycInfo:e.kycInfo,type:e.type,isViewMode:!0},on:{"update:identityInfo":function(t){e.identityInfo=t},"update:identity-info":function(t){e.identityInfo=t},"update:assignInfo":function(t){e.assignInfo=t},"update:assign-info":function(t){e.assignInfo=t},"update:kycInfo":function(t){e.kycInfo=t},"update:kyc-info":function(t){e.kycInfo=t}}}),t("assign-info",{attrs:{type:e.type,assignInfo:e.assignInfo,isViewMode:!0},on:{"update:assignInfo":function(t){e.assignInfo=t},"update:assign-info":function(t){e.assignInfo=t}}})],1)],2)],1),t("footer-tap",{attrs:{showCancel:!0,"submit-loading":e.submitLoading,"active-name":e.activeName,submitDisabled:!e.hasPerm("IC_IDENTITY_CREATESUBORG_NEXT_BTN"),steps:e.tabsPanel},on:{reset:e.cancel,previous:e.previous,next:e.next,submit:e.submit}})],1),t("div",{directives:[{name:"show",rawName:"v-show",value:e.createCompleted,expression:"createCompleted"}],staticClass:"portal-success-container"},[t("portal-create-success",{attrs:{successText:"Operation succeeded."},on:{"view-detail":e.goViewDetail,"continue-add":e.continueAdd}})],1)])},n=[],o=a("c811"),r=a("9981"),s=a("eb59"),l=function(){var e=this,t=e._self._c;return t("div",{staticClass:"identity-info"},[t("el-form",{ref:"identityInfo",attrs:{model:e.identityInfo,rules:e.identityRules,"label-position":"top",size:"small"}},[t("simple-collapse",{staticClass:"panel-collapse has-subTitle margin-bottom-20",attrs:{title:e.$t("IDC.organization.product"),name:"roleInfo"}},[e.isViewMode?e._e():t("div",{staticClass:"tips p-l-r-20",staticStyle:{"margin-top":"8px"}},[e._v(" After a basic product is selected for an identity, the system displays the minimum trust level and mandatory KYC fields required for the product. ")]),t("div",{staticStyle:{"margin-top":"13px"}},[t("el-divider")],1),t("div",{staticClass:"p-l-r-20"},[e.isViewMode||0!==this.identityInfo.selectedProdList.length?t("div",[e.isViewMode?e._e():t("div",{staticClass:"edit-prod el-form-item-with-btn",attrs:{id:"editProd"}},[t("el-form-item",{attrs:{prop:"selectedProdList"}},[t("el-button",{attrs:{slot:"label",icon:"el-icon-edit",type:"primary",plain:"",size:"small"},on:{click:function(t){e.showProductPopup=!0}},slot:"label"},[e._v(" "+e._s(e.$t("IDC.orgCustomer.edit"))+" ")])],1)],1),e.isViewMode?t("div",{staticClass:"sub-block__title"},[e._v("Product List")]):e._e(),e.isViewMode?t("table-page",{staticStyle:{"margin-bottom":"20px"},attrs:{size:"small","has-pagination":!1,columns:e.productColumns,outSideTableData:e.identityInfo.selectedProdList},scopedSlots:e._u([{key:"trustLevel",fn:function(t){return[e._v(" "+e._s(`${t.data.row.trustLevel||""}:${t.data.row.trustLevelName||""}`)+" ")]}}])}):t("table-page",{directives:[{name:"loading",rawName:"v-loading",value:e.prodLoading,expression:"prodLoading"}],ref:"productListTable",staticStyle:{"margin-bottom":"20px"},attrs:{size:"small",isSingleCheck:!1,"has-pagination":!1,columns:e.productColumns,outSideTableData:e.identityInfo.selectedProdList},scopedSlots:e._u([{key:"trustLevel",fn:function(t){return[e._v(" "+e._s(`${t.data.row.trustLevel||""}:${t.data.row.trustLevelName||""}`)+" ")]}}],null,!1,3472179913)})],1):t("div",{staticClass:"add-prod el-form-item-with-btn",attrs:{id:"addProd"}},[t("el-form-item",{attrs:{prop:"selectedProdList",required:""}},[t("el-button",{attrs:{slot:"label",icon:"el-icon-plus",type:"primary",plain:"",size:"small"},on:{click:function(t){e.showProductPopup=!0}},slot:"label"},[e._v(" Add ")])],1)],1)])]),t("simple-collapse",{staticClass:"panel-collapse margin-bottom-20",attrs:{title:e.$t("IDC.organization.identityInfo"),name:"identityInfo"}},[t("el-divider"),t("div",{staticClass:"p-l-r-20 p-b-6"},[t("div",{staticClass:"sub-block__title"},[e._v(e._s(e.$t("IDC.organization.basicInfo")))]),t("el-row",{staticClass:"el-row--flex flex-wrap",attrs:{gutter:20}},[t("el-col",{staticClass:"el-col-auto-span"},[t("el-form-item",{ref:"parentShortCode",staticClass:"form-more-select-box el-form-item-parent-short-code",attrs:{prop:"parentShortCode",label:e.$t("IDC.organization.parentShortCode")}},[e.isViewMode?t("div",[t("span",{domProps:{textContent:e._s(e.identityInfo.parentShortCode)}})]):t("el-input",{attrs:{id:"parentShortCode",maxlength:"24",disabled:e.hasDefaultParentShortCode||!e.identityInfo.selectedProdList.length,clearable:""},on:{change:e.onParentShortCodeChange},model:{value:e.identityInfo.parentShortCode,callback:function(t){e.$set(e.identityInfo,"parentShortCode",t)},expression:"identityInfo.parentShortCode"}},[e.identityInfo.selectedProdList.length&&!e.identityInfo.defalutParentShortCode?t("el-link",{staticClass:"short-code-icon el-icon-more__suffix--cursor",attrs:{slot:"append",icon:"el-icon-more",underline:!1},on:{click:function(t){e.shortCodeDialogVisible=!0}},slot:"append"}):t("el-link",{staticClass:"short-code-icon el-icon-more__suffix--disabled",attrs:{slot:"append",icon:"el-icon-more",underline:!1},slot:"append"})],1)],1)],1),t("el-col",{staticClass:"el-col-auto-span"},[t("el-form-item",{ref:"parentOrgName",attrs:{prop:"parentOrgName",label:e.$t("IDC.organization.parentOrganizationName"),required:!e.isViewMode,"show-message":!1}},[e.isViewMode?t("div",[t("span",{domProps:{textContent:e._s(e.identityInfo.parentOrgName)}})]):t("el-input",{attrs:{id:"parentOrgName",disabled:""},model:{value:e.identityInfo.parentOrgName,callback:function(t){e.$set(e.identityInfo,"parentOrgName",t)},expression:"identityInfo.parentOrgName"}})],1)],1),t("el-col",{staticClass:"el-col-auto-span"},[t("el-form-item",{ref:"shortCode",attrs:{prop:"shortCode",label:e.isViewMode?e.$t("IDC.organization.shortCode"):""}},[e.isViewMode?t("div",[t("span",{domProps:{textContent:e._s(e.identityInfo.shortCode)}})]):t("div",{staticClass:"el-form-item-double-lable"},[t("div",{staticClass:"el-form-item-double-lable__group"},[t("label",{staticClass:"el-form-item__label el-form-item__label-left el-form-item__label-req",attrs:{slot:"label"},slot:"label"},[e._v(e._s(e.$t("IDC.organization.shortCode")))]),e.identifierBtnisShow?t("label",{staticClass:"el-form-item__label el-form-item__label-right cusor-pointer",on:{click:e.generateIdentifierByBtn}},[e._v(e._s(e.$t("IDC.organization.generateAnotherIdentifier")))]):e._e()]),t("el-input",{attrs:{id:"shortCode",placeholder:"Please enter",maxlength:"24",clearable:""},model:{value:e.identityInfo.shortCode,callback:function(t){e.$set(e.identityInfo,"shortCode","string"===typeof t?t.trim():t)},expression:"identityInfo.shortCode"}})],1)])],1),t("el-col",{staticClass:"el-col-auto-span"},[t("el-form-item",{ref:"merchName",attrs:{prop:"merchName",label:e.$t("IDC.organization.organizationName")}},[e.isViewMode?t("div",[t("span",{domProps:{textContent:e._s(e.identityInfo.merchName)}})]):t("el-input",{attrs:{id:"merchName",placeholder:e.$t("common.placeholder.enter"),maxlength:"256",clearable:""},model:{value:e.identityInfo.merchName,callback:function(t){e.$set(e.identityInfo,"merchName",t)},expression:"identityInfo.merchName"}})],1)],1)],1)],1)],1),t("simple-collapse",{staticClass:"panel-collapse",attrs:{title:e.$t("IDC.organization.kycInfo"),name:"kycInfo"}},[t("el-divider"),t("div",{staticClass:"org-kyc-form"},[t("kyc-form",{ref:"OrgKycInfo",attrs:{identityClassify:"org",kycInfo:e.kycFormData,identityType:5002,mode:""+(e.isViewMode?"review":"create"),reviewKycData:e.kycInfo,adaptiveLayout:!0,basicProductId:e.identityInfo.basicProductId},on:{"update:kycInfo":function(t){e.kycFormData=t},"update:kyc-info":function(t){e.kycFormData=t}}})],1)],1)],1),t("portal-short-code",{attrs:{searchVisible:e.shortCodeDialogVisible,"short-code":e.identityInfo.parentShortCode,initializingLoading:!1},on:{"update:searchVisible":function(t){e.shortCodeDialogVisible=t},"update:search-visible":function(t){e.shortCodeDialogVisible=t},"selected-data":e.fillSelectedData}}),e.isViewMode?e._e():t("portal-add-popup",{attrs:{searchVisible:e.showProductPopup,isCheck:!0,isSingleCheck:!0,isCheckMemory:!0,isShowSearch:!0,hasPagination:!0,addForm:e.productPopupConf,"init-checks":e.identityInfo.selectedProdList,childSearch:e.getProduct},on:{"update:searchVisible":function(t){e.showProductPopup=t},"update:search-visible":function(t){e.showProductPopup=t},"submit-call-back":e.addProduct},scopedSlots:e._u([{key:"trustLevel",fn:function(t){return[e._v(" "+e._s(`${t.row.trustLevel}:${t.row.trustLevelName}`)+" ")]}}],null,!1,776694217)})],1)},c=[],d=a("cb9d"),u=a("3d79"),f=a("5b4e"),p=a("1d77"),m=a("4c09"),h=a("8f48"),g=a("0cbd");const b="Organization";var y={name:"IdentityInfo",components:{TablePage:m["a"],SimpleCollapse:p["a"],portalShortCode:h["a"],PortalAddPopup:g["a"],KycForm:f["a"]},props:{isViewMode:{type:Boolean,default:!0},type:{type:String,default:"top"},identityInfo:{type:Object,default:()=>{}},assignInfo:{type:Object,default:()=>{}},kycInfo:{type:Object,default:()=>{}},hasDefaultParentShortCode:Boolean},data(){return{kycFormData:{},basicProductId:"",showProductPopup:!1,productPopupConf:{title:"Add Product",label:"Product Name",idKey:"productId",columns:[{label:"Product Name",prop:"productName",align:"left"},{label:"Trust Level",prop:"trustLevel",align:"left",__slotName:"trustLevel"},{label:this.$t("common.label.description"),prop:"productDesc",align:"left"}],searchForm:{formData:{name:null},formConf:[{label:"Product Name",key:"name",prop:"name",comp:"el-input",bind:{clearable:!0,placeholder:this.$t("common.placeholder.enter")}}]}},shortCodeDialogVisible:!1,prodLoading:!1,identifierBtnisShow:!1,productColumns:[{label:"Product Name",prop:"productName",align:"left"},{label:"Trust Level",prop:"trustLevel",align:"left",__slotName:"trustLevel"},{label:this.$t("common.label.description"),prop:"productDesc",align:"left"}],identityRules:this.isViewMode?{}:Object(u["d"])(this.identityInfo,this.assignInfo),languageOptions:[],channelOptions:[]}},created(){this.firstCheckIdentitiferBtn(),this.initLanguage()},watch:{kycFormData:{handler(e){e&&this.$emit("update:kycInfo",JSON.parse(JSON.stringify(e)))},deep:!0}},mounted(){window.addEventListener("beforeunload",this.onBeforeWindowClosed),this.identityInfo.defalutParentShortCode&&this.onParentShortCodeChange(this.identityInfo.defalutParentShortCode)},methods:{getIdentityKYCData(){return this.$refs.OrgKycInfo.getKYCRequestParams()},fillSelectedData(e){this.identityInfo.parentShortCode=e,this.onParentShortCodeChange(e),this.identityRules=this.isViewMode?{}:Object(u["d"])(this.identityInfo,this.assignInfo)},validateRoleAndProduct(){this.validateIdenFormFields(["selectedProdList"])},validateIdenFormFields(e){this.$refs["identityInfo"].validateField(e)},addProduct(e){this.identityInfo.selectedProdList.length&&this.identityInfo.parentShortCode&&(this.identityRules=this.isViewMode?{}:Object(u["d"])(this.identityInfo,this.assignInfo)),this.identityInfo.basicProductId=e.productId,this.identityInfo.trustLevelName=e.trustLevelName,this.assignInfo.basicProductUniqueId=e.uniqueId;let t=[];e||(t=[]),Array.isArray(e)&&(t=e),e.isProduct=0,t=t.concat(e),this.identityInfo.selectedProdList=t},async getProduct(e){return new Promise(t=>{this.prodLoading=!0;let a={pageNo:e.pageNo||1,identitySubType:5002};e.searchKey&&(a.productName=e.searchKey.name),this.identityInfo.defalutParentShortCode&&(a.parentShortCode=this.identityInfo.defalutParentShortCode,a.identityId=this.identityInfo.parentIdentityId),Object(d["I"])(a).then(e=>{e.header&&e.header.success&&(e.list=e.products,e.total=e.page.totalSize),t(e)}).catch(()=>{}).finally(()=>{this.prodLoading=!1})})},initLanguage(){Object(d["w"])().then(e=>{e.header&&e.header.success&&(this.languageOptions=e.list||[])})},getLanguageName(e){let t=this.languageOptions.find(t=>t.languageCode===e);return t?t.languageName:e},validateProd(){let e=!0;return 0===this.identityInfo.selectedProdList.length&&(e=!1),e},validate(){return new Promise(e=>{let t=new Promise(e=>{this.$refs["identityInfo"].validate(t=>e(t))}),a=this.validateProd();t.then(t=>e(t&&a))})},clearValidate(e){window.requestIdleCallback(()=>{this.$refs["identityInfo"].clearValidate(e)})},resetFields(){this.$refs["identityInfo"].resetFields(),this.identityInfo.selectedProdList=[]},async onParentShortCodeChange(e){if(!e)return;this.validateIdenFormFields(["parentShortCode"]);const t={identityType:b,type:"child",parentCode:e},a=await this.checkIdentifierBtn(t);this.identifierBtnisShow=!!a},deleteIdentifier(e){return e?Object(d["l"])({identifier:e,identityType:b}).then(e=>!(!e.header||!e.header.success)).catch(()=>!1):Promise.resolve(!1)},checkIdentifierBtn(e){return Object(d["e"])(e).then(e=>!(!e.header||!e.header.success)&&!0===e.hasRule).catch(()=>!1)},generateIdentifier(e){return Object(d["o"])(e).then(e=>!(!e.header||!e.header.success)&&e.identifier).catch(()=>!1)},async generateIdentifierByBtn(){const e={identityType:b,preCode:this.identityInfo.shortCode,parentCode:this.identityInfo.parentShortCode,isBtnTrigger:!0},t=await this.generateIdentifier(e);(""===t||t)&&(this.identityInfo.shortCode=t,this.clearValidate(["shortCode"]))},async firstCheckIdentitiferBtn(){const e={identityType:b,type:"child",parentCode:null},t=await this.checkIdentifierBtn(e);if(!t)return this.identifierBtnisShow=!1,void(this.identityInfo.shortCode="");const a={identityType:b,preCode:"",parentCode:null,isBtnTrigger:!1},i=await this.generateIdentifier(a);(""===i||i)&&(this.identifierBtnisShow=!0,this.identityInfo.shortCode=i,this.clearValidate(["shortCode"]))},onBeforeWindowClosed(){this.deleteIdentifier(this.identityInfo.shortCode)}}},v=y,C=(a("a316"),a("2877")),I=Object(C["a"])(v,l,c,!1,null,"643730f8",null),k=I.exports,w=function(){var e=this,t=e._self._c;return t("div",[t("el-form",{ref:"assignInfo",attrs:{model:e.assignInfo,rules:e.assignRules,"label-position":"top",size:"small"}},[t("simple-collapse",{staticClass:"panel-collapse m-b-16",attrs:{title:"Trust Level and Segment",name:"trustLevelInfo"}},[t("el-divider"),t("div",{staticClass:"p-l-r-20 p-b-6"},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{ref:"trustLevel",attrs:{prop:"trustLevel",label:"Trust Level"}},[t("div",[t("span",{domProps:{textContent:e._s(`${e.assignInfo.trustLevel||""}:${e.assignInfo.trustLevelName||""}`)}})])])],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{ref:"segment",attrs:{prop:"segment",label:"Segment"}},[t("div",[t("span",{domProps:{textContent:e._s(""+(e.assignInfo.selectSegmentName||"-"))}})])])],1)],1)],1)],1),t("org-create-subscribe-product",{attrs:{assignInfo:e.assignInfo,isViewMode:e.isViewMode},on:{"refresh-accountType":e.refreshAccountTypeEvn}}),t("simple-collapse",{staticClass:"panel-collapse m-b-16",attrs:{title:"Profiile"}},[t("el-divider"),t("org-create-profile",{attrs:{assignInfo:e.assignInfo,isViewMode:e.isViewMode,identityInfo:e.identityInfo,profileConfig:e.assignInfo.profileConfig},on:{"use-default":e.useDefaulProfile}})],1),t("simple-collapse",{staticClass:"panel-collapse m-b-16",attrs:{title:"Account"}},[t("el-divider"),t("org-create-account",{attrs:{isViewMode:e.isViewMode,profileConfig:e.assignInfo.profileConfig}})],1),e.assignInfo.parentIdentityModel?t("simple-collapse",{staticClass:"panel-collapse margin-bottom-20",attrs:{title:e.$t("IDC.organization.hierachy")}},[t("el-divider"),t("org-create-hierachy",{attrs:{assignInfo:e.assignInfo,isViewMode:e.isViewMode,identityInfo:e.identityInfo}})],1):e._e(),t("simple-collapse",{staticClass:"panel-collapse m-b-16",attrs:{title:e.$t("IDC.organization.bankAccount")}},[t("el-divider",{staticStyle:{margin:"0 0 10px"}}),t("org-create-bank-account",{attrs:{assignInfo:e.assignInfo,isViewMode:e.isViewMode,identityInfo:e.identityInfo}})],1),t("simple-collapse",{staticClass:"panel-collapse m-b-16",attrs:{title:e.$t("IDC.organization.bankAccount")}},[t("el-divider",{staticStyle:{margin:"0 0 10px"}}),t("revenue-settlement-info",{ref:"revenueSettlementInfo",attrs:{isViewMode:e.isViewMode,panelActived:!0,pageType:e.pageType,revenueFormData:e.assignInfo.revenueFormData,assignInfo:e.assignInfo,isShowModel:e.isShowModel},on:{"update:revenueFormData":function(t){return e.$set(e.assignInfo,"revenueFormData",t)},"update:revenue-form-data":function(t){return e.$set(e.assignInfo,"revenueFormData",t)}}})],1),t("simple-collapse",{staticClass:"panel-collapse m-b-16",attrs:{title:e.$t("IDC.revenueSettlementInfo.commissionSettlementConfig")}},[t("el-divider",{staticClass:"divider-margin-10"}),t("commission-settlement-info",{ref:"commissionSettlementInfo",attrs:{isViewMode:e.isViewMode,panelActived:!0,assignInfo:e.assignInfo,profileFormTemp:e.assignInfo.profileFormTemp},on:{"update:profileFormTemp":function(t){return e.$set(e.assignInfo,"profileFormTemp",t)},"update:profile-form-temp":function(t){return e.$set(e.assignInfo,"profileFormTemp",t)}}})],1)],1)],1)},D=[],S=function(){var e=this,t=e._self._c;return t("div",{staticClass:"subscripb-product"},[t("simple-collapse",{staticClass:"panel-collapse m-b-16",attrs:{title:e.$t("IDC.organization.product")}},[t("el-divider",{staticStyle:{margin:"0 0 10px"}}),t("div",{staticClass:"sub-block p-b-6"},[e.isViewMode?e._e():t("div",{staticClass:"tips m-b-16"},[e._v(" Subscribe to products for the organization. The trust level determines the products, in addition to basic products, to which the organization can subscribe. ")]),e.isViewMode?e._e():t("el-button",{staticClass:"m-b-16",attrs:{icon:"el-icon-plus",size:"small",type:"primary",plain:""},on:{click:function(t){e.addScribeProductDialogVisible=!0}}},[e._v(" "+e._s(e.$t("common.button.add"))+" ")]),t("div",{staticClass:"sub-block__fields"},[t("div",{staticClass:"p-b-18"},[t("org-product-table",{directives:[{name:"loading",rawName:"v-loading",value:e.prodLoading,expression:"prodLoading"}],attrs:{columns:e.subscribeProductsColumns,outSideTableData:e.assignInfo.products,maxHeight:280},scopedSlots:e._u([{key:"effectiveTime",fn:function(a){return[t("el-form",{ref:"effectiveDate",attrs:{model:a.data.row,rules:{effectiveDate:{required:!0,message:"Please enter content",trigger:"blur"}},"label-position":"top",size:"small"}},[e.isViewMode?t("span",{domProps:{textContent:e._s(a.data.row.effectiveDate)}}):t("el-form-item",{attrs:{prop:"effectiveDate"}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{"value-format":e.DATE_FORMAT.COMP_VALUE,format:e.DATE_FORMAT.COMP_DISPLAY,type:"date",size:"small",placeholder:e.$t("common.placeholder.enter"),"picker-options":e.pickerOptionsEffectiveDate(a.data.row.effectiveDateInit,a.data.row.expireDateInit)},model:{value:a.data.row.effectiveDate,callback:function(t){e.$set(a.data.row,"effectiveDate",t)},expression:"scope.data.row.effectiveDate"}})],1)],1)]}},{key:"expireTime",fn:function(a){return[t("el-form",{ref:"expireDate",attrs:{model:a.data.row,rules:{expireDate:{required:!0,message:"Please enter content",trigger:"blur"}},"label-position":"top",size:"small"}},[e.isViewMode?t("span",{domProps:{textContent:e._s(a.data.row.expireDate)}}):t("el-form-item",{attrs:{prop:"expireDate"}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{"value-format":e.DATE_FORMAT.COMP_VALUE,format:e.DATE_FORMAT.COMP_DISPLAY,type:"date",size:"small",placeholder:e.$t("common.placeholder.enter"),"picker-options":e.pickerOptionsEffectiveDate(a.data.row.effectiveDateInit,a.data.row.expireDateInit)},model:{value:a.data.row.expireDate,callback:function(t){e.$set(a.data.row,"expireDate",t)},expression:"scope.data.row.expireDate"}})],1)],1)]}},{key:"chargeProfile",fn:function(a){return[e.isViewMode?t("span",[e._v(" "+e._s(e._f("productChargeProfile")(a.data.row))+" ")]):e._e(),a.data.row.chargeProfiles&&a.data.row.chargeProfiles.length>0&&!e.isViewMode?t("el-select",{staticClass:"charge-profile-select",attrs:{placeholder:"Please select"},model:{value:a.data.row.chargeProfileId,callback:function(t){e.$set(a.data.row,"chargeProfileId",t)},expression:"scope.data.row.chargeProfileId"}},e._l(a.data.row.chargeProfiles,(function(e){return t("el-option",{key:e.chargeProfileId,attrs:{label:e.chargeProfileName,value:e.chargeProfileId}})})),1):e._e()]}},{key:"operation",fn:function(a){return[a.data.row.isProduct>0?t("el-button",{attrs:{type:"text",size:"small"},on:{click:()=>e.deletNewProductFromSelected(a.data.$index)}},[e._v("Delete")]):e._e()]}}])})],1)])],1)],1),e.assignInfo.showBillReferenceNumberValidation?t("simple-collapse",{staticClass:"panel-collapse m-b-16",attrs:{title:"Bill Reference Number Validation"}},[t("el-divider",{staticStyle:{margin:"0 0 10px"}}),t("div",[t("el-row",{attrs:{gutter:20}},[t("el-col",{staticClass:"el-col-auto-span"},[t("el-form-item",{attrs:{label:"Validation Mode",prop:"validationMode"}},[e.isViewMode?t("span",{domProps:{textContent:e._s(e.getValidationMode(e.assignInfo.validationMode))}}):t("el-select",{attrs:{placeholder:e.$t("common.placeholder.select"),size:"small"},model:{value:e.assignInfo.validationMode,callback:function(t){e.$set(e.assignInfo,"validationMode",t)},expression:"assignInfo.validationMode"}},e._l(e.validationModeOptions,(function(e,a){return t("el-option",{key:a,attrs:{value:e.value,label:e.label}})})),1)],1)],1),e.showRegularExpression?t("el-col",{staticClass:"el-col-auto-span"},[t("el-form-item",{attrs:{label:"Regular Expression",prop:"validationExpression",required:""}},[e.isViewMode?t("span",{domProps:{textContent:e._s(e.assignInfo.validationExpression)}}):t("el-input",{attrs:{placeholder:e.$t("common.placeholder.enter"),size:"small"},model:{value:e.assignInfo.validationExpression,callback:function(t){e.$set(e.assignInfo,"validationExpression",t)},expression:"assignInfo.validationExpression"}})],1)],1):e._e()],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{staticClass:"el-col-auto-span"},[t("el-form-item",{attrs:{label:"Allow Partial Bill Payment"}},[e.isViewMode?t("span",{domProps:{textContent:e._s("1"==e.assignInfo.allowPartialPayement?"YES":"NO")}}):t("div",[t("el-radio",{attrs:{label:1,size:"small"},model:{value:e.assignInfo.allowPartialPayement,callback:function(t){e.$set(e.assignInfo,"allowPartialPayement",t)},expression:"assignInfo.allowPartialPayement"}},[e._v("YES")]),t("el-radio",{attrs:{label:0,size:"small"},model:{value:e.assignInfo.allowPartialPayement,callback:function(t){e.$set(e.assignInfo,"allowPartialPayement",t)},expression:"assignInfo.allowPartialPayement"}},[e._v("NO")])],1)])],1)],1)],1)],1):e._e(),t("product-dialog",{attrs:{productVisible:e.addScribeProductDialogVisible,addForm:e.productPopupConf,isCheck:!0,isCheckMemory:!0,hasPagination:!1,showPageSize:!1,pageSizes:[10],childSearch:e.loadProductParam},on:{"update:productVisible":function(t){e.addScribeProductDialogVisible=t},"update:product-visible":function(t){e.addScribeProductDialogVisible=t},"submit-call-back":e.onProductChange}})],1)},P=[],T=a("0fb1"),F=a("fc5e6"),x=a("7dfc"),O=a("5a0c"),M=a.n(O);const B={COMP_DISPLAY:"dd/MM/yyyy",COMP_VALUE:"dd/MM/yyyy",DAYJS:"DD/MM/YYYY"};var _={name:"orgCreateSubsribeProduct",components:{OrgProductTable:F["a"],ProductDialog:T["a"],SimpleCollapse:p["a"]},props:{isViewMode:{type:Boolean,default:!0},assignInfo:{type:Object,default:()=>{}},identityInfo:{type:Object,default:()=>{}}},data(){return{DATE_FORMAT:B,addScribeProductDialogVisible:!1,prodLoading:!1,rules:{dateRule:[{required:!0,message:"Please enter context",trigger:"blur"}],effectiveRules:[],expiryRules:[]},productPopupConf:{title:"Add Product",label:"Product Name",idKey:"productId",columns:[{label:"Product Name",prop:"productName",align:"left"},{label:this.$t("common.label.description"),prop:"productDesc",align:"left"}],searchForm:{formData:{name:null},formConf:[{label:"Product Name",key:"name",prop:"name",comp:"el-input",bind:{clearable:!0,placeholder:this.$t("common.placeholder.enter")}}]}},validationModeOptions:[{label:"External Validation",value:"2"},{label:"Internal and External",value:"3"},{label:"Internal Validation",value:"1"},{label:"No Validation",value:"0"}]}},computed:{showRegularExpression(){return this.assignInfo.validationMode&&"0"!==this.assignInfo.validationMode&&"2"!==this.assignInfo.validationMode},subscribeProductsColumns(){const e=[{label:"Product Name",prop:"productName",align:"left",minWidth:160},{label:"Business Operations Group",prop:"productOrgRoleNames",align:"left",minWidth:160},{label:this.$t("IDC.organization.table.effectiveDate"),prop:"effectiveDate",align:"left",__slotName:"effectiveTime",width:220},{label:this.$t("IDC.organization.table.expiryDate"),prop:"expireDate",align:"left",__slotName:"expireTime",width:220},{label:this.$t("IDC.organization.chargeProfile"),prop:"chargeProfileId",align:"left",__slotName:"chargeProfile",width:220},{label:this.$t("common.label.description"),prop:"productDesc",align:"left",width:200}];return this.isViewMode||e.push({label:this.$t("common.label.operation"),align:"left",__slotName:"operation",fixed:"right",width:100}),e}},filters:{productChargeProfile:function(e={}){if(e.chargeProfiles){let t=e.chargeProfiles.filter(t=>t.chargeProfileId==e.chargeProfileId);return t.length>0?t[0].chargeProfileName:""}return""}},methods:{pickerOptionsEffectiveDate(e,t=""){return{disabledDate:a=>{let i=e,n=t;return n?a.getTime()<M()(i,B.DAYJS).valueOf()||a.getTime()>M()(n,B.DAYJS).valueOf():a.getTime()<M()(i,B.DAYJS).valueOf()}}},getValidationMode(e){switch(e){case"0":return"No Validation";case"1":return"Internal Validation";case"2":return"External Validation";case"3":return"Internal and External"}},removeSubscribeProduct(e){if(0!==e&&!e)return;const t=this.assignInfo.subscribeProducts[e];t&&(t.isNewItem?this.$modal.confirm(this.$i18n.t("common.tips.delete"),"",{confirmButtonText:this.$i18n.t("common.button.confirm"),cancelButtonText:this.$i18n.t("common.button.cancel")}).then(()=>{this.assignInfo.subscribeProducts.splice(e,1)}):this.$modal.msgWarning("not allowd remove origin product"))},onProductChange(e){e.forEach(e=>{let t=Object.assign({},e);t.isProduct=1,this.assignInfo.products.push(t)}),e.length>0&&this.$emit("refresh-accountType",{})},deletNewProductFromSelected(e){this.$confirm("Are you sure to delete it?","",{confirmButtonText:this.$t("common.button.delete"),cancelButtonText:this.$t("common.button.cancel"),closeOnClickModal:!1,type:"warning",customClass:"delete-confirm"}).then(()=>{this.assignInfo.products.splice(e,1),this.$emit("refresh-accountType",{})})},async loadProductParam(e){return new Promise(t=>{let a={page:e.pageNo||1,segmentIds:this.assignInfo.segmentIds||[],trustLevelId:this.assignInfo.trustLevelId,basicProductUniqueId:this.assignInfo.basicProductUniqueId,selectProducts:this.assignInfo.products.map(e=>e.productId),identitySubType:5002};e.searchKey&&(a.productName=e.searchKey.name),Object(d["A"])(a).then(e=>{e.header&&e.header.success&&(e.list=e.products.map(e=>(e.effectiveDateInit=e.effectiveDate,e.expireDateInit=e.expireDate,{...e})),e.page&&(e.total=e.page.totalSize)),t(e)}).catch(()=>{}).finally(()=>{})})},pickerOptionsEnd(e={}){return{disabledDate(t){return e.effectiveTime?t.getTime()>Date.now||t.getTime()<Object(x["g"])(e.effectiveTime).getTime():t.getTime()<=Date.now()}}},pickerProdTimeStart(e={}){return{disabledDate(t){return e.expiredTime?t.getTime()<Object(x["g"])(e.originalEffectiveTime).getTime()-864e5||t.getTime()>Object(x["g"])(e.originalExpiredTime).getTime()-864e5:t.getTime()<Date.now()-864e5}}},pickerProdTimeEnd(e={}){return{disabledDate(t){return e.expiredTime?t.getTime()>Object(x["g"])(e.originalExpiredTime).getTime()||(t.getTime()<Object(x["g"])(e.originalEffectiveTime).getTime()||void 0):t.getTime()<=Date.now()}}}}},A=_,E=(a("4396"),Object(C["a"])(A,S,P,!1,null,"01d592cc",null)),N=E.exports,L=function(){var e=this,t=e._self._c;return t("div",[t("div",{staticClass:"sub-block p-l-r-20 p-b-6"},[e.isViewMode?e._e():t("div",{staticClass:"tips m-b-16"},[e._v(e._s(e.$t("IDC.organization.addBankTips")))]),e.isViewMode?e._e():t("el-button",{staticClass:"m-b-16",attrs:{icon:"el-icon-plus",size:"small",type:"primary",plain:""},on:{click:function(t){e.addBankDialogVisible=!0}}},[e._v(" "+e._s(e.$t("common.button.add"))+" ")]),t("div",{staticClass:"sub-block__fields"},[t("div",{staticClass:"p-b-18"},[t("table-page",{attrs:{size:"small",isSingleCheck:!1,"has-pagination":!1,columns:e.bankAccountColumns,outSideTableData:e.assignInfo.bankAccounts},scopedSlots:e._u([{key:"operation",fn:function(a){return e.isViewMode?void 0:[t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.removeBankCount(a.data.$index)}}},[e._v(" "+e._s(e.$t("common.button.delete")))])]}}],null,!0)})],1)])],1),e.isViewMode?e._e():t("portal-dialog",{attrs:{visible:e.addBankDialogVisible,title:e.$t("IDC.organization.addBankAccount"),confirmText:e.$t("common.button.confirm"),width:"800px",height:"442px"},on:{"update:visible":function(t){e.addBankDialogVisible=t},"cancel-btn-click":e.closeDialog,"confirm-btn-click":e.addBanksubmit},scopedSlots:e._u([{key:"content",fn:function(){return[t("BankAccountDialog",{ref:"bankAccountDialog",attrs:{createBankAccountForm:e.createBankAccountForm}})]},proxy:!0}],null,!1,532356362)})],1)},$=[],j=a("8ac9"),R=a("f2e3"),V={name:"OrgBankAccount",components:{TablePage:m["a"],PortalDialog:j["a"],BankAccountDialog:R["a"]},props:{isViewMode:{type:Boolean,default:!0},assignInfo:{type:Object,default:()=>{}},identityInfo:{type:Object,default:()=>{}}},data(){return{addBankDialogVisible:!1,createBankAccountForm:{assetType:"",accountName:"",accountNo:"",bankHeadOffice:"",bankId:"",currency:"",transferMode:"",iban:"",validityPeriod:"",effectiveDate:"",expiryDate:""}}},computed:{bankAccountColumns(){const e=[{label:this.$t("IDC.bankAccount.label.bank"),prop:"bankHeadOfficeName",align:"left"},{label:this.$t("IDC.bankAccount.label.bankBranch"),prop:"bankName",align:"left"},{label:this.$t("IDC.bankAccount.label.bankAccountName"),prop:"accountName",align:"left"},{label:this.$t("IDC.bankAccount.label.bankAccountNumber"),prop:"accountNo",align:"left"},{label:this.$t("IDC.bankAccount.label.currency"),prop:"currencyName",align:"left"}];return this.isViewMode||e.push({label:this.$t("IDC.auditlog.operation"),align:"left",__slotName:"operation"}),e}},created(){},methods:{removeBankCount(e){(0===e||e)&&this.$modal.confirm(this.$i18n.t("common.tips.delete"),"",{confirmButtonText:this.$i18n.t("common.button.confirm"),cancelButtonText:this.$i18n.t("common.button.cancel")}).then(()=>{this.assignInfo.bankAccounts.splice(e,1)})},addBanksubmit(){this.$refs.bankAccountDialog.$refs.createBankAccountForm.validate(e=>{if(!e)return;const t=this.$refs.bankAccountDialog.bankHeadOfficeOptions,a=this.$refs.bankAccountDialog.bankOptions,i=this.$refs.bankAccountDialog.currencyOptions,n=this.createBankAccountForm.bankHeadOffice,o=this.createBankAccountForm.bankId,r=this.createBankAccountForm.currency,s=(t.find(e=>e.value===n)||{}).label||n,l=(a.find(e=>e.value===o)||{}).label||o,c=(i.find(e=>e.value===r)||{}).label||r,d={bankHeadOffice:n,bankId:o,currency:r,bankHeadOfficeName:s,bankName:l,currencyName:c,accountName:this.createBankAccountForm.accountName,accountNo:this.createBankAccountForm.accountNo,createOperId:"-1",identityId:this.identityInfo.parentId,assetType:this.createBankAccountForm.assetType,transferMode:this.createBankAccountForm.transferMode,iban:this.createBankAccountForm.iban,effectiveDate:this.createBankAccountForm.validityPeriod?this.createBankAccountForm.validityPeriod[0]:"",expiryDate:this.createBankAccountForm.validityPeriod?this.createBankAccountForm.validityPeriod[1]:""};this.assignInfo.bankAccounts.push(d),this.addBankDialogVisible=!1,this.$refs.bankAccountDialog.$refs.createBankAccountForm.resetFields()})},closeDialog(){this.addBankDialogVisible=!1}}},z=V,H=Object(C["a"])(z,L,$,!1,null,null,null),q=H.exports,Y=function(){var e=this,t=e._self._c;return t("div",{staticClass:"p-l-r-20 p-b-6"},[t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{prop:"chargeProfile"},scopedSlots:e._u([{key:"label",fn:function(){return[t("div",{staticClass:"ruleProfile-label"},[t("span",[e._v("Charge Profile")]),e.isViewMode?e._e():t("span",{staticClass:"label-default",on:{click:e.chargeProfileUseDefault}},[e._v("Use Default")])])]},proxy:!0}])},[e.isViewMode?t("div",[t("span",{domProps:{textContent:e._s(e.selectChargeProfileName)}})]):t("el-select",{attrs:{placeholder:"Please select",clearable:""},on:{change:e.chargeProfileChange},model:{value:e.assignInfo.selectChargeProfileId,callback:function(t){e.$set(e.assignInfo,"selectChargeProfileId",t)},expression:"assignInfo.selectChargeProfileId"}},e._l(e.assignInfo.chargeProfileList,(function(e){return t("el-option",{key:e.chargeProfileId,attrs:{label:e.chargeProfileName,value:e.chargeProfileId}})})),1)],1)],1),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{prop:"selectedRuleProfileId",required:""},scopedSlots:e._u([{key:"label",fn:function(){return[t("div",{staticClass:"ruleProfile-label"},[t("span",[e._v("Rule Profile")]),e.isViewMode?e._e():t("span",{staticClass:"label-default",on:{click:e.ruleProfileUseDefault}},[e._v("Use Default")])])]},proxy:!0}])},[e.isViewMode?t("div",[t("span",{domProps:{textContent:e._s(e.selectedRuleProfileName)}})]):t("el-select",{attrs:{placeholder:"Please select"},on:{change:e.ruleProfileChange},model:{value:e.assignInfo.selectedRuleProfileId,callback:function(t){e.$set(e.assignInfo,"selectedRuleProfileId",t)},expression:"assignInfo.selectedRuleProfileId"}},e._l(e.assignInfo.ruleProfileList,(function(e){return t("el-option",{key:e.ruleProfileId,attrs:{label:e.ruleProfileName,value:e.ruleProfileId}})})),1)],1)],1)],1)],1)},K=[];const U={CHARGE:"CHARGE_PROFILE",RULE:"RULE_PROFILE"};var W={name:"orgCreateProfile",components:{},props:{isViewMode:{type:Boolean,default:!0},assignInfo:{type:Object,default:()=>{}}},data(){return{PROFILE_FIELD:U}},computed:{selectChargeProfileName(){return this.assignInfo.chargeProfileList&&this.assignInfo.chargeProfileList.length>0?this.assignInfo.chargeProfileList.filter(e=>this.assignInfo.selectChargeProfileId==e.chargeProfileId)[0].chargeProfileName:""},selectedRuleProfileName(){return this.assignInfo.ruleProfileList&&this.assignInfo.ruleProfileList.length>0?this.assignInfo.ruleProfileList.filter(e=>this.assignInfo.selectedRuleProfileId==e.ruleProfileId)[0].ruleProfileName:""}},created(){},methods:{ruleProfileChange(e){this.assignInfo.selectedRuleProfileId=e,this.$forceUpdate()},chargeProfileChange(e){this.assignInfo.selectChargeProfileId=e,this.$forceUpdate()},chargeProfileUseDefault(){this.$emit("use-default","charge")},ruleProfileUseDefault(){this.$emit("use-default","rule")},setDefalutProfile(e){if(e)switch(e){case U.CHARGE:this.assignInfo.selectChargeProfileId=this.assignInfo.defaultRuleProfileId;break;case U.RULE:this.assignInfo.selectedRuleProfileId=this.assignInfo.defaultRuleProfileId;break}},getOptionsLabelByValue(e,t){return(e.find(e=>e.value===t)||{}).label||"-"}}},G=W,J=(a("4e5c"),Object(C["a"])(G,Y,K,!1,null,"a91f43c0",null)),Q=J.exports,Z=function(){var e=this,t=e._self._c;return t("div",{staticClass:"p-l-r-20 p-b-6"},[t("el-row",{attrs:{gutter:20}},[t("el-col",{staticClass:"el-col-auto-span"},[t("el-form-item",{ref:"subAgentExpansionModelTwo",attrs:{label:e.$t("IDC.organization.subAgentExpansionModel"),prop:"subAgentExpansionModelTwo",required:""}},[e.isViewMode?t("div",[t("span",{domProps:{textContent:e._s(e.getSubAgentModelName(e.assignInfo.subAgentExpansionModelTwo))}})]):t("el-select",{attrs:{id:"subAgentExpansionModelTwo",placeholder:e.$t("common.placeholder.select")},model:{value:e.assignInfo.subAgentExpansionModelTwo,callback:function(t){e.$set(e.assignInfo,"subAgentExpansionModelTwo",t)},expression:"assignInfo.subAgentExpansionModelTwo"}},e._l(e.subAgentExpansionModelOptions,(function(e){return t("el-option",{key:e.value,attrs:{value:e.value,label:e.label}})})),1)],1)],1)],1)],1)},X=[],ee={name:"OrgHierachy",props:{isViewMode:{type:Boolean,default:!0},parentIdentityModel:{type:String,default:""},assignInfo:{type:Object,default:()=>{}}},data(){return{subAgentExpansionModelOptions:[]}},methods:{getModelName(e){switch(e){case"0000":return"Can Make Aggregator";case"0001":return"Can Make Owned";case"0002":return"Can Make AllType";case"0003":return"NoneHierarchy";default:return}},getSubAgentModelName(e){switch(e){case"0000":return"Can Make Aggregator";case"0001":return"Can Make Owned";case"0002":return"Can Make AllType";case"0003":return"NoneHierarchy";default:return}}},watch:{"assignInfo.products":{handler(e){e=e||[];const t=e.filter(e=>"3"===e.productProperties.ORG_IDENTITY_MODEL).length,a=e.filter(e=>"1"===e.productProperties.ORG_IDENTITY_MODEL).length,i=e.filter(e=>"0"===e.productProperties.ORG_IDENTITY_MODEL).length;let n="",o=[];n=t===e.length?"0003":a>0&&i>0?"0002":a>0?"0001":"0000",this.assignInfo.identityModel=n,o="0001"===n?[{value:"0003",label:"None"},{value:"0000",label:"Aggregator"},{value:"0001",label:"Owned"},{value:"0002",label:"Owned & Aggregator"}]:[{value:"0000",label:"Aggregator"},{value:"0003",label:"None"}],this.subAgentExpansionModelOptions=o},deep:!0,immediate:!0}}},te=ee,ae=Object(C["a"])(te,Z,X,!1,null,null,null),ie=ae.exports,ne=function(){var e=this,t=e._self._c;return t("div",{staticClass:"sub-block p-l-r-20 p-b-6"},[e.isViewMode?e._e():t("div",{staticClass:"tips m-b-16"},[e._v(" Configure the account rule profile for each account of an organization. An account rule profile is a package of restrictions specified for an identity account. ")]),t("div",{staticClass:"sub-block__fields"},[t("div",{staticClass:"p-b-18"},[t("table-page",{attrs:{size:"small",isSingleCheck:!1,"has-pagination":!1,showOverflowTooltip:!1,columns:e.accountColumns,maxHeight:280,outSideTableData:e._f("accountTypeRuleProfileBeanList")(e.accountAssignInfo.accountTypeRuleProfileBeanList)},scopedSlots:e._u([{key:"ruleProfile",fn:function(a){return[e.isViewMode&&a.data.row.ruleProfileBeans.length>0?t("span",[e._v(e._s(e._f("accountRlueProfile")(a.data.row)))]):e._e(),a.data.row.ruleProfileBeans.length>0&&!e.isViewMode?t("el-select",{attrs:{placeholder:"please select",size:"small"},model:{value:a.data.row.ruleProfileId,callback:function(t){e.$set(a.data.row,"ruleProfileId",t)},expression:"scope.data.row.ruleProfileId"}},e._l(a.data.row.ruleProfileBeans,(function(e){return t("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1):e._e()]}},{key:"operation",fn:function(a){return[!e.isViewMode&&a.data.row.ruleProfileBeans.length>0?t("el-button",{attrs:{type:"text"},on:{click:function(t){return e.handleUseDefault(a.data)}}},[e._v(" "+e._s("Use Default"))]):e._e()]}}])})],1)])])},oe=[],re={name:"OrgCreateAccount",components:{TablePage:m["a"]},props:{isViewMode:{type:Boolean,default:!0},profileConfig:{type:Object,default:()=>{}}},data(){return{}},inject:["accountAssignInfo"],computed:{accountColumns(){const e=[{label:"Account Type",prop:"accountType.accountTypeName",align:"left"},{label:"Currency",prop:"currency",align:"left"},{label:"RuleProfile",prop:"name",align:"left",__slotName:"ruleProfile"}];return this.isViewMode||e.push({label:this.$t("common.label.operation"),align:"left",__slotName:"operation"}),e}},created(){},filters:{accountRlueProfile:function(e={}){return e.ruleProfileBeans?e.ruleProfileBeans.filter(t=>t.id==e.ruleProfileId)[0].name:""},accountTypeRuleProfileBeanList:function(e={}){return e.filter(e=>!1===e.accountType.limitExclude)}},methods:{handleUseDefault(e){let t=e.row;t.ruleProfileId=e.row.defaultRuleProfileId},getOptionsLabelByValue(e,t){return(e.find(e=>e.value===t)||{}).label||"-"}}},se=re,le=Object(C["a"])(se,ne,oe,!1,null,null,null),ce=le.exports,de=a("689d"),ue=a("6195"),fe=function(){var e=this,t=e._self._c;return t("div",{staticClass:"panel"},[t("el-form",{ref:"commissionForm",staticClass:"settlement-form",attrs:{"label-position":"top",model:e.profileFormTemp,rules:e.commissionRules}},[t("div",{staticClass:"content-wrapper"},[t("div",{staticClass:"sub-block"},[t("el-row",{attrs:{gutter:20}},[e.isCanMakeAggergator?t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:e.$t("IDC.revenueSettlementInfo.commissionDistributionModel"),prop:"subAgentExpansionModel"}},[e.isEditModel?t("el-select",{attrs:{placeholder:"Please select",size:"small"},model:{value:e.profileFormTemp.subAgentExpansionModel,callback:function(t){e.$set(e.profileFormTemp,"subAgentExpansionModel",t)},expression:"profileFormTemp.subAgentExpansionModel"}},e._l(e.distributionModelList,(function(a){return t("el-option",{key:a.value,attrs:{label:a.label,value:a.value},on:{change:e.distributionModelChange}})})),1):t("span",{domProps:{textContent:e._s(e.getLableToOptions(e.profileFormTemp.subAgentExpansionModel,e.distributionModelList))}})],1)],1):e._e(),t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:e.$t("IDC.revenueSettlementInfo.commissionSettlementTemplate"),prop:"subSettlementConfigTemplate"}},[e.isEditModel?t("el-select",{attrs:{placeholder:"Please select",size:"small"},on:{change:e.commissionTemplateChange},model:{value:e.profileFormTemp.subSettlementConfigTemplate,callback:function(t){e.$set(e.profileFormTemp,"subSettlementConfigTemplate",t)},expression:"profileFormTemp.subSettlementConfigTemplate"}},e._l(e.settlementTemplateList,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):t("span",{domProps:{textContent:e._s(e.getLableToOptions(e.profileFormTemp.subSettlementConfigTemplate,e.settlementTemplateList))}})],1)],1)],1)],1)])])],1)},pe=[],me=a("e036"),he=a("7c5e"),ge=a("89b2");const be={AGREEMENT:"1",CONFIG:"2"};var ye={name:"RevenueSettlementInfo",props:{dataObj:{labels:Object,default(){return{}}},profileFormTemp:{type:Object,default(){return{}}},panelActived:{type:Boolean,default:!1},isViewMode:{type:Boolean,default:!1},assignInfo:{type:Object,default:()=>{}}},data(){return{commissionRules:this.isViewMode?{}:Object(ge["b"])(this.profileFormTemp),submitLoading:!1,isEditModel:!this.isViewMode,distributionModelList:[],settlementTemplateList:[],profileTemplate:{subAgentExpansionModel:"",settlementConfigTemplate:{},subSettlementConfigTemplate:""}}},watch:{panelActived:{handler(e){e&&this.initPanel()},immediate:!0},profileTemplate:{handler(e){e&&this.$emit("update:profileFormTemp",Object(de["b"])(e))},deep:!0},isViewMode(e){this.isEditModel=!e}},computed:{isCanMakeAggergator(){const e=this.assignInfo.identityModel===he["a"].CAN_MAKE_AGGREGATOR;return e}},methods:{async initPanel(){const e=await this.getAllInitData();e&&(this.settlementCycleUnitList=e.settlementCycleUnitList&&e.settlementCycleUnitList.map(Object(de["f"])("key","value")),e.commissionCfgModelList&&e.commissionCfgModelList.forEach(e=>{this.distributionModelList.push({label:e.name,value:e.templateId})}),e.commissionCfgTemplateList&&e.commissionCfgTemplateList.forEach(e=>{e.label=e.name,e.value=e.templateId,this.settlementTemplateList.push(e)}))},async getAllInitData(){try{const e=await Object(de["e"])({profileMap:Object(de["a"])(me["d"],"revenueTemplateNameMap",{}),commissionCfgModelList:Object(de["a"])(me["b"],"commissionConfigs",{templateType:be.AGREEMENT,pageSize:null,pageNum:null}),commissionCfgTemplateList:Object(de["a"])(me["b"],"commissionConfigs",{templateType:be.CONFIG,pageSize:null,pageNum:null})});return e}catch(e){return null}},distributionModelChange(e){this.profileFormTemp.subAgentExpansionModel=e},commissionTemplateChange(e){let t=this.settlementTemplateList.find(t=>t.templateId===e);this.profileFormTemp.settlementConfigTemplate=t,this.profileFormTemp.subSettlementConfigTemplate=e},getLableToOptions(e,t){if(!e)return"-";if(!t||!t.length)return"-";if("Please Select"===e)return"-";const a=t.find(t=>t.value===e)||{};return a.label||"-"},setEditModel(e){this.isEditModel=e},resetFields(){this.$refs.revenueForm.resetFields()},validate(){return new Promise(e=>{this.$refs["commissionForm"]&&this.$refs["commissionForm"].validate(t=>e(t))})}},mounted(){}},ve=ye,Ce=(a("ac5c"),Object(C["a"])(ve,fe,pe,!1,null,"44f9582f",null)),Ie=Ce.exports,ke={name:"AssignInfo",components:{SimpleCollapse:p["a"],OrgCreateSubscribeProduct:N,OrgCreateBankAccount:q,OrgCreateProfile:Q,OrgCreateHierachy:ie,OrgCreateAccount:ce,RevenueSettlementInfo:ue["a"],commissionSettlementInfo:Ie},props:{isViewMode:{type:Boolean,default:!0},isShowModel:{type:Boolean,default:!1},type:{type:String,default:"child"},parentIdentityModel:{type:String,default:""},assignInfo:{type:Object,default:()=>{}},identityInfo:{type:Object,default:()=>{}}},data(){return{assignRules:this.isViewMode?{}:Object(u["b"])(),pageType:"create",rules:{dateRule:[{required:!0,message:"Please enter context",trigger:"blur"}],effectiveRules:[],expiryRules:[]},profileConfig:{chargeDefault:"chargeDefault",ruleDefault:"chargeDefault",chargeProfileList:[],ruleProfileList:[]}}},computed:{},created(){this.init()},methods:{useDefaulProfile(e){"charge"==e?this.assignInfo.selectChargeProfileId=this.assignInfo.defaultChargeProfileId:this.assignInfo.selectedRuleProfileId=this.assignInfo.defaultRuleProfileId},getModelName(e){switch(e){case"0000":return"Can Make Aggregator";case"0001":return"Can Make Owned";case"0002":return"Can Make AllType";case"0003":return"NoneHierarchy";default:return}},getSubAgentModelName(e){switch(e){case"0000":return"Can Make Aggregator";case"0001":return"Can Make Owned";case"0002":return"Can Make AllType";case"0003":return"NoneHierarchy";default:return}},init(){this.isViewMode||this.initProfile()},refreshAccountTypeEvn(){this.$emit("refresh-accountType",{})},async initProfile(){const e=await this.getAllEnums();if(!e)return;let t=e.chargeProfileList,a=e.ruleProfileList;if(t){t=t.map(Object(de["f"])("id","chargeProfileName"));const e=(t.find(e=>e.defaultRuleProfile)||{}).value;this.assignInfo.profileConfig.chargeDefault=e,this.assignInfo.profileConfig.chargeProfileList=t}if(a){a=a.map(Object(de["f"])("id","ruleProfileName"));const e=(a.find(e=>e.defaultRuleProfile)||{}).value;this.assignInfo.profileConfig.ruleDefault=e,this.assignInfo.profileConfig.ruleProfileList=a}},async getAllEnums(){try{const e=await this.getIndentityDicsCode(),t=(e&&e.identityType,e&&e.identitySubType,await Object(de["e"])({}));return t}catch(e){}return null},async getIndentityDicsCode(){try{const e=await Object(de["e"])({identityType:Object(de["a"])(d["r"],"dics"),identitySubType:Object(de["a"])(d["q"],"dics")}),t=e.identityType,a=e.identitySubType,i=(t.find(e=>"Organization"===e.name)||{}).code,n=(a.find(e=>"Child Organization"===e.name)||{}).code;return{identityType:i,identitySubType:n}}catch(e){return null}},validate(){return new Promise(e=>{this.$refs["assignInfo"].validate(t=>e(t))})},resetFields(){this.$refs["assignInfo"].resetFields(),this.assignInfo.bankAccount=[]}}},we=ke,De=(a("8b0f"),Object(C["a"])(we,w,D,!1,null,"653f9cd2",null)),Se=De.exports,Pe=a("d3d3"),Te={name:"CreateOrganization",components:{PortalCreateSuccess:r["a"],PortalHeader:o["a"],IdentityInfo:k,AssignInfo:Se,StepsTabs:s["a"],footerTap:Pe["a"]},data(){return{cpId:"",kycInfo:{},organizationId:"",childTitleConfig:{title:this.$t("IDC.organization.childTitle"),desc:this.$t("IDC.organization.subTips")},tabsPanel:[{name:"first",title:"Identify Info",subTitle:"Enter your Identify Info"},{name:"second",title:"Enter Details",subTitle:"Please Enter"},{name:"third",title:"Review",subTitle:"Please Review"}],identityInfo:{parentId:"",parentShortCode:"",parentOrgName:"",shortCode:"",merchName:"",productId:"",productName:"",description:"",notificationChannel:"",language:"en",email:"",phoneNumber:"",simpleKYC:[],groupKYC:[],selectedProdList:[],basicProductId:"",trustLevelName:"",orgNameRegex:"",defalutParentShortCode:""},assignInfo:{parentIdentityModel:"",identityModel:"",subAgentExpansionModel:"",aggregatorModel:"",centralOwnedModel:"",chargeProfile:"",ruleProfile:"",bankAccounts:[],subscribeProducts:[],originProduct:[],selectedProduct:[],roleNum:"",segment:"",profileConfig:{chargeDefault:"",ruleDefault:"",chargeProfileList:[],ruleProfileList:[]},profileFormTemp:{settlementConfigTemplate:{},subAgentExpansionModel:"",subSettlementConfigTemplate:""},revenueFormData:{profileName:"",profileId:"Please Select",periodicSwitch:!1,intervalValue:"",intervalTypeCode:"",startDate:"",endDate:"",manualWsSwitch:!1,autoWsSwitch:!1,settlementMinBalance:"",editableTabsValue:"",settlementProfileList:[],isShowModel:!1},showBillReferenceNumberValidation:!1,validationMode:"",allowPartialPayement:!0,validationExpression:"",notifyText:"",accountTypeRuleProfileBeanList:[]},isShowModel:!1,isShowPage:!1,submitLoading:!1,activeName:"first",createCompleted:!1,type:"child",validate:!1,detaileLoading:!1,hasDefaultParentShortCode:!1}},provide(){return{accountAssignInfo:this.assignInfo}},methods:{goViewDetail(){let e={organizationId:this.organizationId,identityId:this.organizationId,propShortCode:this.identityInfo.shortCode,cpId:this.cpId};this.$router.push({path:"detail/info",query:{data:encodeURIComponent(JSON.stringify(e))}})},continueAdd(){this.refreshCurrentPage()},resetFields(){this.$refs.identityTab.resetFields(),this.$refs.assignInfoTab.resetFields(),this.createCompleted=!1,this.activeName="first",this.cpId="",this.organizationId=""},refreshAccountTypeEvn(){this.loadQueryAccountType()},loadQueryAccountType(){if(this.assignInfo.products.length>0){let e=[];this.assignInfo.accountTypeRuleProfileBeanList=[],this.assignInfo.products.forEach(t=>{e.push(t.productId)});let t={productIds:e,trustLevelId:this.assignInfo.trustLevelId,segmentIds:this.assignInfo.segmentIds};Object(d["y"])(t).then(e=>{this.assignInfo.accountTypeRuleProfileBeanList=e.accountTypeRuleProfileBeanList})}},getCheckInputKycValue(e,t){this.submitLoading=!0,Object(d["f"])(e).then(e=>{this.submitLoading=!1,e.header&&e.header.success&&e.result&&this.getTrustLevelAndSegment(t)}).finally(()=>{this.submitLoading=!1})},getTrustLevelAndSegment(e){this.submitLoading=!0,Object(d["M"])(e).then(e=>{this.submitLoading=!0,e.header&&e.header.success&&(this.assignInfo.defaultChargeProfileId=parseInt(e.defaultChargeProfileId),this.assignInfo.defaultRuleProfileId=parseInt(e.defaultRuleProfileId),this.assignInfo.selectChargeProfileId=parseInt(e.selectChargeProfileId),this.assignInfo.selectedRuleProfileId=parseInt(e.selectedRuleProfileId),this.assignInfo.chargeProfileList=e.chargeProfileList,this.assignInfo.ruleProfileList=e.ruleProfileList,this.assignInfo.products=e.products.map(e=>(e.effectiveDateInit=e.effectiveDate,e.expireDateInit=e.expireDate,e.isProduct=0,e)),this.assignInfo.selectSegmentName=e.selectSegmentName,this.assignInfo.trustLevel=e.trustLevel,this.assignInfo.trustLevelId=e.trustLevelId,this.assignInfo.trustLevelName=e.trustLevelName,this.assignInfo.segmentIds=e.segmentIds,this.assignInfo.accountTypeRuleProfileBeanList=e.accountTypeRuleProfileBeanList.map(e=>(e.ruleProfileBeans=e.ruleProfileBeans||[],e)),this.activeName="second")}).finally(()=>{this.submitLoading=!1})},next(){if("first"===this.activeName){let e={trustLevelName:this.identityInfo.trustLevelName,identityKYCData:this.$refs.identityTab.getIdentityKYCData(),identitySubType:"5002"},t={selectBasicProductId:this.identityInfo.basicProductId,identityKYCData:this.$refs.identityTab.getIdentityKYCData(),identitySubType:"5002"};this.$refs.identityTab.validate().then(a=>{a&&this.$refs.identityTab.$refs.OrgKycInfo.validate().then(a=>{a&&this.getCheckInputKycValue(e,t)})})}else"second"===this.activeName&&0==this.assignInfo.products.filter(e=>!e.effectiveDate||!e.expireDate).length&&this.$refs.assignInfoTab.validate().then(e=>{e&&this.$refs.assignInfoTab.$refs.commissionSettlementInfo.validate().then(e=>{e&&(this.activeName="third")})})},previous(){"second"===this.activeName?this.activeName="first":this.activeName="second"},cancel(){this.$confirm("Are you sure to reset all data you have  entered/selected  in this page?","",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",closeOnClickModal:!1,type:"warning"}).then(()=>{this.$refs.identityTab.deleteIdentifier(this.identityInfo.shortCode).then(()=>{this.refreshCurrentPage()})})},removeCommas(e){if(e&&Array.isArray(e))for(let t=0;t<e.length;t++)for(const a in e[t])if(["settlementMinBalance","triggerBalance","targetBalance"].includes(a)&&"string"===typeof e[t][a]){let i=e[t][a];e[t][a]=i.replaceAll(",","")}else Array.isArray(e[t][a])&&this.removeCommas(e[t][a])},submit(){let e=null;const t=this.assignInfo.revenueFormData;t&&t.profileId&&(e=JSON.parse(JSON.stringify(t)),this.removeCommas(e.settlementProfileList));let a={parentId:this.identityInfo.parentId,parentShortCode:this.identityInfo.parentShortCode,shortCode:this.identityInfo.shortCode,merchName:this.identityInfo.merchName,notificationChannel:this.identityInfo.notificationChannel,language:this.identityInfo.language,email:this.identityInfo.email,phoneNumber:this.identityInfo.phoneNumber,identityModel:this.assignInfo.identityModel,aggregatorModel:this.assignInfo.aggregatorModel,centralOwnedModel:this.assignInfo.centralOwnedModel,bankAccounts:this.assignInfo.bankAccounts,orgRevenueProfile:e,commiDistributionModelId:this.assignInfo.profileFormTemp.subAgentExpansionModel,settlementConfigTemplate:this.assignInfo.profileFormTemp.settlementConfigTemplate,type:this.type,trustLevel:this.assignInfo.trustLevel,identityKYCData:this.$refs.identityTab.getIdentityKYCData(),accountTypeRuleProfileBeanList:this.assignInfo.accountTypeRuleProfileBeanList,productBeans:this.assignInfo.products,segmentIdList:this.assignInfo.segmentIds||[],trustLevelId:this.assignInfo.trustLevelId,notifyText:this.assignInfo.validationNotificationText,subAgentExpansionModel:this.assignInfo.subAgentExpansionModelTwo,profile:this.revenueFormData,identityRuleProfileId:this.assignInfo.selectedRuleProfileId,chargeProfileId:this.assignInfo.selectChargeProfileId,payBillCheckRule:this.assignInfo.showBillReferenceNumberValidation?{validationMode:this.assignInfo.validationMode,validationExpression:this.assignInfo.validationExpression,allowPartialPayement:this.assignInfo.allowPartialPayement?"0":"1",notifyText:this.assignInfo.notifyText}:null};this.assignInfo.showBillReferenceNumberValidation&&(a.payBillCheckRule={validationMode:this.assignInfo.validationMode,validationExpression:this.assignInfo.validationExpression,allowPartialPayement:this.assignInfo.allowPartialPayement,notifyText:this.assignInfo.notifyText}),this.submitLoading=!0,Object(d["b"])(a).then(e=>{this.submitLoading=!1,e.header&&e.header.success&&(this.createCompleted=!0,this.organizationId=e.identityId,this.cpId=e.cpId)}).finally(()=>{this.submitLoading=!1})},getOrgNameRegex(){this.detaileLoading=!0,Object(d["H"])({identitySubType:"5002"}).then(e=>{e.header&&e.header.success&&(this.identityInfo.orgNameRegex=e.orgNameRegex)}).finally(()=>{this.identityInfo.orgNameRegex||(this.identityInfo.orgNameRegex="^([0-9A-Za-z\\_\\^\\|\\/ ]{2,128})$"),this.detaileLoading=!1})}},computed:{styles(){return{height:parseInt(document.documentElement.clientHeight/2)+"px"}}},watch:{"identityInfo.selectedProdList":{handler(e){this.assignInfo.showBillReferenceNumberValidation=e.some(e=>{if(e.productProperties)return void 0!=e.productProperties.BILL_REF_NUM_RULE})},deep:!0}},created(){if(this.getOrgNameRegex(),this.$route.query){const{query:{parentShortCode:e,parentIdentityId:t}}=this.$route;e&&(this.hasDefaultParentShortCode=!0,this.identityInfo.defalutParentShortCode=e,this.identityInfo.parentShortCode=e,this.identityInfo.parentIdentityId=t)}},mounted(){window.v=this}},Fe=Te,xe=(a("4824"),a("786e"),Object(C["a"])(Fe,i,n,!1,null,"ccf820a8",null));t["default"]=xe.exports},f33d:function(e,t,a){"use strict";a.d(t,"i",(function(){return n})),a.d(t,"c",(function(){return o})),a.d(t,"h",(function(){return r})),a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return l})),a.d(t,"f",(function(){return c})),a.d(t,"g",(function(){return d})),a.d(t,"e",(function(){return u})),a.d(t,"d",(function(){return f})),a.d(t,"j",(function(){return p}));var i=a("0bbd");function n(e){return Object(i["a"])({url:"/fintech/v1/dict/query",method:"post",data:e})}function o(e){return Object(i["a"])({url:"/fintech/v1/bank/getBank",method:"post",data:e})}function r(e){return Object(i["a"])({url:"/fintech/v1/bank/queryBankList",method:"post",data:e})}function s(e){return Object(i["a"])({url:"/fintech/v1/organization/bankAccount/create",method:"post",data:e})}function l(e){return Object(i["a"])({url:"/fintech/v1/organization/bankAccount/delete",method:"post",data:e})}function c(e){return Object(i["a"])({url:"/fintech/v1/bankAccount/get",method:"post",data:e})}function d(e){return Object(i["a"])({url:"/fintech/v1/bankAccount/query",method:"post",data:e})}function u(e){return Object(i["a"])({url:"/fintech/v1/bankAccount/getTransferMode",method:"get",data:e})}function f(e){return Object(i["a"])({url:"/fintech/v1/bank/queryBankInfo",method:"post",data:e})}function p(e){return Object(i["a"])({url:"/fintech/v1/bankAccount/setIdentityBankAccount",method:"post",data:e})}},f71d:function(e,t,a){},fa55:function(e,t,a){"use strict";a("1c9c")},fc5e6:function(e,t,a){"use strict";var i=function(){var e=this,t=e._self._c;return t("el-table",e._b({key:e.tableKey,ref:"tableRef",staticClass:"orgTable",attrs:{"empty-text":"No records found.","header-cell-style":e.headerStyle,data:e.outSideTableData,size:e.size,border:e.border,"row-key":e.idKey,"max-height":e.maxHeight}},"el-table",e.$attrs,!1),[e._l(e.columns,(function(a,i){return[t("el-table-column",e._b({key:i,attrs:{sortable:e.sortFun(a),width:a.width||"",formatter:a.formatter||e.formatterHandle},scopedSlots:e._u([a.__slotName?{key:"default",fn:function(t){return[e._t(a.__slotName,null,{data:t})]}}:null],null,!0)},"el-table-column",a,!1))]}))],2)},n=[],o={name:"org-product-table",props:{columns:{type:Array,default:()=>[]},size:{type:String,default:"medium"},idKey:{type:String,default:"id"},sortArr:{type:Array,default:()=>[]},pageParam:{type:Object,default:()=>({pageOffset:"pageNo",pageSize:"pageSize"})},hasPagination:{type:Boolean,default:!0},pagination:{type:Object,default:()=>({total:0,pageIndex:1})},pageSizes:{type:Array,default(){return[10,20,50,100]}},outSideTableData:{type:Array,default:()=>[]},border:{type:Boolean,default:!0},initChecks:{type:Array,default:()=>[]},maxHeight:{type:[Number,String]}},data(){return{tableKey:(new Date).getTime(),headerStyle:{"background-color":""+this.GlobalStyleVariables.fillLightColor,"font-size":"14px","font-family":"HuaweiSans-Medium","font-weight":500,color:""+this.GlobalStyleVariables.textEmphasisColor}}},methods:{sortFun(e){const t=this.sortArr&&this.sortArr.indexOf(e.prop)>-1;return!!t&&(!!e["sort-method"]||"custom")},formatterHandle(e,t){const a=t.property;let i=e,n="",o=a&&a.split(".");return o.forEach(e=>{"object"===typeof i[e]?i=i[e]:n=i[e]}),""!==n&&null!==n&&void 0!==n?n:"-"}}},r=o,s=a("2877"),l=Object(s["a"])(r,i,n,!1,null,null,null);t["a"]=l.exports}}]);
//# sourceMappingURL=chunk-50856f1c.js.map