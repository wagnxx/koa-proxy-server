{"version":3,"sources":["webpack:///./src/components/kyc-common/array-kyc-group.vue?9340","webpack:///./src/components/kyc-common/kyc-field-item.vue?aea0","webpack:///./src/components/kyc-common/kyc-form/index.vue","webpack:///./src/components/kyc-common/kyc-group-item.vue","webpack:///./src/components/kyc-common/kyc-group-label.vue","webpack:///src/components/kyc-common/kyc-group-label.vue","webpack:///./src/components/kyc-common/kyc-group-label.vue?4e53","webpack:///./src/components/kyc-common/kyc-group-label.vue?d4ef","webpack:///./src/components/kyc-common/simple-kyc-group.vue","webpack:///./src/components/kyc-common/kyc-field-item.vue","webpack:///./src/components/kyc-common/kyc-special-field/region.vue","webpack:///src/components/kyc-common/kyc-special-field/region.vue","webpack:///./src/components/kyc-common/kyc-special-field/region.vue?e8c6","webpack:///./src/components/kyc-common/kyc-special-field/region.vue?5449","webpack:///./src/components/kyc-common/kyc-special-field/preferred-nc-lang.vue","webpack:///src/components/kyc-common/kyc-special-field/preferred-nc-lang.vue","webpack:///./src/components/kyc-common/kyc-special-field/preferred-nc-lang.vue?c995","webpack:///./src/components/kyc-common/kyc-special-field/preferred-nc-lang.vue?aeb1","webpack:///./src/components/kyc-common/validator.js","webpack:///src/components/kyc-common/kyc-field-item.vue","webpack:///./src/components/kyc-common/kyc-field-item.vue?348a","webpack:///./src/components/kyc-common/kyc-field-item.vue?354b","webpack:///src/components/kyc-common/simple-kyc-group.vue","webpack:///./src/components/kyc-common/simple-kyc-group.vue?fa72","webpack:///./src/components/kyc-common/simple-kyc-group.vue?e2ca","webpack:///./src/components/kyc-common/array-kyc-group.vue","webpack:///src/components/kyc-common/array-kyc-group.vue","webpack:///./src/components/kyc-common/array-kyc-group.vue?4a94","webpack:///./src/components/kyc-common/array-kyc-group.vue?398b","webpack:///src/components/kyc-common/kyc-group-item.vue","webpack:///./src/components/kyc-common/kyc-group-item.vue?60f4","webpack:///./src/components/kyc-common/kyc-group-item.vue?3592","webpack:///src/components/kyc-common/kyc-form/index.vue","webpack:///./src/components/kyc-common/kyc-form/index.vue?f874","webpack:///./src/components/kyc-common/kyc-form/index.vue?be15","webpack:///./src/components/kyc-common/array-kyc-group.vue?311f","webpack:///./src/components/kyc-common/kyc-form/index.vue?4c92","webpack:///./src/components/kyc-common/kyc-special-field/preferred-nc-lang.vue?4c47","webpack:///./src/components/kyc-common/kyc-group-item.vue?8026","webpack:///./src/components/kyc-common/array-kyc-group.vue?53a4","webpack:///./src/components/kyc-common/simple-kyc-group.vue?e5c3","webpack:///./src/components/kyc-common/kyc-special-field/region.vue?a3e4"],"names":["module","exports","render","_vm","this","_c","_self","directives","name","rawName","value","initLoading","expression","staticClass","isEditMode","editing","showEditButton","attrs","editClickLoading","on","handleEditButtonClick","_v","_e","ableEditTrustLevel","isEditingMode","key","ref","trustLevelFormData","TRUST_LEVEL_FORM_RULES","handleTrustLevelSelectChange","model","trustLevel","callback","$$v","$set","_l","trustLevelList","item","trustLevelId","trustLevelName","formData","handleValidate","kycGroupList","kycGroupItem","groupId","remarkFormData","REMARK_FORM_RULES","remark","handleEditResetClick","submitBtnLoading","handleEditSubmitClick","staticRenderFns","realDisplayName","isMultiKYCGroupType","_s","label","props","type","default","component","kycFields","kycField","_b","fieldId","colSpan","isSpecialSimpleField","groupEditDisabled","handleSpecialSimpleFieldChange","class","isMultiGroupField","propPath","getValidateRules","REGION_FIELD_ID","isViewMode","NC_LANG_FIELD_ID","view_span","high_light","isWorkflowDiff","delete_remark","isWorkflowDelete","viewModeFieldValue","fieldType","KYC_DISPLAYTYPE_MAP","INPUT","configDisabled","multiFieldDisabled","handleInputBlur","fieldValue","SELECT","hasBankAccountDisabled","handSelectChange","options","option","DATE","pickerOptions","handleDatePickerChange","TIME","RADIO","CHECKBOX","PICTURE","regionCode2FullNameMap","handleRegionClear","handleRegionFocus","slot","validRegionCode2FullNameMap","dialogVisible","$event","handleDialogOpened","handleDialogCancel","handleDialogConfirm","scopedSlots","_u","fn","searchText","treeData","checkedKeys","defaultProps","filterNode","handleTreeNodeCheck","proxy","components","PortalDialog","inject","data","children","computed","watch","created","methods","getRegionData","header","regionInfoTreeDatas","sortRegionTreeNode","languageMap","handleChange","langOptions","languageCode","languageName","getLanguageList","list","prev","selectRequiredValidateObj","inputRequiredValidateObj","fieldInputRequired","required","message","trigger","fieldCheckRequired","fieldSelectRequired","generateExtValidateRule","kycRuleExt","currFiledId","validationDisplayName","algorithm","promptInfo","beginValue","endValue","validator","rule","selectDate","moment","unix","ALGORITHM_TYPE_MAP","DAY","ANNIVERSARY","BIRTHDAY","varifyData","MONTH","YEAR","FIXED_DATE","unit","rangeRight","rangeLeft","subtract","parseInt","handleSelectOptions","handleViewModeFieldValue","mode","dataDictItemsMap","ret","originFormat","RegionField","PreferredNcLangField","colIndex","specialSimpleField","kycRuleExtList","currFieldExtRule","fieldFormItem","allBasicProductMandatory","isBasicProductMandatory","allTrustLevelMandatory","isTrustLevelMandatory","isSensitive","sameAsMask","isBirthDate","isEffectiveDate","isExpiryDate","disabledDate","isFirstColumn","isMultiGroupFirstColumn","getRequiredValidateRule","mandatory","simpleRelevancyMandatory","multiRelevancyMandatory","compositeMandatory","getRegexpValidateRule","pattern","getExtValidateRule","initOptions","clearValidate","resetField","KycFieldItem","groupEnable","isAdaptiveLayout","isContactDetailsGroup","xs","sm","md","lg","xl","span","handleContactDetailsGroup","smsField","emailField","displayAddDeleteBtn","addRow","addButtonText","fieldValues","colField","needRequired","scope","row","multiFieldVerifyErrorMessage","isMultiFieldVerifyError","getFieldPropPath","refInFor","getFieldItem","handleFirstColumnValid","handleFirstColumnInvalid","$index","deleteRow","undefined","isIDDetailsGroup","isCertificateDetailsGroup","validFieldValuesLength","getIsBasicProductMandatory","fieldData","hasEmptyRow","result","validateRowsMandatory","mandatoryIndexList","mandatoryPropPathList","map","filter","reselve","confirmButtonText","cancelButtonText","closeOnClickModal","then","catch","field","handleMultiGroupSpecialRelevancy","handleIDDetailKYCGroup","handleCertificateDetailsKYCGroup","inputFields","inputFieldColumns","KycGroupLabel","SimpleKycGroup","ArrayKycGroup","KycGroupItem","kycInfo","identityType","identityId","identityClassify","reviewKycData","adaptiveLayout","basicProductId","incomingData","roleIds","isSelfOrgOper","isDataEcho","provide","kycForm","identityKYCDetail","identityKYCEditInfo","multiRecordIdMap","basicProductMandatory","trustLevelMandatory","workflowEditLoading","groups","groupDisableIdList","isCreateMode","isDetailMode","isReviewMode","isWorkflowDiffMode","isCreateOrEditMode","isEditOrDetailMode","isEditReviewMode","needKYCDataEcho","getIdentityKYCConfigApi","getIdentityKYCDetailApi","getIdentityKYCEditApi","changeBasicProduct","checkTrustLevelChangeFuc","detailParams","customerId","identitySubType","updateKYCAPI","handler","deep","setTimeout","getKYCConfig","params","identityKYCDataBean","getKYCDetail","getKYCEditInfo","changeTrustLevelList","selectTrustLevelId","finally","getBasicProductMandatory","mandatoryKycFieldIds","mandatoryKycFieldList","getKYCRequestParams","validate","validateField","resetFields","personalSettings","validateForm","Promise","showCancelButton","change","canDowngrading","checkTrustLevelChange","identityKYCData","updateIdentityKYC","reason"],"mappings":"qGACAA,EAAOC,QAAU,CAAC,gBAAkB,UAAU,aAAe,UAAU,UAAY,UAAU,kBAAoB,UAAU,eAAiB,UAAU,gBAAkB,UAAU,iBAAmB,UAAU,cAAgB,UAAU,gBAAkB,UAAU,kBAAoB,UAAU,gBAAkB,OAAO,iBAAmB,UAAU,mBAAqB,UAAU,mBAAqB,UAAU,6BAA+B,UAAU,kBAAoB,UAAU,WAAa,UAAU,aAAe,UAAU,4BAA8B,UAAU,2BAA6B,UAAU,6BAA+B,UAAU,sCAAwC,UAAU,6BAA+B,UAAU,0BAA4B,UAAU,cAAgB,UAAU,eAAiB,UAAU,eAAiB,UAAU,iBAAmB,Y,kCCD12B,W,+JCAA,IAAIC,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACE,WAAW,CAAC,CAACC,KAAK,UAAUC,QAAQ,YAAYC,MAAOP,EAAIQ,YAAaC,WAAW,gBAAgBC,YAAY,mBAAmB,CAAEV,EAAIW,aAAeX,EAAIY,SAAWZ,EAAIa,eAAgBX,EAAG,YAAY,CAACQ,YAAY,sCAAsCI,MAAM,CAAC,KAAO,QAAQ,QAAUd,EAAIe,iBAAiB,KAAO,gBAAgBC,GAAG,CAAC,MAAQhB,EAAIiB,wBAAwB,CAACjB,EAAIkB,GAAG,UAAUlB,EAAImB,KAAMnB,EAAIoB,oBAAsBpB,EAAIqB,cAAe,CAACnB,EAAG,UAAU,CAACoB,IAAI,sBAAsBC,IAAI,sBAAsBb,YAAY,mBAAmBI,MAAM,CAAC,KAAO,QAAQ,iBAAiB,MAAM,MAAQd,EAAIwB,mBAAmB,MAAQxB,EAAIyB,yBAAyB,CAACvB,EAAG,SAAS,CAACY,MAAM,CAAC,OAAS,KAAK,CAACZ,EAAG,SAAS,CAACY,MAAM,CAAC,KAAO,IAAI,CAACZ,EAAG,eAAe,CAACY,MAAM,CAAC,MAAQ,cAAc,KAAO,eAAe,CAACZ,EAAG,YAAY,CAACc,GAAG,CAAC,OAAShB,EAAI0B,8BAA8BC,MAAM,CAACpB,MAAOP,EAAIwB,mBAAmBI,WAAYC,SAAS,SAAUC,GAAM9B,EAAI+B,KAAK/B,EAAIwB,mBAAoB,aAAcM,IAAMrB,WAAW,kCAAkCT,EAAIgC,GAAIhC,EAAIiC,gBAAgB,SAASC,GAAM,OAAOhC,EAAG,YAAY,CAACoB,IAAIY,EAAKC,aAAarB,MAAM,CAAC,MAAQoB,EAAKE,eAAe,MAAQF,EAAKC,mBAAkB,IAAI,IAAI,IAAI,IAAI,GAAGjC,EAAG,aAAa,CAACQ,YAAY,mCAAmCV,EAAImB,KAAKjB,EAAG,UAAU,CAACoB,IAAI,eAAeC,IAAI,eAAeT,MAAM,CAAC,KAAO,QAAQ,iBAAiB,MAAM,MAAQd,EAAIqC,SAAS,2BAA0B,GAAOrB,GAAG,CAAC,SAAWhB,EAAIsC,iBAAiBtC,EAAIgC,GAAIhC,EAAIuC,cAAc,SAASC,GAAc,OAAOtC,EAAG,iBAAiB,CAACoB,IAAIkB,EAAaC,QAAQ3B,MAAM,CAAC,KAAO0B,QAAkB,GAAIxC,EAAIqB,cAAe,CAACnB,EAAG,UAAU,CAACoB,IAAI,aAAaC,IAAI,aAAab,YAAY,cAAcI,MAAM,CAAC,KAAO,QAAQ,iBAAiB,MAAM,MAAQd,EAAI0C,eAAe,MAAQ1C,EAAI2C,oBAAoB,CAACzC,EAAG,eAAe,CAACY,MAAM,CAAC,MAAQ,SAAS,KAAO,WAAW,CAACZ,EAAG,WAAW,CAACY,MAAM,CAAC,KAAO,WAAW,YAAc,eAAe,KAAO,GAAGa,MAAM,CAACpB,MAAOP,EAAI0C,eAAeE,OAAQf,SAAS,SAAUC,GAAM9B,EAAI+B,KAAK/B,EAAI0C,eAAgB,SAAUZ,IAAMrB,WAAW,4BAA4B,IAAI,GAAGP,EAAG,MAAM,CAACQ,YAAY,oBAAoB,CAACR,EAAG,YAAY,CAACY,MAAM,CAAC,KAAO,SAASE,GAAG,CAAC,MAAQhB,EAAI6C,uBAAuB,CAAC7C,EAAIkB,GAAG,YAAYhB,EAAG,YAAY,CAACY,MAAM,CAAC,KAAO,UAAU,KAAO,QAAQ,QAAUd,EAAI8C,kBAAkB9B,GAAG,CAAC,MAAQhB,EAAI+C,wBAAwB,CAAC/C,EAAIkB,GAAG,aAAa,IAAIlB,EAAImB,MAAM,IAEt6E6B,EAAkB,GCFlBjD,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACQ,YAAY,mBAAmB,CAACR,EAAG,kBAAkB,CAACY,MAAM,CAAC,MAAQd,EAAIkC,KAAKe,mBAAoBjD,EAAIkD,oBAAoBlD,EAAIkC,KAAKO,SAAUvC,EAAG,kBAAkB,CAACY,MAAM,CAAC,KAAOd,EAAIkC,QAAQhC,EAAG,mBAAmB,CAACY,MAAM,CAAC,KAAOd,EAAIkC,SAAS,IAExTc,EAAkB,GCFlBjD,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,OAAO,CAACQ,YAAY,iBAAiB,CAACV,EAAIkB,GAAGlB,EAAImD,GAAGnD,EAAIoD,WAE1HJ,EAAkB,GCEP,GACf3C,qBACAgD,OACAD,OACAE,YACAC,cCTwW,I,YCOpWC,EAAY,eACd,EACA,EACA,GACA,EACA,KACA,KACA,MAIa,EAAAA,E,QClBXzD,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,SAAS,CAACQ,YAAY,aAAaI,MAAM,CAAC,OAAS,KAAK,CAACd,EAAIgC,GAAIhC,EAAIkC,KAAKuB,WAAW,SAASC,GAAU,OAAOxD,EAAG,SAASF,EAAI2D,GAAG,CAACrC,IAAIoC,EAASE,SAAS,SAAS5D,EAAI6D,SAAQ,GAAO,CAAC3D,EAAG,iBAAiB,CAACY,MAAM,CAAC,KAAO4C,EAAS,mBAAqB1D,EAAI8D,qBAAqB,kBAAoB9D,EAAI+D,kBAAkB,QAAU/D,EAAIyC,SAASzB,GAAG,CAAC,8BAA8BhB,EAAIgE,mCAAmC,MAAK9D,EAAG,aAAa,CAACQ,YAAY,8BAA8B,IAE5hBsC,EAAkB,GCFlBjD,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAAC+D,MAAM,CAC/E,oBAAoB,EACpB,cAAejE,EAAIkE,oBAClB,CAAChE,EAAG,eAAe,CAACqB,IAAI,gBAAgBT,MAAM,CAAC,MAAQd,EAAIkE,kBAAoB,GAAKlE,EAAIkC,KAAKe,gBAAgB,KAAOjD,EAAIkC,KAAKiC,SAAS,MAAQnE,EAAIoE,mBAAmB,CAAEpE,EAAIkC,KAAK0B,UAAY5D,EAAIqE,gBAAiB,CAACnE,EAAG,eAAe,CAACY,MAAM,CAAC,KAAOd,EAAIkC,KAAK,WAAalC,EAAIsE,eAAgBtE,EAAIkC,KAAK0B,UAAY5D,EAAIuE,iBAAkB,CAACrE,EAAG,0BAA0B,CAACY,MAAM,CAAC,KAAOd,EAAIkC,KAAK,WAAalC,EAAIsE,eAAgBtE,EAAIsE,YAActE,EAAI+D,kBAAmB,CAAC7D,EAAG,OAAO,CAAC+D,MAAM,CAAEO,WAAW,EAAMC,WAAYzE,EAAI0E,eAAgBC,cAAe3E,EAAI4E,mBAAoB,CAAC5E,EAAIkB,GAAGlB,EAAImD,GAAGnD,EAAI6E,wBAAyB7E,EAAIkC,KAAK4C,WAAa9E,EAAI+E,oBAAoBC,MAAO,CAAC9E,EAAG,WAAW,CAACY,MAAM,CAAC,UAAY,GAAG,SAAWd,EAAIiF,gBAAkBjF,EAAIkF,oBAAoBlE,GAAG,CAAC,KAAOhB,EAAImF,iBAAiBxD,MAAM,CAACpB,MAAOP,EAAIkC,KAAKkD,WAAYvD,SAAS,SAAUC,GAAM9B,EAAI+B,KAAK/B,EAAIkC,KAAM,aAAcJ,IAAMrB,WAAW,sBAAuBT,EAAIkC,KAAK4C,WAAa9E,EAAI+E,oBAAoBM,OAAQ,CAACnF,EAAG,YAAY,CAACY,MAAM,CAAC,SAAWd,EAAIiF,gBAAkBjF,EAAIsF,wBAA0BtF,EAAIkF,mBAAmB,UAAY,GAAG,YAAc,iBAAiBlE,GAAG,CAAC,OAAShB,EAAIuF,kBAAkB5D,MAAM,CAACpB,MAAOP,EAAIkC,KAAKkD,WAAYvD,SAAS,SAAUC,GAAM9B,EAAI+B,KAAK/B,EAAIkC,KAAM,aAAcJ,IAAMrB,WAAW,oBAAoBT,EAAIgC,GAAIhC,EAAIkC,KAAKsD,SAAS,SAASC,GAAQ,OAAOvF,EAAG,YAAY,CAACoB,IAAImE,EAAOlF,MAAMO,MAAM,CAAC,MAAQ2E,EAAOrC,MAAM,MAAQqC,EAAOlF,YAAW,IAAKP,EAAIkC,KAAK4C,WAAa9E,EAAI+E,oBAAoBW,KAAM,CAACxF,EAAG,iBAAiB,CAACY,MAAM,CAAC,KAAO,OAAO,OAAS,aAAa,eAAe,WAAW,UAAY,GAAG,iBAAiBd,EAAI2F,cAAc,SAAW3F,EAAIiF,gBAAkBjF,EAAIkF,mBAAmB,UAAW,GAAOlE,GAAG,CAAC,OAAShB,EAAI4F,wBAAwBjE,MAAM,CAACpB,MAAOP,EAAIkC,KAAKkD,WAAYvD,SAAS,SAAUC,GAAM9B,EAAI+B,KAAK/B,EAAIkC,KAAM,aAAcJ,IAAMrB,WAAW,sBAAuBT,EAAIkC,KAAK4C,WAAa9E,EAAI+E,oBAAoBc,KAAM,CAAC3F,EAAG,iBAAiB,CAACY,MAAM,CAAC,KAAO,WAAW,OAAS,sBAAsB,eAAe,iBAAiB,UAAY,GAAG,iBAAiBd,EAAI2F,cAAc,SAAW3F,EAAIiF,gBAAkBjF,EAAIkF,mBAAmB,UAAW,GAAOlE,GAAG,CAAC,OAAShB,EAAI4F,wBAAwBjE,MAAM,CAACpB,MAAOP,EAAIkC,KAAKkD,WAAYvD,SAAS,SAAUC,GAAM9B,EAAI+B,KAAK/B,EAAIkC,KAAM,aAAcJ,IAAMrB,WAAW,sBAAuBT,EAAIkC,KAAK4C,WAAa9E,EAAI+E,oBAAoBe,MAAO,CAAC5F,EAAG,iBAAiB,CAACY,MAAM,CAAC,SAAWd,EAAIiF,gBAAkBjF,EAAIkF,oBAAoBvD,MAAM,CAACpB,MAAOP,EAAIkC,KAAKkD,WAAYvD,SAAS,SAAUC,GAAM9B,EAAI+B,KAAK/B,EAAIkC,KAAM,aAAcJ,IAAMrB,WAAW,oBAAoBT,EAAIgC,GAAIhC,EAAIkC,KAAKsD,SAAS,SAASC,GAAQ,OAAOvF,EAAG,WAAW,CAACoB,IAAImE,EAAOlF,MAAMO,MAAM,CAAC,MAAQ2E,EAAOlF,QAAQ,CAACP,EAAIkB,GAAG,IAAIlB,EAAImD,GAAGsC,EAAOrC,OAAO,UAAS,IAAKpD,EAAIkC,KAAK4C,WAAa9E,EAAI+E,oBAAoBgB,SAAU,CAAC7F,EAAG,oBAAoB,CAACY,MAAM,CAAC,SAAWd,EAAIiF,gBAAkBjF,EAAIkF,oBAAoBvD,MAAM,CAACpB,MAAOP,EAAIkC,KAAKkD,WAAYvD,SAAS,SAAUC,GAAM9B,EAAI+B,KAAK/B,EAAIkC,KAAM,aAAcJ,IAAMrB,WAAW,oBAAoBT,EAAIgC,GAAIhC,EAAIkC,KAAKsD,SAAS,SAASC,GAAQ,OAAOvF,EAAG,cAAc,CAACoB,IAAImE,EAAOlF,MAAMO,MAAM,CAAC,MAAQ2E,EAAOlF,QAAQ,CAACP,EAAIkB,GAAG,IAAIlB,EAAImD,GAAGsC,EAAOrC,OAAO,UAAS,IAAKpD,EAAIkC,KAAK4C,WAAa9E,EAAI+E,oBAAoBiB,QAAS,CAAC9F,EAAG,WAAW,CAACY,MAAM,CAAC,SAAW,IAAIa,MAAM,CAACpB,MAAOP,EAAIkC,KAAKkD,WAAYvD,SAAS,SAAUC,GAAM9B,EAAI+B,KAAK/B,EAAIkC,KAAM,aAAcJ,IAAMrB,WAAW,sBAAsBT,EAAImB,MAAM,IAAI,IAEp3G6B,EAAkB,GCLlBjD,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACQ,YAAY,0BAA0B,CAAEV,EAAIsE,WAAYpE,EAAG,OAAO,CAAC+D,MAAM,CAAEQ,WAAYzE,EAAI0E,eAAgBC,cAAe3E,EAAI4E,mBAAoB,CAAC5E,EAAIkB,GAAGlB,EAAImD,GAAGnD,EAAIiG,uBAAuBjG,EAAIkC,KAAKkD,aAAepF,EAAIkC,KAAKkD,YAAc,QAAQlF,EAAG,YAAY,CAACY,MAAM,CAAC,UAAY,GAAG,YAAc,gBAAgB,yBAAwB,GAAOE,GAAG,CAAC,MAAQhB,EAAIkG,kBAAkB,MAAQlG,EAAImG,mBAAmBxE,MAAM,CAACpB,MAAOP,EAAIkC,KAAKkD,WAAYvD,SAAS,SAAUC,GAAM9B,EAAI+B,KAAK/B,EAAIkC,KAAM,aAAcJ,IAAMrB,WAAW,oBAAoB,CAACP,EAAG,WAAW,CAACkG,KAAK,UAAU,CAAClG,EAAG,IAAI,CAACQ,YAAY,0DAA2DV,EAAIqG,4BAA6BrG,EAAIgC,GAAIhC,EAAIiG,wBAAwB,SAAS1F,EAAMe,GAAK,OAAOpB,EAAG,YAAY,CAACoB,IAAIA,EAAIR,MAAM,CAAC,MAAQP,EAAM,MAAQe,QAAStB,EAAImB,MAAM,GAAGjB,EAAG,gBAAgB,CAACY,MAAM,CAAC,QAAUd,EAAIsG,cAAc,MAAQ,gBAAgB,MAAQ,QAAQ,IAAM,OAAO,iBAAiB,GAAG,mBAAmB,IAAItF,GAAG,CAAC,iBAAiB,SAASuF,GAAQvG,EAAIsG,cAAcC,GAAQ,OAASvG,EAAIwG,mBAAmB,mBAAmBxG,EAAIyG,mBAAmB,oBAAoBzG,EAAI0G,qBAAqBC,YAAY3G,EAAI4G,GAAG,CAAC,CAACtF,IAAI,UAAUuF,GAAG,WAAW,MAAO,CAAC3G,EAAG,MAAM,CAACQ,YAAY,yBAAyB,CAACR,EAAG,WAAW,CAACY,MAAM,CAAC,UAAY,GAAG,KAAO,QAAQ,cAAc,kBAAkBa,MAAM,CAACpB,MAAOP,EAAI8G,WAAYjF,SAAS,SAAUC,GAAM9B,EAAI8G,WAAWhF,GAAKrB,WAAW,gBAAgBP,EAAG,UAAU,CAACqB,IAAI,aAAaT,MAAM,CAAC,KAAOd,EAAI+G,SAAS,oBAAoB,GAAG,gBAAgB,GAAG,WAAW,aAAa,iBAAiB,GAAG,UAAY,GAAG,uBAAuB/G,EAAIgH,YAAY,wBAAwBhH,EAAIgH,YAAY,OAAS,GAAG,MAAQhH,EAAIiH,aAAa,qBAAqBjH,EAAIkH,YAAYlG,GAAG,CAAC,MAAQhB,EAAImH,wBAAwB,KAAKC,OAAM,QAAW,IAEn2DpE,EAAkB,G,oCC2DP,GACf3C,mBACAgH,YAAAC,qBACAjE,OACAnB,MACAoB,YACAC,gBAEAe,oBAEAiD,mBACAC,OACA,OACAlB,iBACAQ,cAEAE,eACAC,cACAQ,+BACArE,oBAEA2D,YACAd,4BAGAyB,UACArB,8BACA,wDAGA3B,iBACA,kCAGAE,mBACA,mCAGA+C,OACAb,cACA,iCAEAR,iBACA,GAEA,+DAIAsB,UACA,qBACA,uBACA,0CAGAC,SACA3B,oBACA,oBACA,uBACA,0CAGAC,oBACA,uBAEAK,qBACA,gEAEAC,qBACA,uBAEAC,sBACA,yCACA,uBAGAQ,gBACA,eACA,sBACA,2CACA,yBAGAC,yBACA,kBAAAH,GAAA,EACA,iCACA,4DAEA,mBAEA,wDAEAc,gBACAA,0BACA,aACAC,EACAC,gDACA,EACA,eAEAC,kBAEA,8CACA,sBCpK8W,ICQ1W,G,UAAY,eACd,EACA,EACA,GACA,EACA,KACA,WACA,OAIa,I,QCnBXlI,EAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACQ,YAAY,eAAe,CAAEV,EAAIsE,WAAYpE,EAAG,OAAO,CAAC+D,MAAM,CAAEQ,WAAYzE,EAAI0E,eAAgBC,cAAe3E,EAAI4E,mBAAoB,CAAC5E,EAAIkB,GAAGlB,EAAImD,GAAGnD,EAAIkI,YAAYlI,EAAIkC,KAAKkD,aAAe,QAAQlF,EAAG,YAAY,CAACY,MAAM,CAAC,UAAY,GAAG,YAAc,iBAAiBE,GAAG,CAAC,OAAShB,EAAImI,cAAcxG,MAAM,CAACpB,MAAOP,EAAIkC,KAAKkD,WAAYvD,SAAS,SAAUC,GAAM9B,EAAI+B,KAAK/B,EAAIkC,KAAM,aAAcJ,IAAMrB,WAAW,oBAAoBT,EAAIgC,GAAIhC,EAAIoI,aAAa,SAASlG,GAAM,OAAOhC,EAAG,YAAY,CAACoB,IAAIY,EAAKmG,aAAavH,MAAM,CAAC,MAAQoB,EAAKoG,aAAa,MAAQpG,EAAKmG,mBAAkB,IAAI,IAE9oBrF,EAAkB,GCkBP,GACf3C,iCACAgD,OACAnB,MACAoB,YACAC,gBAEAe,oBAEAiD,mBACAC,OACA,OACAY,eACAF,iBAGAR,UAEAhD,iBACA,kCAGAE,mBACA,mCAGAgD,UACA,wBAEAC,SACAM,eAEA,8DAEAI,kBACAA,0BACA,aAAAR,OAAAS,MAAA,EACA,eACA,mBACA,kCACAC,uCACA,GACA,UC9DyX,ICQrX,G,UAAY,eACd,EACA,EACA,GACA,EACA,KACA,WACA,OAIa,I,qDCfR,MAAMhH,EAAyB,CACpCG,WAAY,CAAC8G,SAGF/F,EAAoB,CAC/BC,OAAQ,CAAC+F,SAGEC,EAAqB,CAChCC,UAAU,EACVC,QAAS,2BACTC,QAAS,QAGEC,EAAqB,CAChCH,UAAU,EACVC,QAAS,2BACTC,QAAS,QAGEE,EAAsB,CACjCJ,UAAU,EACVC,QAAS,2BACTC,QAAS,UASJ,SAASG,EAAwBC,EAAYC,EAAaC,GAC/D,MAAM,UAAEC,EAAS,WAAEC,EAAU,WAAEC,EAAU,SAAEC,GAAaN,EACxD,IAAIL,EAAU,GAMd,OAJEA,EADiB,MAAfM,EACQ,kDAEAG,GAAcF,GAAyB,iBAE5C,CACLK,UAAW,CAACC,EAAMpJ,EAAOsB,KACvB,MAAM+H,EAAaC,IAAOtJ,EAAO,YAAYuJ,OAC7C,OAAQR,GACN,KAAKS,OAAmBC,IACxB,KAAKD,OAAmBE,YACxB,KAAKF,OAAmBG,SACtBC,EAAWP,EAAYJ,EAAYC,EAAUX,EAASjH,EAAU,OAChE,MACF,KAAKkI,OAAmBK,MACtBD,EAAWP,EAAYJ,EAAYC,EAAUX,EAASjH,EAAU,SAChE,MACF,KAAKkI,OAAmBM,KACtBF,EAAWP,EAAYJ,EAAYC,EAAUX,EAASjH,EAAU,QAChE,MACF,KAAKkI,OAAmBO,WACtBH,EAAWP,EAAYJ,EAAYC,EAAUX,EAASjH,EAAU,SAChE,MACF,QACEA,IACA,QAGNkH,QAAS,UAIb,SAASoB,EAAWP,EAAYJ,EAAYC,EAAUX,EAASjH,EAAU0I,GACvE,IAAIC,EAAa,KACbC,EAAY,KACZjB,IAEAgB,EADW,UAATD,EACWV,IAAOJ,EAAU,cAAcK,OAE/BD,MAASa,SAASC,SAASnB,GAAae,GAAMT,OAEzDF,EAAaY,IAMff,IAEAgB,EADW,UAATF,EACUV,IAAOL,EAAY,cAAcM,OAEjCD,MAASa,SAASC,SAASlB,GAAWc,GAAMT,OAEtDF,EAAaa,GAVf5I,EAASiH,GAgBbjH,I,gBCGF,SAAS+I,EAAoB1I,GAC7B,4BACA,YACA,CACA3B,cACA6C,uBAGA,SAGA,SAASyH,EAAyB3I,EAAM4I,GACxC,SACA,MACA,UAAAhG,aAAAM,mBAAA2F,MAAA,0BACA,UACA,kBACA,mBACA,qBACA,kBACA,eAEA3F,kBAEA4F,gBAEA,eAEA5F,QAEA4F,UAEA,MACA,iBACAC,0CACAD,mCACA,qBACAA,oCAEA,MACA,iBACAA,2DACA,qBACAA,4DAEA,MACA,oBACAA,IACA,MACA,QACAA,IACA,MAEA,SAGe,OACf3K,oBACAgH,YAAA6D,cAAAC,wBACA9H,OACAnB,MAEAoB,YACAC,UACA,WAGAW,mBAEAZ,aACAC,YAEA6H,gBACAC,oBAEA/H,aACAC,YAEAQ,mBAEAT,aACAC,YAEAd,SACAa,qBACAC,aAGAgE,mBACAC,OACA,OACAzC,2BACAV,uBACAE,0BAGAmD,UACApD,aACA,gCAEAwG,OACA,0BAEAQ,iBACA,oCAGAC,mBACA,iBAAApC,GAAA,iEACA,UAEAqC,gBACA,uCAGAC,2BACA,2CAEAC,0BACA,uCACA,6DAIA,8CACAxJ,kEAEA,aAGA,kEAIAyJ,yBACA,yCAEAC,wBAEA,gEAGAxH,mBACA,4BAEA,8DACA,oDAEA,iGACAuF,QAEA,UAEA9E,qBACA,kBACA,oBAGA,eAFA,KAKAS,yBACA,yDAGAuG,cACA,iCAEAC,aACA,+CAGA7G,iBACA,mCAGAC,qBACA,6DAGA6G,cACA,iCAGAC,kBACA,6CAGAC,eACA,6CAGAtG,gBACA,8CAEA,CACAuG,gBACA,gCAGA,kBAEA,CACAA,gBACA,sCAIA,IAIAC,gBACA,0BAGAC,0BACA,mDAEAC,0BACA,gBAAAC,2BAAAC,0BAAAC,YAAA1H,GAAA,WACA,wBAAA4G,wBAAAE,2BAAAH,yBAAAE,GAAA,KACA,WAEA,OAOA,GALAc,EADA,mBACAA,KAEAA,WAGA,QACA,UACA,mBACA9C,IACA,MACA,qBACAA,IACA,MACA,QACAA,IAGA,UAEA+C,wBACA,iBAAAjM,wBAAA4I,GAAA,UACA,WAQA,OAPA,IACAM,GACAgD,sBACA7D,4BACAC,iBAGA,GAEA6D,qBACA,WAIA,OAHA,wBACAjD,8EAEA,GAGAjF,iBACA,kCAGAE,mBACA,mCAGA+C,OACArD,gBAEA,+EACA,gBAAAQ,aAAAM,GAAA,UAEA,6CACA,sEACA,kEACA,4BACA,qBACA4F,yBAEA,oCAGA,sBAIApD,UACA,oBAEAC,SAEAgF,cACA,GACA,sDACA,qBAEA,CACA,qBAEA,GADA,iCACA,uCACA,mCACA,kDAKAtH,oBACA,8BACA,0DAEA,yBACA,4CAEA,mBACA,oBACA,kDAKAuH,gBACA,oEAEAC,aACA,iEAEA5H,kBAEA,4CACA,gDAGAS,yBAEA,mBACA,kDC3buW,ICQnW,G,UAAY,eACd,EACA,EACA,GACA,EACA,KACA,WACA,OAIa,I,QCDA,GACfvF,sBACAgH,YAAA2F,gBACA3J,OACAnB,MACAoB,YACAC,UACA,YAIAgE,mBACAG,UACApD,aACA,gCAEAwG,OACA,0BAEArI,UACA,0BAEAwK,cACA,8BAEAlJ,oBACA,6CAEAmJ,mBACA,oCAGAC,wBACA,4BAGArJ,uBACA,mCAEAD,UACA,6BACA,CACAuJ,KACAC,KACAC,KACAC,KACAC,MAEA,CAAAC,UAGA9F,OACArD,gBAEA,+EAEA,4BACA,cAAAb,MAAA,UAEA,kCACA,oDAKAoE,SAEA7D,kCACA,4BACA,mCAIA0J,6BACA,wDACA,oDACA,mBACA,aACA,YAEA,2CACA,4CACA,YAEA,2CACA,6CAEA,2CACA,2CACAC,gBACAC,iBAEA,oBACA,GACA,8BAEA,GACA,mCCnHyW,ICQrW,G,UAAY,eACd,EACA,EACA,GACA,EACA,KACA,WACA,OAIa,K,QCnBX7N,GAAS,WAAkB,IAAIC,EAAIC,KAAKC,EAAGF,EAAIG,MAAMD,GAAG,OAAOA,EAAG,MAAM,CAACQ,YAAY,mBAAmB,CAAEV,EAAI6N,oBAAqB3N,EAAG,YAAY,CAACQ,YAAY,aAAaI,MAAM,CAAC,KAAO,SAASE,GAAG,CAAC,MAAQhB,EAAI8N,SAAS,CAAC9N,EAAIkB,GAAGlB,EAAImD,GAAGnD,EAAI+N,kBAAkB/N,EAAImB,KAAKjB,EAAG,WAAW,CAACqB,IAAI,kBAAkBb,YAAY,cAAcI,MAAM,CAAC,KAAOd,EAAIkC,KAAK8L,YAAY,OAAS,KAAK,CAAChO,EAAIgC,GAAIhC,EAAIyD,WAAW,SAASwK,EAAS7C,GAAU,OAAOlL,EAAG,kBAAkB,CAACoB,IAAI2M,EAASrK,QAAQ9C,MAAM,CAAC,SAAW,GAAG,MAAQ,OAAO,wBAAwB,IAAI6F,YAAY3G,EAAI4G,GAAG,CAAC,CAACtF,IAAI,SAASuF,GAAG,WAAW,MAAO,CAAC3G,EAAG,MAAM,CAACA,EAAG,OAAO,CAACE,WAAW,CAAC,CAACC,KAAK,OAAOC,QAAQ,SAASC,MAAOP,EAAIkO,aAAaD,GAAWxN,WAAW,2BAA2BC,YAAY,YAAY,CAACV,EAAIkB,GAAG,OAAOlB,EAAIkB,GAAG,IAAIlB,EAAImD,GAAG8K,EAAShL,iBAAiB,SAASmE,OAAM,GAAM,CAAC9F,IAAI,UAAUuF,GAAG,SAASsH,GAAO,MAAO,CAACjO,EAAG,aAAa,CAACY,MAAM,CAAC,OAAS,QAAQ,UAAY,YAAY,eAAe,0BAA0B,eAAe,GAAG,QAAUqN,EAAMC,IAAIhD,GAAUiD,6BAA6B,UAAYF,EAAMC,IAAIhD,GAAUkD,0BAA0B,CAACpO,EAAG,iBAAiB,CAACqB,IAAIvB,EAAIuO,iBAAiBJ,EAAO/C,GAAUoD,UAAS,EAAK1N,MAAM,CAAC,KAAOd,EAAIyO,aAAaN,EAAO/C,GAAU,SAAWA,EAAS,mBAAoB,EAAK,kBAAoBpL,EAAI+D,kBAAkB,QAAU/D,EAAIyC,SAASzB,GAAG,CAAC,qBAAqB,SAASuF,GAAQ,OAAOvG,EAAI0O,uBAAuBP,EAAMC,MAAM,uBAAuB,SAAS7H,GAAQ,OAAOvG,EAAI2O,yBAAyBR,EAAMC,UAAU,OAAO,MAAK,QAAWpO,EAAI6N,oBAAqB3N,EAAG,kBAAkB,CAACY,MAAM,CAAC,MAAQ,YAAY,MAAQ,QAAQ,MAAQ,OAAO,MAAQ,SAAS6F,YAAY3G,EAAI4G,GAAG,CAAC,CAACtF,IAAI,UAAUuF,GAAG,SAASsH,GAAO,OAAyB,IAAjBA,EAAMS,OAAc,CAAC1O,EAAG,YAAY,CAACQ,YAAY,mBAAmBI,MAAM,CAAC,KAAO,QAAQ,KAAO,QAAQE,GAAG,CAAC,MAAQ,SAASuF,GAAQ,OAAOvG,EAAI6O,UAAUV,EAAMS,WAAW,CAAC5O,EAAIkB,GAAG,kBAAa4N,KAAa,MAAK,KAAQ9O,EAAImB,MAAM,IAAI,IAE37D6B,GAAkB,GCwDP,IACf3C,qBACAgH,YAAA2F,gBACA3J,OACAnB,MACAoB,YACAC,UACA,YAIAgE,mBACAG,UACApD,aACA,gCAEAwG,OACA,0BAEAW,2BACA,2CAEAE,yBACA,yCAGAlI,YACA,gCAEAhB,UACA,0BAEAwK,cACA,8BAEAlJ,oBACA,6CAEA8J,sBACA,iDAGAkB,mBACA,2BAGAC,4BACA,2BAEAjB,gBACA,gEAEAkB,yBACA,iEAGAtH,OACArD,gBAEA,+EACA,iCACA,OAEA,+BACA,QACA,wDAEA,8DAKAuD,SACAqG,gBACA,gBAAA5B,0BAAAE,UAAA5I,GAAA,GACA,yBAAA6H,yBAAAE,aAAArH,GAAA,KAEA,uCAEA,gBAEA,WAOA,OALAmI,EADA,mBACAA,KAEAA,YAGA,WAEAyC,gCACA,WACA,6DAIA,kBACAhN,kDAEA,aAGA,sBAGAuM,kBACA,iBACA,WACA,qDAEA,OADAU,aACA,GAEAZ,sBACA,iBACA,sBAEA,eAGA,sBACA,OAGA,2CACA,GAGA,yEAEAa,cACA,SAIA,OAHA,kCACAC,6BAEA,GAEAC,wBACA,uBACA,SACA,WACA,KAgBA,GAdA,oCACA,gBAAAhD,0BAAAE,GAAA,GACA,gBACA+C,YAIA,kCACAnB,kBACA,eACAoB,uBAIA,UAEAA,cACA,gCAGA,UACAC,OACA,iBACA,6CAEA,MAGAC,aAGAL,GAFA,yBAOAA,KAEAM,QAGAd,aACA,sDACAe,wBACAC,sBACAvM,eACAwM,uBAEAC,UACA,oCAEAC,eAIAtB,0BACAN,kBACA,QACA6B,sBAGA,6CAIAtB,4BACAP,kBACA,QACAlM,mBACAA,qBAGA,6CASAgO,wCACA,uBAEA,mCAEA,gCAEA,8CAWAC,8BACA,iCACA,0CACA,GACA,2CACA,qCAEA,4CAGA,0CACA,0CACA,+CACA,iCAEA,4CAYAC,wCACA,sCACA,+CACA,GACAC,cACA,6CAEA,qCAEAC,cACA,8CAIAD,cACA,0CACA,0CACA,iDAEA,iCAEAC,cACA,gDC5VwW,MCSpW,I,oBAAY,eACd,GACA,GACA,IACA,EACA,KACA,WACA,OAIa,M,QCPA,IACfjQ,oBACAgH,YAAAkJ,gBAAAC,kBAAAC,kBACApN,OACAnB,MACAoB,YACAC,UACA,YAIAsE,SACA3E,6BCzBuW,MCQnW,I,UAAY,eACd,GACA,EACA,GACA,EACA,KACA,WACA,OAIa,M,QC4EA,IACf7C,eACAgH,YAAAqJ,iBACArN,OACAsN,SAEArN,YACAC,kBAEAqN,6BACAC,2BACAC,kBACAxN,YACAC,mBACAmG,sBACA,yEAGAoB,MAGAxH,YACAC,iBACAmG,sBACA,sFAGA7I,gBACAyC,aACAC,YAEAwN,eAEAzN,YACAC,kBAEAyN,gBAEA1N,aACAC,YAGA0N,+BACAC,cAEA5N,YACAC,kBAEA4N,SACA7N,WACAC,gBAGA6N,eACA9N,aACAC,YAGA8N,YACA/N,aACAC,aAGA+N,UACA,OACAxG,eACAyG,eAGA/J,OACA,OACA/F,yBACAkB,oBACAnC,eAEA6B,YACAmP,qBACAC,uBACAC,oBAEAC,yBACAC,uBAEAhR,WACAG,oBACA8Q,uBACArQ,oBAEAI,eAEAK,kBACAS,gBAEAE,WAEAE,oBAEAwI,oBAGA5D,UACAnF,eAEA,qCAEA,OADAuP,6CACA,GAGAC,qBACA,sEAEAC,eACA,4BAEAC,eACA,4BAEAtR,aACA,mDAEAuR,eACA,4BAEAC,qBACA,kCAEAC,qBACA,6CAEAC,qBACA,6CAGAC,mBACA,uCAGAjR,gBACA,sCAEAiD,aACA,+FAEAlD,qBACA,kEAGAmR,kBACA,0DAGAC,0BACA,8BACA,eACA,mCACA,UACA,8BACA,aACA,qCACA,cACA,sCACA,YACA,gCACA,WACA,+BACA,QACA,qCAGAC,0BACA,8BACA,eACA,mCACA,UACA,8BACA,aACA,qCACA,cACA,sCACA,YACA,gCACA,WACA,+BACA,QACA,qCAGAC,wBACA,8BACA,eACA,qCACA,cACA,wCACA,UACA,gCACA,YACA,kCACA,QACA,uCAIAC,qBACA,8BACA,eACA,iCACA,UACA,oCACA,aACA,qCACA,cACA,sCACA,YACA,oDACA,QACA,mCAGAC,2BACA,8BACA,eACA,oCACA,UACA,uCACA,cACA,+CACA,YACA,yCACA,QACA,sCAGAC,eACA,8BACA,eACA,OACAhC,2BACAiC,4BAEA,aACA,uBACA,WACA,uBACA,UACA,OACAjC,2BACAkC,mCAEA,cACA,OACAlC,4BAEA,QACA,OACAA,2BACAiC,8BAKAE,eACA,8BACA,eACA,gCACA,UACA,mCACA,aACA,qCACA,cACA,yCACA,YACA,qCACA,QACA,mCAIArL,OAEAtF,UACA4Q,WACA,4BACA,wDAGAC,SAGA1B,mBACAyB,WACA,6BACA,0CAGAC,SAGAzB,qBACAwB,WACA,qBACA,wCACAE,gBAEA,2DACA,KAGAD,SAGAnC,eACAkC,WACA,oBACA,0CAGAC,SAGAjC,kBACA,oBACA,EACA,gCAEA,gCAIAE,WACA,oBACA,EACA,oBAEA,kBAKA,4BACA8B,WACA,6DAEAC,UAGA,gBACA,oBACA,wBAEA,oBACA,8BAEA,oBACA,wBAEA,gEAGA,iCAEA,qBAEArL,SAEAuL,eACA,SAOA,MANA,gCACAC,qCAEA,oCACAA,wBAEA,gCACAtD,SACA,aAAAhI,sBAAAuL,MAAA,EACA,iBAEA,yCACA,UAEA,QACA9L,oBACA,uBAEAA,sDAEA,gCACA,0CAGAwI,eAGAuD,eACA,uDACAxD,SACA,aAAAhI,sBAAAuL,MAAA,EACA,eAEA,yCACA,UAEA,yCACA,0CAGAtD,eAGAwD,iBACA,OACA3C,4BAGA,OADA,yBACA,8BACAd,SACA,aAAAhI,sBAAAuL,0BAAAG,wBAAAC,GAAA,EACA,iBAEA,yCACA,UAGA,wCACA,oFAGA,WACA,uBAGA,IACA,sCAGA,oCAQA,OAPA,IACA,iDAGA,uFAEA,uCAAAJ,sBAAAG,uBAAAC,wBACA,KAGA1D,cACA2D,aACA,4BAIAC,2BACA,OACA3C,oCAEA,gCACAoC,qCAEA,oCACA,aAAAtL,uBAAA8L,2BAAAC,MAAA,EACA,eAIA,qEACAA,EACAD,MAKAE,uBACA,qEAGAC,YACA,qEAEAC,mBACA,qEAEAC,cACA,gEAEApH,gBACA,kEAGA,8BACA,oCACA,IACA,gBAEA,6BAEA,mDAAAqH,wBAIAzS,gCACA,sDACA,IACA,kDAIAmB,uBACA,uDACA+M,4BACAC,0BACAC,qBACAxM,iBACA,UAEA,qCAEA,gBAEA,8BAEA,qBACA,4BACA,kCAEA,+BAEA,mDAAA6Q,yBAIApR,wBACA,2CACA,gCACAqR,kDAEA,uBACAA,yCAEAC,eACAtE,UACA,kGAEA,yDACAH,4BACAtM,eACAwM,qBACAwE,sBAEAvE,aACAC,cAEA,6BAGAA,UAEA,yDACA,8CAEA,2CACA,eACAlH,iFACAxF,oBAMA,4BAEA,yCAEA,GADA,6CACA,4BACA,aAAAiR,GAAA,EACA,SACA,8DACAC,oBAEA,GACA,MAEA,cACA,sFACA,UACA,CACA5E,wBACAC,sBACAvM,eACAwM,uBAGAC,UAEA,2BAEAC,eACA,OAGA,yBAGA,0FACAJ,4BACA0E,oBACAhR,YACAwM,uBAGA,qDACA,4CACA,4BAQAxN,sBACA,mBACA,oCAEA,oBACA,oCACA,0CACA,qDAIAmS,wBACA,OACA5D,2BACA6D,4CAGA,OADA,yBACA,8CACA,4BAIAC,oBAEA,8BAEA,YADA,gGAGA,OACA9D,2BACA6D,mDACAE,mCAEA,yBACA,qBACAvB,oBAEA,qBACAtD,eACA,aAAAhI,GAAA,EACA,cACA,SACA,2EAEA,iDAGA,oCACA,gBAEA,0BACA,oBACA,oBAEA,+BAGA,sCAGAiI,UAEA,sCAEA2D,aACA,8BC5wB6W,MCQzW,I,WAAY,eACd,GACA5T,EACAiD,GACA,EACA,KACA,WACA,OAIa,U,6CCnBf,W,qCCAA,W,kCCAA,W,kCCAA,W,2DCAA,W,kCCAA,W,kCCAA,W","file":"js/chunk-c14455b0.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"activeMenuColor\":\"#366bfc\",\"primaryColor\":\"#366bfc\",\"menuColor\":\"#5c5c5c\",\"fillEmphasisColor\":\"#5c5c5c\",\"fillLightColor\":\"#fafafa\",\"fillStrongColor\":\"#c7c7c7\",\"fillRegularColor\":\"#f0f0f0\",\"fillColorDark\":\"#e0e0e0\",\"lineStrongColor\":\"#8f8f8f\",\"textEmphasisColor\":\"#282828\",\"backgroundColor\":\"#fff\",\"statusErrorColor\":\"#ff4040\",\"statusSuccessColor\":\"#27bf88\",\"statusColorwarning\":\"#ff7420\",\"statusColorSAecondaryWarning\":\"#faaf0c\",\"statusNoticeColor\":\"#338bff\",\"statusDark\":\"#c7c7c7\",\"initialColor\":\"#E0E0E0\",\"statusNoticeBackgroundColor\":\"#F0F9FF\",\"statusErrorBackgroundColor\":\"#FFF2F0\",\"statusSuccessBackgroundColor\":\"#F0FFF7\",\"statusSecondaryWarningBackgroundColor\":\"#FFFBE6\",\"statusWarningBackgroundColor\":\"#FFF6E6\",\"statusDarkBackgroundColor\":\"#FAFAFA\",\"lineColorBlue\":\"#ADD9FF\",\"lineColorError\":\"#FFC1BA\",\"lineColorGreen\":\"#A5E6C6\",\"lineColorWarning\":\"#FFF7ed\"};","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./kyc-field-item.vue?vue&type=style&index=0&id=4fde1717&prod&lang=scss&scoped=true&\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.initLoading),expression:\"initLoading\"}],staticClass:\"common-kyc-form\"},[(_vm.isEditMode && !_vm.editing && _vm.showEditButton)?_c('el-button',{staticClass:\"edit-button portal-operation-button\",attrs:{\"size\":\"small\",\"loading\":_vm.editClickLoading,\"icon\":\"el-icon-edit\"},on:{\"click\":_vm.handleEditButtonClick}},[_vm._v(\"Edit\")]):_vm._e(),(_vm.ableEditTrustLevel && _vm.isEditingMode)?[_c('el-form',{key:\"innerTrustLevelForm\",ref:\"innerTrustLevelForm\",staticClass:\"trust-level-form\",attrs:{\"size\":\"small\",\"label-position\":\"top\",\"model\":_vm.trustLevelFormData,\"rules\":_vm.TRUST_LEVEL_FORM_RULES}},[_c('el-row',{attrs:{\"gutter\":20}},[_c('el-col',{attrs:{\"span\":8}},[_c('el-form-item',{attrs:{\"label\":\"Trust Level\",\"prop\":\"trustLevel\"}},[_c('el-select',{on:{\"change\":_vm.handleTrustLevelSelectChange},model:{value:(_vm.trustLevelFormData.trustLevel),callback:function ($$v) {_vm.$set(_vm.trustLevelFormData, \"trustLevel\", $$v)},expression:\"trustLevelFormData.trustLevel\"}},_vm._l((_vm.trustLevelList),function(item){return _c('el-option',{key:item.trustLevelId,attrs:{\"label\":item.trustLevelName,\"value\":item.trustLevelId}})}),1)],1)],1)],1)],1),_c('el-divider',{staticClass:\"trust-level-container-divider\"})]:_vm._e(),_c('el-form',{key:\"innerKycForm\",ref:\"innerKycForm\",attrs:{\"size\":\"small\",\"label-position\":\"top\",\"model\":_vm.formData,\"validate-on-rule-change\":false},on:{\"validate\":_vm.handleValidate}},_vm._l((_vm.kycGroupList),function(kycGroupItem){return _c('kyc-group-item',{key:kycGroupItem.groupId,attrs:{\"item\":kycGroupItem}})}),1),(_vm.isEditingMode)?[_c('el-form',{key:\"remarkForm\",ref:\"remarkForm\",staticClass:\"remark-form\",attrs:{\"size\":\"small\",\"label-position\":\"top\",\"model\":_vm.remarkFormData,\"rules\":_vm.REMARK_FORM_RULES}},[_c('el-form-item',{attrs:{\"label\":\"Remark\",\"prop\":\"remark\"}},[_c('el-input',{attrs:{\"type\":\"textarea\",\"placeholder\":\"Please Enter\",\"rows\":4},model:{value:(_vm.remarkFormData.remark),callback:function ($$v) {_vm.$set(_vm.remarkFormData, \"remark\", $$v)},expression:\"remarkFormData.remark\"}})],1)],1),_c('div',{staticClass:\"edit-button-list\"},[_c('el-button',{attrs:{\"size\":\"small\"},on:{\"click\":_vm.handleEditResetClick}},[_vm._v(\"Cancel\")]),_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"small\",\"loading\":_vm.submitBtnLoading},on:{\"click\":_vm.handleEditSubmitClick}},[_vm._v(\"Submit\")])],1)]:_vm._e()],2)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"kyc-group--item\"},[_c('kyc-group-label',{attrs:{\"label\":_vm.item.realDisplayName}}),(_vm.isMultiKYCGroupType(_vm.item.groupId))?_c('array-kyc-group',{attrs:{\"item\":_vm.item}}):_c('simple-kyc-group',{attrs:{\"item\":_vm.item}})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('span',{staticClass:\"kycGroupLabel\"},[_vm._v(_vm._s(_vm.label))])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <span class=\"kycGroupLabel\">{{ label }}</span>\n</template>\n<script>\nexport default {\n  name: 'KycGroupLabel',\n  props: {\n    label: {\n      type: String,\n      default: '',\n    },\n  },\n};\n</script>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./kyc-group-label.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./kyc-group-label.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./kyc-group-label.vue?vue&type=template&id=7c3bd5ad&\"\nimport script from \"./kyc-group-label.vue?vue&type=script&lang=js&\"\nexport * from \"./kyc-group-label.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('el-row',{staticClass:\"simple_kyc\",attrs:{\"gutter\":20}},[_vm._l((_vm.item.kycFields),function(kycField){return _c('el-col',_vm._b({key:kycField.fieldId},'el-col',_vm.colSpan,false),[_c('kyc-field-item',{attrs:{\"item\":kycField,\"specialSimpleField\":_vm.isSpecialSimpleField,\"groupEditDisabled\":_vm.groupEditDisabled,\"groupId\":_vm.groupId},on:{\"special-simple-field-change\":_vm.handleSpecialSimpleFieldChange}})],1)}),_c('el-divider',{staticClass:\"simple-kyc-group-divider\"})],2)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{class:{\n    'kyc-group--field': true,\n    'inner-table': _vm.isMultiGroupField,\n  }},[_c('el-form-item',{ref:\"fieldFormItem\",attrs:{\"label\":_vm.isMultiGroupField ? '' : _vm.item.realDisplayName,\"prop\":_vm.item.propPath,\"rules\":_vm.getValidateRules}},[(_vm.item.fieldId === _vm.REGION_FIELD_ID)?[_c('region-field',{attrs:{\"item\":_vm.item,\"isViewMode\":_vm.isViewMode}})]:(_vm.item.fieldId === _vm.NC_LANG_FIELD_ID)?[_c('preferred-nc-lang-field',{attrs:{\"item\":_vm.item,\"isViewMode\":_vm.isViewMode}})]:(_vm.isViewMode || _vm.groupEditDisabled)?[_c('span',{class:{ view_span: true, high_light: _vm.isWorkflowDiff, delete_remark: _vm.isWorkflowDelete }},[_vm._v(_vm._s(_vm.viewModeFieldValue))])]:(_vm.item.fieldType == _vm.KYC_DISPLAYTYPE_MAP.INPUT)?[_c('el-input',{attrs:{\"clearable\":\"\",\"disabled\":_vm.configDisabled || _vm.multiFieldDisabled},on:{\"blur\":_vm.handleInputBlur},model:{value:(_vm.item.fieldValue),callback:function ($$v) {_vm.$set(_vm.item, \"fieldValue\", $$v)},expression:\"item.fieldValue\"}})]:(_vm.item.fieldType == _vm.KYC_DISPLAYTYPE_MAP.SELECT)?[_c('el-select',{attrs:{\"disabled\":_vm.configDisabled || _vm.hasBankAccountDisabled || _vm.multiFieldDisabled,\"clearable\":\"\",\"placeholder\":\"Please select\"},on:{\"change\":_vm.handSelectChange},model:{value:(_vm.item.fieldValue),callback:function ($$v) {_vm.$set(_vm.item, \"fieldValue\", $$v)},expression:\"item.fieldValue\"}},_vm._l((_vm.item.options),function(option){return _c('el-option',{key:option.value,attrs:{\"label\":option.label,\"value\":option.value}})}),1)]:(_vm.item.fieldType == _vm.KYC_DISPLAYTYPE_MAP.DATE)?[_c('el-date-picker',{attrs:{\"type\":\"date\",\"format\":\"dd/MM/yyyy\",\"value-format\":\"yyyyMMdd\",\"clearable\":\"\",\"picker-options\":_vm.pickerOptions,\"disabled\":_vm.configDisabled || _vm.multiFieldDisabled,\"editable\":false},on:{\"change\":_vm.handleDatePickerChange},model:{value:(_vm.item.fieldValue),callback:function ($$v) {_vm.$set(_vm.item, \"fieldValue\", $$v)},expression:\"item.fieldValue\"}})]:(_vm.item.fieldType == _vm.KYC_DISPLAYTYPE_MAP.TIME)?[_c('el-date-picker',{attrs:{\"type\":\"datetime\",\"format\":\"dd/MM/yyyy HH:mm:ss\",\"value-format\":\"yyyyMMddHHmmss\",\"clearable\":\"\",\"picker-options\":_vm.pickerOptions,\"disabled\":_vm.configDisabled || _vm.multiFieldDisabled,\"editable\":false},on:{\"change\":_vm.handleDatePickerChange},model:{value:(_vm.item.fieldValue),callback:function ($$v) {_vm.$set(_vm.item, \"fieldValue\", $$v)},expression:\"item.fieldValue\"}})]:(_vm.item.fieldType == _vm.KYC_DISPLAYTYPE_MAP.RADIO)?[_c('el-radio-group',{attrs:{\"disabled\":_vm.configDisabled || _vm.multiFieldDisabled},model:{value:(_vm.item.fieldValue),callback:function ($$v) {_vm.$set(_vm.item, \"fieldValue\", $$v)},expression:\"item.fieldValue\"}},_vm._l((_vm.item.options),function(option){return _c('el-radio',{key:option.value,attrs:{\"label\":option.value}},[_vm._v(\" \"+_vm._s(option.label)+\" \")])}),1)]:(_vm.item.fieldType == _vm.KYC_DISPLAYTYPE_MAP.CHECKBOX)?[_c('el-checkbox-group',{attrs:{\"disabled\":_vm.configDisabled || _vm.multiFieldDisabled},model:{value:(_vm.item.fieldValue),callback:function ($$v) {_vm.$set(_vm.item, \"fieldValue\", $$v)},expression:\"item.fieldValue\"}},_vm._l((_vm.item.options),function(option){return _c('el-checkbox',{key:option.value,attrs:{\"label\":option.value}},[_vm._v(\" \"+_vm._s(option.label)+\" \")])}),1)]:(_vm.item.fieldType == _vm.KYC_DISPLAYTYPE_MAP.PICTURE)?[_c('el-input',{attrs:{\"disabled\":\"\"},model:{value:(_vm.item.fieldValue),callback:function ($$v) {_vm.$set(_vm.item, \"fieldValue\", $$v)},expression:\"item.fieldValue\"}})]:_vm._e()],2)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"region_field_container\"},[(_vm.isViewMode)?_c('span',{class:{ high_light: _vm.isWorkflowDiff, delete_remark: _vm.isWorkflowDelete }},[_vm._v(_vm._s(_vm.regionCode2FullNameMap[_vm.item.fieldValue] || _vm.item.fieldValue || '-'))]):_c('el-select',{attrs:{\"clearable\":\"\",\"placeholder\":\"Please select\",\"popper-append-to-body\":false},on:{\"clear\":_vm.handleRegionClear,\"focus\":_vm.handleRegionFocus},model:{value:(_vm.item.fieldValue),callback:function ($$v) {_vm.$set(_vm.item, \"fieldValue\", $$v)},expression:\"item.fieldValue\"}},[_c('template',{slot:\"prefix\"},[_c('i',{staticClass:\"region-more el-icon-more el-icon--right icon-cursor\"})]),(_vm.validRegionCode2FullNameMap)?_vm._l((_vm.regionCode2FullNameMap),function(value,key){return _c('el-option',{key:key,attrs:{\"label\":value,\"value\":key}})}):_vm._e()],2),_c('portal-dialog',{attrs:{\"visible\":_vm.dialogVisible,\"title\":\"Select Region\",\"width\":\"600px\",\"top\":\"12vh\",\"append-to-body\":\"\",\"destroy-on-close\":\"\"},on:{\"update:visible\":function($event){_vm.dialogVisible=$event},\"opened\":_vm.handleDialogOpened,\"cancel-btn-click\":_vm.handleDialogCancel,\"confirm-btn-click\":_vm.handleDialogConfirm},scopedSlots:_vm._u([{key:\"content\",fn:function(){return [_c('div',{staticClass:\"select_tree_container\"},[_c('el-input',{attrs:{\"clearable\":\"\",\"size\":\"small\",\"suffix-icon\":\"el-icon-search\"},model:{value:(_vm.searchText),callback:function ($$v) {_vm.searchText=$$v},expression:\"searchText\"}}),_c('el-tree',{ref:\"regionTree\",attrs:{\"data\":_vm.treeData,\"highlight-current\":\"\",\"show-checkbox\":\"\",\"node-key\":\"regionCode\",\"check-strictly\":\"\",\"accordion\":\"\",\"default-checked-keys\":_vm.checkedKeys,\"default-expanded-keys\":_vm.checkedKeys,\"indent\":26,\"props\":_vm.defaultProps,\"filter-node-method\":_vm.filterNode},on:{\"check\":_vm.handleTreeNodeCheck}})],1)]},proxy:true}])})],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"region_field_container\">\n    <span v-if=\"isViewMode\" :class=\"{ high_light: isWorkflowDiff, delete_remark: isWorkflowDelete }\">{{\n      regionCode2FullNameMap[item.fieldValue] || item.fieldValue || '-'\n    }}</span>\n    <el-select\n      v-else\n      v-model=\"item.fieldValue\"\n      clearable\n      placeholder=\"Please select\"\n      :popper-append-to-body=\"false\"\n      @clear=\"handleRegionClear\"\n      @focus=\"handleRegionFocus\"\n    >\n      <template slot=\"prefix\">\n        <i class=\"region-more el-icon-more el-icon--right icon-cursor\"></i>\n      </template>\n      <template v-if=\"validRegionCode2FullNameMap\">\n        <el-option v-for=\"(value, key) in regionCode2FullNameMap\" :key=\"key\" :label=\"value\" :value=\"key\"></el-option>\n      </template>\n    </el-select>\n    <portal-dialog\n      :visible.sync=\"dialogVisible\"\n      title=\"Select Region\"\n      width=\"600px\"\n      top=\"12vh\"\n      append-to-body\n      destroy-on-close\n      @opened=\"handleDialogOpened\"\n      @cancel-btn-click=\"handleDialogCancel\"\n      @confirm-btn-click=\"handleDialogConfirm\"\n    >\n      <template v-slot:content>\n        <div class=\"select_tree_container\">\n          <el-input v-model=\"searchText\" clearable size=\"small\" suffix-icon=\"el-icon-search\"></el-input>\n          <el-tree\n            ref=\"regionTree\"\n            :data=\"treeData\"\n            highlight-current\n            show-checkbox\n            node-key=\"regionCode\"\n            check-strictly\n            accordion\n            :default-checked-keys=\"checkedKeys\"\n            :default-expanded-keys=\"checkedKeys\"\n            :indent=\"26\"\n            :props=\"defaultProps\"\n            :filter-node-method=\"filterNode\"\n            @check=\"handleTreeNodeCheck\"\n          ></el-tree>\n        </div>\n      </template>\n    </portal-dialog>\n  </div>\n</template>\n\n<script>\nimport PortalDialog from '@/components/portal-dialog';\nimport { sortRegionTreeNode, getRegionCode2FullNameMap, getWorkflowDiff, getWorkflowDelete } from '../utils.js';\nimport { getRegionData } from '../kyc-form/kyc-api';\n\nexport default {\n  name: 'RegionField',\n  components: { PortalDialog },\n  props: {\n    item: {\n      type: Object,\n      default: () => {},\n    },\n    isViewMode: Boolean,\n  },\n  inject: ['kycForm'],\n  data() {\n    return {\n      dialogVisible: false,\n      searchText: '',\n\n      checkedKeys: [],\n      defaultProps: {\n        children: 'regionInfoTreeDatas',\n        label: 'regionName',\n      },\n      treeData: [],\n      regionCode2FullNameMap: [],\n    };\n  },\n  computed: {\n    validRegionCode2FullNameMap() {\n      return Object.keys(this.regionCode2FullNameMap).length;\n    },\n    // workflow 业务使用，判断该字段是否需要高亮\n    isWorkflowDiff() {\n      return getWorkflowDiff(this.item);\n    },\n    // workflow 业务使用，判断该字段是否需要标记删除\n    isWorkflowDelete() {\n      return getWorkflowDelete(this.item);\n    },\n  },\n  watch: {\n    searchText(val) {\n      this.$refs.regionTree.filter(val);\n    },\n    dialogVisible(val) {\n      if (!val) {\n        // 关闭region弹窗，触发一下表单校验\n        this.kycForm && this.kycForm.validateField(this.item.propPath);\n      }\n    },\n  },\n  created() {\n    this.getRegionData();\n    if (this.item.fieldValue) {\n      this.checkedKeys = [this.item.fieldValue];\n    }\n  },\n  methods: {\n    handleRegionClear() {\n      this.checkedKeys = [];\n      if (this.$refs.regionTree) {\n        this.$refs.regionTree.setCheckedKeys([]);\n      }\n    },\n    handleRegionFocus() {\n      this.dialogVisible = true;\n    },\n    handleDialogOpened() {\n      this.$refs.regionTree.setCurrentKey(this.checkedKeys[0] || null);\n    },\n    handleDialogCancel() {\n      this.dialogVisible = false;\n    },\n    handleDialogConfirm() {\n      this.item.fieldValue = this.checkedKeys[0];\n      this.dialogVisible = false;\n    },\n    // 树节点过滤方法\n    filterNode(value, data) {\n      if (!value) return true;\n      let lowerValue = value.toLowerCase();\n      let lowerRegionName = data[this.defaultProps.label].toLowerCase();\n      return lowerRegionName.indexOf(lowerValue) !== -1;\n    },\n    // 树节点选中事件\n    handleTreeNodeCheck(data, checked) {\n      const { checkedKeys } = checked;\n      if (checkedKeys.length > this.checkedKeys.length) {\n        this.checkedKeys = checkedKeys.filter((item) => !this.checkedKeys.includes(item));\n      } else {\n        this.checkedKeys = checkedKeys;\n      }\n      this.$refs.regionTree.setCheckedKeys(this.checkedKeys);\n    },\n    getRegionData() {\n      getRegionData().then((res) => {\n        const {\n          header,\n          regionInfoTreeDatas: { regionInfoTreeDatas = [] },\n        } = res;\n        if (header && header.success) {\n          // 1. 将tree node进行排序\n          sortRegionTreeNode(regionInfoTreeDatas);\n          // 2. 获取 regionCode -> fullName 的映射，用于review阶段\n          this.regionCode2FullNameMap = getRegionCode2FullNameMap(regionInfoTreeDatas);\n          this.treeData = regionInfoTreeDatas;\n        }\n      });\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.region_field_container {\n  .high_light {\n    background-color: $--line_color--warning;\n  }\n  .delete_remark {\n    text-decoration: line-through;\n  }\n  .region-more {\n    color: $--text_color--strong;\n    position: relative;\n    left: 5px;\n  }\n  /deep/ .el-select {\n    .el-select-dropdown {\n      display: none;\n    }\n    .el-icon-arrow-up {\n      display: none;\n    }\n    .el-input--prefix > .el-input__inner {\n      padding-left: 15px;\n    }\n    .el-input__prefix {\n      transform: rotateZ(180deg);\n      width: 25px;\n      font-size: 14px;\n      right: 0px;\n      left: unset;\n      top: 0px;\n    }\n    .el-input__suffix {\n      right: 30px;\n    }\n  }\n}\n.select_tree_container {\n  border-radius: 4px;\n  padding: 16px;\n  background: $--text_color--white;\n  border: 1px solid $--line_color--regular;\n  /deep/ .el-tree {\n    margin-top: 16px;\n    height: 500px;\n    overflow-y: auto;\n    .tree-box-content .el-input__suffix {\n      top: -5px;\n    }\n    .el-checkbox__inner {\n      width: 14px;\n      height: 14px;\n    }\n    .el-tree-node__content {\n      height: 32px;\n      margin-bottom: 4px;\n    }\n    .el-checkbox__inner::after {\n      height: 6px;\n      width: 2px;\n      left: 4px;\n      top: 1px;\n      border-width: 2px;\n    }\n    .el-checkbox__input.is-indeterminate .el-checkbox__inner::before {\n      height: 3px;\n    }\n    .el-button--primary.is-plain {\n      color: $--primary_color;\n      background: $--text_color--white;\n      border-color: $--primary_color-text--disable;\n    }\n    .el-tree-node__expand-icon.is-leaf {\n      opacity: 0;\n    }\n    .el-checkbox.is-checked .el-checkbox__input.is-checked .el-checkbox__inner {\n      background-color: $--primary_color;\n      border-color: $--primary_color;\n    }\n    .el-checkbox .el-checkbox__input.is-indeterminate .el-checkbox__inner {\n      background-color: $--primary_color;\n      border-color: $--primary_color;\n    }\n  }\n}\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./region.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./region.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./region.vue?vue&type=template&id=0a58295c&scoped=true&\"\nimport script from \"./region.vue?vue&type=script&lang=js&\"\nexport * from \"./region.vue?vue&type=script&lang=js&\"\nimport style0 from \"./region.vue?vue&type=style&index=0&id=0a58295c&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0a58295c\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"nc_language\"},[(_vm.isViewMode)?_c('span',{class:{ high_light: _vm.isWorkflowDiff, delete_remark: _vm.isWorkflowDelete }},[_vm._v(_vm._s(_vm.languageMap[_vm.item.fieldValue] || '-'))]):_c('el-select',{attrs:{\"clearable\":\"\",\"placeholder\":\"Please select\"},on:{\"change\":_vm.handleChange},model:{value:(_vm.item.fieldValue),callback:function ($$v) {_vm.$set(_vm.item, \"fieldValue\", $$v)},expression:\"item.fieldValue\"}},_vm._l((_vm.langOptions),function(item){return _c('el-option',{key:item.languageCode,attrs:{\"label\":item.languageName,\"value\":item.languageCode}})}),1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"nc_language\">\n    <span v-if=\"isViewMode\" :class=\"{ high_light: isWorkflowDiff, delete_remark: isWorkflowDelete }\">{{\n      languageMap[item.fieldValue] || '-'\n    }}</span>\n    <el-select v-else v-model=\"item.fieldValue\" clearable placeholder=\"Please select\" @change=\"handleChange\">\n      <el-option\n        v-for=\"item in langOptions\"\n        :key=\"item.languageCode\"\n        :label=\"item.languageName\"\n        :value=\"item.languageCode\"\n      ></el-option>\n    </el-select>\n  </div>\n</template>\n\n<script>\nimport { getLanguageList } from '../kyc-form/kyc-api';\nimport { getWorkflowDiff, getWorkflowDelete } from '../utils.js';\n\nexport default {\n  name: 'PreferredNotificationLang',\n  props: {\n    item: {\n      type: Object,\n      default: () => {},\n    },\n    isViewMode: Boolean,\n  },\n  inject: ['kycForm'],\n  data() {\n    return {\n      langOptions: [],\n      languageMap: {},\n    };\n  },\n  computed: {\n    // workflow ҵ��ʹ�ã��жϸ��ֶ��Ƿ���Ҫ����\n    isWorkflowDiff() {\n      return getWorkflowDiff(this.item);\n    },\n    // workflow ҵ��ʹ�ã��жϸ��ֶ��Ƿ�ɾ�����\n    isWorkflowDelete() {\n      return getWorkflowDelete(this.item);\n    },\n  },\n  created() {\n    this.getLanguageList();\n  },\n  methods: {\n    handleChange() {\n      // ѡ��ı䣬����һ�±���У��\n      this.kycForm && this.kycForm.validateField(this.item.propPath);\n    },\n    getLanguageList() {\n      getLanguageList().then((res) => {\n        const { header, list = [] } = res;\n        if (header && header.success) {\n          this.langOptions = list;\n          this.languageMap = list.reduce((prev, curr) => {\n            prev[curr['languageCode']] = curr['languageName'];\n            return prev;\n          }, {});\n        }\n      });\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.nc_language {\n  .high_light {\n    background-color: $--line_color--warning;\n  }\n  .delete_remark {\n    text-decoration: line-through;\n  }\n}\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./preferred-nc-lang.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./preferred-nc-lang.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./preferred-nc-lang.vue?vue&type=template&id=5b02730f&scoped=true&\"\nimport script from \"./preferred-nc-lang.vue?vue&type=script&lang=js&\"\nexport * from \"./preferred-nc-lang.vue?vue&type=script&lang=js&\"\nimport style0 from \"./preferred-nc-lang.vue?vue&type=style&index=0&id=5b02730f&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"5b02730f\",\n  null\n  \n)\n\nexport default component.exports","import { inputRequiredValidateObj, selectRequiredValidateObj } from '@/common/validator/common.js';\nimport { ALGORITHM_TYPE_MAP } from './utils';\nimport moment from 'dayjs';\n\nexport const TRUST_LEVEL_FORM_RULES = {\n  trustLevel: [selectRequiredValidateObj],\n};\n\nexport const REMARK_FORM_RULES = {\n  remark: [inputRequiredValidateObj],\n};\n\nexport const fieldInputRequired = {\n  required: true,\n  message: 'This field is mandatory.',\n  trigger: 'blur',\n};\n\nexport const fieldCheckRequired = {\n  required: true,\n  message: 'This field is mandatory.',\n  trigger: 'blur',\n};\n\nexport const fieldSelectRequired = {\n  required: true,\n  message: 'This field is mandatory.',\n  trigger: 'change',\n};\n\n/**\n * ����kyc�Ķ���У�����ã����ɶ����У�����\n * @param {Object} kycRuleExt kyc�ֶεĶ�������\n * @param {Number} currFiledId ��ǰ��fieldId\n * @param {String} validationDisplayName\n */\nexport function generateExtValidateRule(kycRuleExt, currFiledId, validationDisplayName) {\n  const { algorithm, promptInfo, beginValue, endValue } = kycRuleExt;\n  let message = '';\n  if (currFiledId == 1004) {\n    message = 'The value can not match the KYC rule extending.';\n  } else {\n    message = promptInfo || validationDisplayName || 'Invalid value.';\n  }\n  return {\n    validator: (rule, value, callback) => {\n      const selectDate = moment(value, 'YYYYMMDD').unix();\n      switch (algorithm) {\n        case ALGORITHM_TYPE_MAP.DAY:\n        case ALGORITHM_TYPE_MAP.ANNIVERSARY:\n        case ALGORITHM_TYPE_MAP.BIRTHDAY:\n          varifyData(selectDate, beginValue, endValue, message, callback, 'day');\n          break;\n        case ALGORITHM_TYPE_MAP.MONTH:\n          varifyData(selectDate, beginValue, endValue, message, callback, 'month');\n          break;\n        case ALGORITHM_TYPE_MAP.YEAR:\n          varifyData(selectDate, beginValue, endValue, message, callback, 'year');\n          break;\n        case ALGORITHM_TYPE_MAP.FIXED_DATE:\n          varifyData(selectDate, beginValue, endValue, message, callback, 'fixed');\n          break;\n        default:\n          callback();\n          break;\n      }\n    },\n    trigger: 'change',\n  };\n}\n\nfunction varifyData(selectDate, beginValue, endValue, message, callback, unit) {\n  let rangeRight = null;\n  let rangeLeft = null;\n  if (beginValue) {\n    if (unit === 'fixed') {\n      rangeRight = moment(endValue, 'DD-MM-YYYY').unix();\n    } else {\n      rangeRight = moment().subtract(parseInt(beginValue), unit).unix();\n    }\n    if (selectDate > rangeRight) {\n      // ���ڷ�Χ��\n      callback(message);\n      return;\n    }\n  }\n  if (endValue) {\n    if (unit === 'fixed') {\n      rangeLeft = moment(beginValue, 'DD-MM-YYYY').unix();\n    } else {\n      rangeLeft = moment().subtract(parseInt(endValue), unit).unix();\n    }\n    if (selectDate < rangeLeft) {\n      // ���ڷ�Χ��\n      callback(message);\n      return;\n    }\n  }\n  callback();\n}\n","<template>\n  <div\n    :class=\"{\n      'kyc-group--field': true,\n      'inner-table': isMultiGroupField,\n    }\"\n  >\n    <el-form-item\n      ref=\"fieldFormItem\"\n      :label=\"isMultiGroupField ? '' : item.realDisplayName\"\n      :prop=\"item.propPath\"\n      :rules=\"getValidateRules\"\n    >\n      <!-- 特殊的 Region field -->\n      <template v-if=\"item.fieldId === REGION_FIELD_ID\">\n        <region-field :item=\"item\" :isViewMode=\"isViewMode\" />\n      </template>\n      <!-- 特殊的 Preferred Notification Language field -->\n      <template v-else-if=\"item.fieldId === NC_LANG_FIELD_ID\">\n        <preferred-nc-lang-field :item=\"item\" :isViewMode=\"isViewMode\" />\n      </template>\n      <!-- 预览模式 -->\n      <template v-else-if=\"isViewMode || groupEditDisabled\">\n        <span :class=\"{ view_span: true, high_light: isWorkflowDiff, delete_remark: isWorkflowDelete }\">{{\n          viewModeFieldValue\n        }}</span>\n      </template>\n      <template v-else-if=\"item.fieldType == KYC_DISPLAYTYPE_MAP.INPUT\">\n        <el-input\n          v-model=\"item.fieldValue\"\n          clearable\n          :disabled=\"configDisabled || multiFieldDisabled\"\n          @blur=\"handleInputBlur\"\n        ></el-input>\n      </template>\n      <template v-else-if=\"item.fieldType == KYC_DISPLAYTYPE_MAP.SELECT\">\n        <el-select\n          v-model=\"item.fieldValue\"\n          :disabled=\"configDisabled || hasBankAccountDisabled || multiFieldDisabled\"\n          clearable\n          placeholder=\"Please select\"\n          @change=\"handSelectChange\"\n        >\n          <el-option v-for=\"option in item.options\" :label=\"option.label\" :value=\"option.value\" :key=\"option.value\" />\n        </el-select>\n      </template>\n      <template v-else-if=\"item.fieldType == KYC_DISPLAYTYPE_MAP.DATE\">\n        <el-date-picker\n          type=\"date\"\n          v-model=\"item.fieldValue\"\n          format=\"dd/MM/yyyy\"\n          value-format=\"yyyyMMdd\"\n          clearable\n          :picker-options=\"pickerOptions\"\n          :disabled=\"configDisabled || multiFieldDisabled\"\n          :editable=\"false\"\n          @change=\"handleDatePickerChange\"\n        />\n      </template>\n      <template v-else-if=\"item.fieldType == KYC_DISPLAYTYPE_MAP.TIME\">\n        <el-date-picker\n          type=\"datetime\"\n          v-model=\"item.fieldValue\"\n          format=\"dd/MM/yyyy HH:mm:ss\"\n          value-format=\"yyyyMMddHHmmss\"\n          clearable\n          :picker-options=\"pickerOptions\"\n          :disabled=\"configDisabled || multiFieldDisabled\"\n          :editable=\"false\"\n          @change=\"handleDatePickerChange\"\n        />\n      </template>\n      <template v-else-if=\"item.fieldType == KYC_DISPLAYTYPE_MAP.RADIO\">\n        <el-radio-group v-model=\"item.fieldValue\" :disabled=\"configDisabled || multiFieldDisabled\">\n          <el-radio :label=\"option.value\" v-for=\"option in item.options\" :key=\"option.value\">\n            {{ option.label }}\n          </el-radio>\n        </el-radio-group>\n      </template>\n      <template v-else-if=\"item.fieldType == KYC_DISPLAYTYPE_MAP.CHECKBOX\">\n        <el-checkbox-group v-model=\"item.fieldValue\" :disabled=\"configDisabled || multiFieldDisabled\">\n          <el-checkbox :label=\"option.value\" v-for=\"option in item.options\" :key=\"option.value\">\n            {{ option.label }}\n          </el-checkbox>\n        </el-checkbox-group>\n      </template>\n      <template v-else-if=\"item.fieldType == KYC_DISPLAYTYPE_MAP.PICTURE\">\n        <el-input v-model=\"item.fieldValue\" disabled></el-input>\n      </template>\n    </el-form-item>\n  </div>\n</template>\n\n<script>\nimport RegionField from './kyc-special-field/region';\nimport PreferredNcLangField from './kyc-special-field/preferred-nc-lang';\nimport { KYC_DISPLAYTYPE_MAP, REGION_FIELD_ID, NC_LANG_FIELD_ID, getWorkflowDiff, getWorkflowDelete } from './utils';\nimport { dateFormat } from '@/common/utils/date-time-utils';\nimport { fieldInputRequired, fieldCheckRequired, fieldSelectRequired, generateExtValidateRule } from './validator';\nimport { cloneDeep } from 'lodash';\n\nfunction handleSelectOptions(item) {\n  const selectOptions = item.dataDictItems || [];\n  const defaultOptions = selectOptions.map((selectOption) => {\n    return {\n      value: selectOption.value,\n      label: selectOption.defaultName,\n    };\n  });\n  return defaultOptions;\n}\n\nfunction handleViewModeFieldValue(item, mode) {\n  let ret = '';\n  let originFormat = '';\n  let { fieldType, fieldValue, dataDictItemsMap = [] } = cloneDeep(item);\n  switch (fieldType) {\n    case KYC_DISPLAYTYPE_MAP.RADIO:\n    case KYC_DISPLAYTYPE_MAP.SELECT:\n    case KYC_DISPLAYTYPE_MAP.CHECKBOX:\n      if (Array.isArray(fieldValue)) {\n        if (mode === 'review') {\n          // review模式需要将值映射\n          fieldValue = fieldValue.map((value) => dataDictItemsMap[value]);\n        }\n        ret = fieldValue.join(',');\n      } else {\n        if (mode === 'review') {\n          // review模式需要将值映射\n          fieldValue = dataDictItemsMap[fieldValue];\n        }\n        ret = fieldValue || '-';\n      }\n      break;\n    case KYC_DISPLAYTYPE_MAP.DATE:\n      originFormat = fieldValue.includes('-') ? 'DD-MM-YYYY' : 'YYYYMMDD';\n      ret = dateFormat(fieldValue, 'DD/MM/YYYY', originFormat);\n      if (ret === 'Invalid Date') {\n        ret = dateFormat(fieldValue, 'DD/MM/YYYY', originFormat);\n      }\n      break;\n    case KYC_DISPLAYTYPE_MAP.TIME:\n      ret = dateFormat(fieldValue, 'DD/MM/YYYY HH:mm:ss', 'YYYYMMDDHHmmss');\n      if (ret === 'Invalid Date') {\n        ret = dateFormat(fieldValue, 'DD/MM/YYYY HH:mm:ss', 'YYYYMMDDHHmmss');\n      }\n      break;\n    case KYC_DISPLAYTYPE_MAP.PICTURE:\n      ret = fieldValue;\n      break;\n    default:\n      ret = fieldValue;\n      break;\n  }\n  return ret;\n}\n\nexport default {\n  name: 'KycFieldItem',\n  components: { RegionField, PreferredNcLangField },\n  props: {\n    item: {\n      // Field对象\n      type: Object,\n      default() {\n        return {};\n      },\n    },\n    isMultiGroupField: {\n      // 是否是多值kyc\n      type: Boolean,\n      default: false,\n    },\n    colIndex: Number, // 在多值kyc表格中的列序号\n    specialSimpleField: {\n      // 特殊的单值KYC 字段\n      type: Boolean,\n      default: false,\n    },\n    groupEditDisabled: {\n      // 编辑模式下，当前组的字段不可编辑\n      type: Boolean,\n      default: true,\n    },\n    groupId: {\n      type: [String, Number],\n      default: '',\n    },\n  },\n  inject: ['kycForm'],\n  data() {\n    return {\n      KYC_DISPLAYTYPE_MAP,\n      REGION_FIELD_ID,\n      NC_LANG_FIELD_ID,\n    };\n  },\n  computed: {\n    isViewMode() {\n      return this.kycForm.isViewMode;\n    },\n    mode() {\n      return this.kycForm.mode;\n    },\n    kycRuleExtList() {\n      return this.kycForm.kycRuleExtList;\n    },\n    // 当前field的额外配置\n    currFieldExtRule() {\n      const { kycRuleExt } = this.kycRuleExtList.find((rule) => rule.kycFieldId == this.item.fieldId) || {};\n      return kycRuleExt;\n    },\n    fieldFormItem() {\n      return this.$refs.fieldFormItem || null;\n    },\n    // 判断当前field是否受 basic product 影响\n    allBasicProductMandatory() {\n      return this.kycForm.basicProductMandatory;\n    },\n    isBasicProductMandatory() {\n      let item = this.allBasicProductMandatory[0];\n      if (Object.prototype.toString.call(item).slice(8, -1) === 'Object') {\n        // 2023.01.10\n        // 当前 mandatoryKycFieldIds 字段只包含 fieldId，没有考虑不同kyc 组中会出现项目 field 的情况（group实体创建时发现了这个问题）\n        // mandatoryKycFieldList 字段就是为了解决这个问题加的\n        let hasIndex = this.allBasicProductMandatory.findIndex(\n          (item) => item.kycGroupID === this.groupId && item.kycFieldID === this.item.fieldId\n        );\n        return hasIndex === -1 ? false : true;\n      } else {\n        // 如果 kyc 当前受 basic product 影响\n        return this.allBasicProductMandatory.includes(this.item.fieldId);\n      }\n    },\n    // 判断当前field是否受 trust level 影响\n    allTrustLevelMandatory() {\n      return this.kycForm.trustLevelMandatory;\n    },\n    isTrustLevelMandatory() {\n      // 如果 kyc 当前受 trust level 影响\n      return this.allTrustLevelMandatory.includes(this.item.fieldId);\n    },\n    // 字段校验条件\n    getValidateRules() {\n      if (this.isViewMode) return [];\n      // 编辑的时候，如果掩码处理的字段未修改，则跳过该字段的校验\n      if (this.kycForm.isEditMode && this.isSensitive && this.sameAsMask) {\n        return [this.getRequiredValidateRule].filter((rule) => !!rule);\n      }\n      const rules = [this.getRequiredValidateRule, this.getRegexpValidateRule, this.getExtValidateRule].filter(\n        (rule) => !!rule\n      );\n      return rules;\n    },\n    viewModeFieldValue() {\n      const item = this.item;\n      if (!item.fieldValue) {\n        return '-';\n      }\n      return handleViewModeFieldValue(item, this.mode);\n    },\n    // 单值kyc中， id = 1029 [Has Bank Account] 的kyc 不让编辑\n    hasBankAccountDisabled() {\n      return !this.isMultiGroupField && this.item.fieldId === 1029;\n    },\n    // 是敏感字段\n    isSensitive() {\n      return this.item.sensitive === '1';\n    },\n    sameAsMask() {\n      return this.item.fieldValue === this.item.value;\n    },\n    // field 的 disbaled 配置\n    configDisabled() {\n      return this.item.disabled === 'true';\n    },\n    // 多值kyc的disabled状态\n    multiFieldDisabled() {\n      return this.isMultiGroupField && this.item.multiDisabled === true;\n    },\n    // kyc [Date of Birth]\n    isBirthDate() {\n      return this.item.fieldId === 1004;\n    },\n    // kyc [ID Effective Date || Certificate Certified Date]\n    isEffectiveDate() {\n      return [104, 204].includes(this.item.fieldId);\n    },\n    // kyc [ID Expiry Date || Certificate Expiry Date]\n    isExpiryDate() {\n      return [105, 205].includes(this.item.fieldId);\n    },\n    // date piacker 组件配置\n    pickerOptions() {\n      if (this.isBirthDate || this.isEffectiveDate) {\n        // 生日和有效时间，当天以后不可选\n        return {\n          disabledDate(time) {\n            return time.getTime() > Date.now();\n          },\n        };\n      } else if (this.isExpiryDate) {\n        // 过期时间，当天以前不可选\n        return {\n          disabledDate(time) {\n            return time.getTime() < Date.now() - 24 * 60 * 60 * 1000;\n          },\n        };\n      } else {\n        return {};\n      }\n    },\n    // 表格中的第一列\n    isFirstColumn() {\n      return this.colIndex === 0;\n    },\n    // 多值kyc表格中的第一列\n    isMultiGroupFirstColumn() {\n      return this.isMultiGroupField && this.isFirstColumn;\n    },\n    getRequiredValidateRule() {\n      const { mandatory, simpleRelevancyMandatory, multiRelevancyMandatory, fieldType } = this.item;\n      const { isBasicProductMandatory, isTrustLevelMandatory, allBasicProductMandatory, allTrustLevelMandatory } = this;\n      let rule = null;\n      // 1. 兼容product、trust level决定的必选逻辑\n      let compositeMandatory = null;\n      if (allBasicProductMandatory.length || allTrustLevelMandatory.length) {\n        compositeMandatory = isBasicProductMandatory || isTrustLevelMandatory;\n      } else {\n        compositeMandatory = mandatory === 'true';\n      }\n      // 2. 兼容单值kyc、多值kyc特殊的关联逻辑\n      if (compositeMandatory || simpleRelevancyMandatory || multiRelevancyMandatory) {\n        switch (fieldType) {\n          case KYC_DISPLAYTYPE_MAP.SELECT:\n            rule = fieldSelectRequired;\n            break;\n          case KYC_DISPLAYTYPE_MAP.CHECKBOX:\n            rule = fieldCheckRequired;\n            break;\n          default:\n            rule = fieldInputRequired;\n        }\n      }\n      return rule;\n    },\n    getRegexpValidateRule() {\n      const { expression, validationDisplayName } = this.item;\n      let rule = null;\n      if (expression) {\n        rule = {\n          pattern: new RegExp(expression),\n          message: validationDisplayName || `Invalid value.`,\n          trigger: 'blur',\n        };\n      }\n      return rule;\n    },\n    getExtValidateRule() {\n      let rule = null;\n      if (this.currFieldExtRule) {\n        rule = generateExtValidateRule(this.currFieldExtRule, this.item.fieldId, this.item.validationDisplayName);\n      }\n      return rule;\n    },\n    // workflow 业务使用，判断该字段是否需要高亮\n    isWorkflowDiff() {\n      return getWorkflowDiff(this.item);\n    },\n    // workflow 业务使用，判断该字段是否删除标记\n    isWorkflowDelete() {\n      return getWorkflowDelete(this.item);\n    },\n  },\n  watch: {\n    isViewMode(newValue, oldValue) {\n      // 进入编辑模式\n      if (['edit', 'workflowDiff', 'workflowEdit'].includes(this.mode) && newValue === false && oldValue === true) {\n        const { fieldType, fieldValue } = this.item;\n        // 1、格式化 DATE、TIME 的数据\n        if ([KYC_DISPLAYTYPE_MAP.DATE, KYC_DISPLAYTYPE_MAP.TIME].includes(fieldType) && fieldValue) {\n          const format = this.item.fieldType === KYC_DISPLAYTYPE_MAP.DATE ? 'YYYYMMDD' : 'YYYYMMDDHHmmss';\n          const originFormat = this.item.fieldType === KYC_DISPLAYTYPE_MAP.DATE ? 'DD-MM-YYYY' : 'YYYYMMDDHHmmss';\n          let ret = dateFormat(fieldValue, format, originFormat);\n          if (ret === 'Invalid Date') {\n            ret = dateFormat(fieldValue, format, originFormat);\n          }\n          this.$set(this.item, 'fieldValue', ret);\n        }\n        // 2、添加 options 和处理数组数据\n        this.initOptions();\n      }\n    },\n  },\n  created() {\n    this.initOptions();\n  },\n  methods: {\n    // 初始化options\n    initOptions() {\n      if (\n        [KYC_DISPLAYTYPE_MAP.SELECT, KYC_DISPLAYTYPE_MAP.RADIO, KYC_DISPLAYTYPE_MAP.CHECKBOX].includes(\n          this.item.fieldType\n        )\n      ) {\n        const defaultOptions = handleSelectOptions(this.item);\n        this.$set(this.item, 'options', defaultOptions);\n        if (this.item.fieldType === KYC_DISPLAYTYPE_MAP.CHECKBOX) {\n          let fieldValue = String(this.item.fieldValue);\n          this.$set(this.item, 'fieldValue', fieldValue.split(','));\n        }\n      }\n    },\n    // 处理多值kyc表格中，第一列 选中与否的交互\n    handSelectChange(value) {\n      if (this.isMultiGroupFirstColumn) {\n        this.$emit(value ? 'first-column-valid' : 'first-column-invalid');\n      }\n      if (this.specialSimpleField) {\n        this.$emit('special-simple-field-change', value);\n      }\n      if (this.item.fieldId) {\n        this.$nextTick(() => {\n          this.kycForm.validateField(this.item.propPath);\n        });\n      }\n    },\n    // 表单项的方法\n    clearValidate() {\n      this.$refs.fieldFormItem && this.$refs.fieldFormItem.clearValidate();\n    },\n    resetField() {\n      this.$refs.fieldFormItem && this.$refs.fieldFormItem.resetField();\n    },\n    handleInputBlur() {\n      // 处理编辑时校验失灵问题\n      if (this.item.fieldId && this.kycForm.isEditMode) {\n        this.kycForm.validateField(this.item.propPath);\n      }\n    },\n    handleDatePickerChange() {\n      // 处理编辑时校验失灵问题\n      if (this.item.fieldId) {\n        this.kycForm.validateField(this.item.propPath);\n      }\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.kyc-group--field {\n  /deep/ .el-form-item__label {\n    color: $--text_color--strong !important;\n  }\n  /deep/ .el-form-item--small.el-form-item {\n    margin-bottom: 24px;\n  }\n  /deep/ .el-input.is-disabled .el-input__inner {\n    background-color: $--fill_color--light;\n    border-width: 0;\n    color: $--fill_color--strong;\n  }\n  /deep/ .el-form-item__content .el-icon-circle-close {\n    right: 0;\n  }\n  /deep/ .el-select .el-icon-circle-close,\n  /deep/ .el-date-editor .el-icon-circle-close {\n    right: 20px;\n  }\n  /deep/ .el-select > .el-input > .el-input__inner,\n  /deep/ .el-date-editor > .el-input__inner {\n    padding-right: 44px;\n  }\n}\n.view_span {\n  color: $--text_color--strong;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space: nowrap;\n}\n.high_light {\n  background-color: $--line_color--warning;\n}\n.delete_remark {\n  text-decoration: line-through;\n}\n.inner-table {\n  /deep/ .el-form-item--small.el-form-item {\n    margin-bottom: 0;\n  }\n  /deep/ .el-input--small .el-input__icon {\n    line-height: 48px;\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./kyc-field-item.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./kyc-field-item.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./kyc-field-item.vue?vue&type=template&id=4fde1717&scoped=true&\"\nimport script from \"./kyc-field-item.vue?vue&type=script&lang=js&\"\nexport * from \"./kyc-field-item.vue?vue&type=script&lang=js&\"\nimport style0 from \"./kyc-field-item.vue?vue&type=style&index=0&id=4fde1717&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"4fde1717\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <el-row class=\"simple_kyc\" :gutter=\"20\">\n    <el-col v-for=\"kycField in item.kycFields\" :key=\"kycField.fieldId\" v-bind=\"colSpan\">\n      <kyc-field-item\n        :item=\"kycField\"\n        :specialSimpleField=\"isSpecialSimpleField\"\n        :groupEditDisabled=\"groupEditDisabled\"\n        :groupId=\"groupId\"\n        @special-simple-field-change=\"handleSpecialSimpleFieldChange\"\n      />\n    </el-col>\n    <el-divider class=\"simple-kyc-group-divider\"></el-divider>\n  </el-row>\n</template>\n\n<script>\nimport KycFieldItem from './kyc-field-item.vue';\n\nexport default {\n  name: 'SimpleKycGroup',\n  components: { KycFieldItem },\n  props: {\n    item: {\n      type: Object,\n      default() {\n        return {};\n      },\n    },\n  },\n  inject: ['kycForm'],\n  computed: {\n    isViewMode() {\n      return this.kycForm.isViewMode;\n    },\n    mode() {\n      return this.kycForm.mode;\n    },\n    groupId() {\n      return this.item.groupId;\n    },\n    groupEnable() {\n      return this.item.groupEnable;\n    },\n    groupEditDisabled() {\n      return this.mode === 'edit' && !this.groupEnable;\n    },\n    isAdaptiveLayout() {\n      return this.kycForm.adaptiveLayout;\n    },\n    // Contact Details Group\n    isContactDetailsGroup() {\n      return this.groupId === 1007;\n    },\n    // 当前 simple group 中有特殊的关联逻辑\n    isSpecialSimpleField() {\n      return this.isContactDetailsGroup;\n    },\n    colSpan() {\n      return this.isAdaptiveLayout\n        ? {\n            xs: 8,\n            sm: 8,\n            md: 8,\n            lg: 8,\n            xl: 6,\n          }\n        : { span: 8 };\n    },\n  },\n  watch: {\n    isViewMode(newValue, oldValue) {\n      // 进入编辑模式\n      if (['edit', 'workflowDiff', 'workflowEdit'].includes(this.mode) && newValue === false && oldValue === true) {\n        // 触发 单值kyc 的 特殊关联逻辑\n        if (this.isContactDetailsGroup) {\n          let { kycFields = [] } = this.item;\n          // Preferred Notification Channel Field\n          let channelField = kycFields.find((field) => field.fieldId === 1013) || {};\n          this.handleContactDetailsGroup(channelField.fieldValue || '');\n        }\n      }\n    },\n  },\n  methods: {\n    // 处理单值kyc中，下拉框与其他字段间的关联关系\n    handleSpecialSimpleFieldChange(value) {\n      if (this.isContactDetailsGroup) {\n        this.handleContactDetailsGroup(value);\n      }\n    },\n    // channel 的选择会决定 misidn / email 字段是否必填的逻辑\n    handleContactDetailsGroup(channel) {\n      let smsField = this.item.kycFields.find((field) => field.fieldId === 1014) || {};\n      let emailField = this.item.kycFields.find((field) => field.fieldId === 1015) || {};\n      const smsFieldPropPath = smsField.propPath;\n      const emailFieldPropPath = emailField.propPath;\n      if (channel === '1011') {\n        // channel: email\n        this.$set(smsField, 'simpleRelevancyMandatory', false);\n        this.$set(emailField, 'simpleRelevancyMandatory', true);\n      } else if (channel === '1001') {\n        // channel: sms\n        this.$set(smsField, 'simpleRelevancyMandatory', true);\n        this.$set(emailField, 'simpleRelevancyMandatory', false);\n      } else {\n        this.$set(smsField, 'simpleRelevancyMandatory', false);\n        this.$set(emailField, 'simpleRelevancyMandatory', false);\n        smsField.fieldValue = '';\n        emailField.fieldValue = '';\n      }\n      this.$nextTick(() => {\n        if (smsFieldPropPath) {\n          this.kycForm.validateField(smsFieldPropPath);\n        }\n        if (emailFieldPropPath) {\n          this.kycForm.validateField(emailFieldPropPath);\n        }\n      });\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.simple_kyc {\n  display: flex;\n  flex-wrap: wrap;\n  /deep/ .el-date-editor.el-input,\n  /deep/ .el-date-editor.el-input__inner {\n    width: 100%;\n  }\n}\n.el-row {\n  margin-top: 20px;\n}\n/deep/.simple-kyc-group-divider {\n  margin: 0px 12px 20px 12px;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./simple-kyc-group.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./simple-kyc-group.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./simple-kyc-group.vue?vue&type=template&id=9dcbfbba&scoped=true&\"\nimport script from \"./simple-kyc-group.vue?vue&type=script&lang=js&\"\nexport * from \"./simple-kyc-group.vue?vue&type=script&lang=js&\"\nimport style0 from \"./simple-kyc-group.vue?vue&type=style&index=0&id=9dcbfbba&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"9dcbfbba\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"array-kyc-group\"},[(_vm.displayAddDeleteBtn)?_c('el-button',{staticClass:\"add_button\",attrs:{\"size\":\"small\"},on:{\"click\":_vm.addRow}},[_vm._v(_vm._s(_vm.addButtonText))]):_vm._e(),_c('el-table',{ref:\"multiGroupTable\",staticClass:\"multi_table\",attrs:{\"data\":_vm.item.fieldValues,\"border\":\"\"}},[_vm._l((_vm.kycFields),function(colField,colIndex){return _c('el-table-column',{key:colField.fieldId,attrs:{\"minWidth\":30,\"align\":\"left\",\"show-overflow-tooltip\":\"\"},scopedSlots:_vm._u([{key:\"header\",fn:function(){return [_c('div',[_c('span',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.needRequired(colField)),expression:\"needRequired(colField)\"}],staticClass:\"red-star\"},[_vm._v(\"*\")]),_vm._v(\" \"+_vm._s(colField.realDisplayName)+\" \")])]},proxy:true},{key:\"default\",fn:function(scope){return [_c('el-tooltip',{attrs:{\"effect\":\"light\",\"placement\":\"top-start\",\"popper-class\":\"kyc-multi-group-tooltip\",\"arrow-offset\":40,\"content\":scope.row[colIndex].multiFieldVerifyErrorMessage,\"disabled\":!scope.row[colIndex].isMultiFieldVerifyError}},[_c('kyc-field-item',{ref:_vm.getFieldPropPath(scope, colIndex),refInFor:true,attrs:{\"item\":_vm.getFieldItem(scope, colIndex),\"colIndex\":colIndex,\"isMultiGroupField\":true,\"groupEditDisabled\":_vm.groupEditDisabled,\"groupId\":_vm.groupId},on:{\"first-column-valid\":function($event){return _vm.handleFirstColumnValid(scope.row)},\"first-column-invalid\":function($event){return _vm.handleFirstColumnInvalid(scope.row)}}})],1)]}}],null,true)})}),(_vm.displayAddDeleteBtn)?_c('el-table-column',{attrs:{\"label\":\"Operation\",\"fixed\":\"right\",\"align\":\"left\",\"width\":\"100px\"},scopedSlots:_vm._u([{key:\"default\",fn:function(scope){return (scope.$index !== 0)?[_c('el-button',{staticClass:\"operation-button\",attrs:{\"size\":\"small\",\"type\":\"text\"},on:{\"click\":function($event){return _vm.deleteRow(scope.$index)}}},[_vm._v(\"Delete\")])]:undefined}}],null,true)}):_vm._e()],2)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"array-kyc-group\">\n    <el-button v-if=\"displayAddDeleteBtn\" class=\"add_button\" size=\"small\" @click=\"addRow\">{{\n      addButtonText\n    }}</el-button>\n    <el-table ref=\"multiGroupTable\" :data=\"item.fieldValues\" class=\"multi_table\" border>\n      <el-table-column\n        v-for=\"(colField, colIndex) in kycFields\"\n        :key=\"colField.fieldId\"\n        :minWidth=\"30\"\n        align=\"left\"\n        show-overflow-tooltip\n      >\n        <template #header>\n          <div>\n            <!-- 多值kyc的必选*号，除开配置项外，还受 basic product、trust level、字段间的特殊关联关系影响 -->\n            <span v-show=\"needRequired(colField)\" class=\"red-star\">*</span>\n            {{ colField.realDisplayName }}\n          </div>\n        </template>\n        <template slot-scope=\"scope\">\n          <el-tooltip\n            effect=\"light\"\n            placement=\"top-start\"\n            popper-class=\"kyc-multi-group-tooltip\"\n            :arrow-offset=\"40\"\n            :content=\"scope.row[colIndex].multiFieldVerifyErrorMessage\"\n            :disabled=\"!scope.row[colIndex].isMultiFieldVerifyError\"\n          >\n            <kyc-field-item\n              :item=\"getFieldItem(scope, colIndex)\"\n              :ref=\"getFieldPropPath(scope, colIndex)\"\n              :colIndex=\"colIndex\"\n              :isMultiGroupField=\"true\"\n              :groupEditDisabled=\"groupEditDisabled\"\n              :groupId=\"groupId\"\n              @first-column-valid=\"handleFirstColumnValid(scope.row)\"\n              @first-column-invalid=\"handleFirstColumnInvalid(scope.row)\"\n            />\n          </el-tooltip>\n        </template>\n      </el-table-column>\n      <el-table-column v-if=\"displayAddDeleteBtn\" label=\"Operation\" fixed=\"right\" align=\"left\" width=\"100px\">\n        <template slot-scope=\"scope\" v-if=\"scope.$index !== 0\">\n          <el-button size=\"small\" type=\"text\" class=\"operation-button\" @click=\"deleteRow(scope.$index)\"\n            >Delete</el-button\n          >\n        </template>\n      </el-table-column>\n    </el-table>\n  </div>\n</template>\n\n<script>\nimport KycFieldItem from './kyc-field-item.vue';\nimport { ADD_BUTTON_TEXT } from './utils';\nimport { cloneDeep } from 'lodash';\n\nexport default {\n  name: 'ArrayKycGroup',\n  components: { KycFieldItem },\n  props: {\n    item: {\n      type: Object,\n      default() {\n        return {};\n      },\n    },\n  },\n  inject: ['kycForm'],\n  computed: {\n    isViewMode() {\n      return this.kycForm.isViewMode;\n    },\n    mode() {\n      return this.kycForm.mode;\n    },\n    allBasicProductMandatory() {\n      return this.kycForm.basicProductMandatory;\n    },\n    allTrustLevelMandatory() {\n      return this.kycForm.trustLevelMandatory;\n    },\n    // 预制的表格每一列所需全部数据\n    kycFields() {\n      return this.item.kycFields || [];\n    },\n    groupId() {\n      return this.item.groupId;\n    },\n    groupEnable() {\n      return this.item.groupEnable;\n    },\n    groupEditDisabled() {\n      return this.mode === 'edit' && !this.groupEnable;\n    },\n    displayAddDeleteBtn() {\n      return !this.isViewMode && !this.groupEditDisabled;\n    },\n    // ID Details Group\n    isIDDetailsGroup() {\n      return this.groupId === 100;\n    },\n    // Certificate Details Group\n    isCertificateDetailsGroup() {\n      return this.groupId === 200;\n    },\n    addButtonText() {\n      return 'Add' + `${ADD_BUTTON_TEXT[this.groupId] ? ` ${ADD_BUTTON_TEXT[this.groupId]}` : ''}`;\n    },\n    validFieldValuesLength() {\n      return this.item.fieldValues.filter((item) => item[0].fieldValue).length;\n    },\n  },\n  watch: {\n    isViewMode(newValue, oldValue) {\n      // 进入编辑模式\n      if (['edit', 'workflowDiff', 'workflowEdit'].includes(this.mode) && newValue === false && oldValue === true) {\n        if (!this.item.fieldValues.length) {\n          return;\n        }\n        let firstRow = this.item.fieldValues[0];\n        let firstColField = firstRow[0];\n        if (this.isIDDetailsGroup || this.isCertificateDetailsGroup) {\n          // 触发 多值kyc 的 特殊关联逻辑\n          this.handleMultiGroupSpecialRelevancy(firstRow, !!firstColField.fieldValue, true);\n        }\n      }\n    },\n  },\n  methods: {\n    needRequired(field) {\n      const { mandatory, multiRelevancyMandatory, fieldId } = field;\n      const { allBasicProductMandatory, allTrustLevelMandatory, isViewMode } = this;\n      // 判断当前field是否受 basic product 影响\n      const isBasicProductMandatory = this.getIsBasicProductMandatory(allBasicProductMandatory, fieldId);\n      // 判断当前field是否受 trust level 影响\n      const isTrustLevelMandatory = allTrustLevelMandatory.includes(fieldId);\n      // 1. 兼容product、trust level决定的必选逻辑\n      let compositeMandatory = null;\n      if (allBasicProductMandatory.length || allTrustLevelMandatory.length) {\n        compositeMandatory = isBasicProductMandatory || isTrustLevelMandatory;\n      } else {\n        compositeMandatory = mandatory === 'true';\n      }\n      // 2. 兼容多值kyc特殊的关联逻辑\n      return (compositeMandatory || multiRelevancyMandatory) && !isViewMode;\n    },\n    getIsBasicProductMandatory(allBasicProductMandatory, fieldId) {\n      let item = allBasicProductMandatory[0];\n      if (Object.prototype.toString.call(item).slice(8, -1) === 'Object') {\n        // 2023.01.10\n        // 当前 mandatoryKycFieldIds 字段只包含 fieldId，没有考虑不同kyc 组中会出现项目 field 的情况（group实体创建时发现了这个问题）\n        // mandatoryKycFieldList 字段就是为了解决这个问题加的\n        let hasIndex = allBasicProductMandatory.findIndex(\n          (item) => item.kycGroupID === this.groupId && item.kycFieldID === fieldId\n        );\n        return hasIndex === -1 ? false : true;\n      } else {\n        // 如果 kyc 当前受 basic product 影响\n        return allBasicProductMandatory.includes(fieldId);\n      }\n    },\n    getFieldItem(scope, colIndex) {\n      const fieldData = scope.row[colIndex];\n      const rowIndex = scope.$index;\n      const propPath = `${this.groupId}.fieldValues.${rowIndex}.${colIndex}.fieldValue`;\n      fieldData.propPath = propPath;\n      return fieldData;\n    },\n    getFieldPropPath(scope, colIndex) {\n      const fieldData = scope.row[colIndex];\n      return fieldData['propPath'];\n    },\n    async addRow() {\n      // 多值kyc添加新的一行数据时，需要满足：\n      // 1、没有空的行\n      if (this.hasEmptyRow()) {\n        return;\n      }\n      // 2、已有行中的必填字段必须填写\n      const validateResultOK = await this.validateRowsMandatory();\n      if (!validateResultOK) {\n        return;\n      }\n      this.item.fieldValues.push(cloneDeep(this.item.kycFields));\n    },\n    hasEmptyRow() {\n      let result = false;\n      this.item.fieldValues.forEach((row) => {\n        result = !row.some((field) => field.fieldValue);\n      });\n      return result;\n    },\n    validateRowsMandatory() {\n      return new Promise((reselve) => {\n        let result = false;\n        const mandatoryPropPathList = [];\n        const mandatoryIndexList = [];\n        // 1、从列信息中找到必填的列序号\n        this.item.kycFields.forEach((col, index) => {\n          const { mandatory, multiRelevancyMandatory } = col;\n          if (mandatory === 'true' || multiRelevancyMandatory) {\n            mandatoryIndexList.push(index);\n          }\n        });\n        // 2、找到所有行中，需要检验字段的propPath\n        this.item.fieldValues.forEach((row) => {\n          row.forEach((field, index) => {\n            if (mandatoryIndexList.includes(index)) {\n              mandatoryPropPathList.push(field.propPath);\n            }\n          });\n        });\n        if (mandatoryPropPathList.length) {\n          // 3、校验所有必填项\n          mandatoryPropPathList.forEach((propPath) => {\n            this.kycForm.validateField(propPath);\n          });\n          // 4、拿到所有必填字段的校验结果\n          const valids = mandatoryPropPathList\n            .map((propPath) => {\n              if (this.$refs[propPath][0]) {\n                return this.$refs[propPath][0].fieldFormItem.validateState;\n              } else {\n                return null;\n              }\n            })\n            .filter((res) => res);\n          if (valids.includes('error')) {\n            // 现有字段值，存在未校验通过的\n            result = false;\n          } else {\n            result = true;\n          }\n        } else {\n          result = true;\n        }\n        reselve(result);\n      });\n    },\n    deleteRow(index) {\n      this.$confirm('Are you sure to delete it?', 'Confirm', {\n        confirmButtonText: 'Yes',\n        cancelButtonText: 'No',\n        type: 'warning',\n        closeOnClickModal: false,\n      })\n        .then(() => {\n          this.item.fieldValues.splice(index, 1);\n        })\n        .catch(() => {});\n    },\n    // 处理多值kyc表格第一列的交互\n    // 第一列 有效值\n    handleFirstColumnValid(row) {\n      row.forEach((field, index) => {\n        if (index !== 0) {\n          field.multiDisabled = false;\n        }\n      });\n      this.handleMultiGroupSpecialRelevancy(row, true);\n    },\n    // 处理多值kyc表格第一列的交互\n    // 第一列 无效值\n    handleFirstColumnInvalid(row) {\n      row.forEach((item, index) => {\n        if (index !== 0) {\n          item.multiDisabled = true;\n          item.fieldValue = null;\n        }\n      });\n      this.handleMultiGroupSpecialRelevancy(row, false);\n    },\n\n    /**\n     * 处理KYC组特殊的关联逻辑\n     * @param {Array} row 多值kyc一行的数据\n     * @param {Boolean} FirstColumnValid 当前行的第一列是否是有效值\n     * @param {Boolean} editInit edit 时，初始化特殊多值kyc的关联必选逻辑\n     */\n    handleMultiGroupSpecialRelevancy(row, FirstColumnValid, editInit) {\n      if (this.isIDDetailsGroup) {\n        // 处理 ID Details 特殊关联逻辑\n        this.handleIDDetailKYCGroup(row, FirstColumnValid, editInit);\n      }\n      if (this.isCertificateDetailsGroup) {\n        // 处理 Certificate Details 特殊关联逻辑\n        this.handleCertificateDetailsKYCGroup(row, FirstColumnValid, editInit);\n      }\n    },\n\n    /**\n     * 处理 ID Detail KYC 中 field 的特殊关联逻辑\n     * ID Type 有效时， ID Number 变成必选项；ID Type 无效时，ID Number 变成非必填\n     * @param {Array} row\n     * @param {Boolean} valid 多值kyc第一列是否有效\n     * @param {Boolean} editInit edit 时，初始化特殊多值kyc的关联必选逻辑\n     */\n    handleIDDetailKYCGroup(row, valid, editInit) {\n      let IDNumberField = row.find((field) => field.fieldId === 103);\n      let IDNumberFieldColumn = this.kycFields.find((colField) => colField.fieldId === 103);\n      if (valid) {\n        this.$set(IDNumberField, 'multiRelevancyMandatory', true); // 校验规则处理\n        if (this.validFieldValuesLength === 1 || editInit) {\n          // 加入第一行有效数据时，需要处理关联的必选逻辑\n          this.$set(IDNumberFieldColumn, 'multiRelevancyMandatory', true); // 添加 * 号\n        }\n      } else {\n        this.$set(IDNumberField, 'multiRelevancyMandatory', false); // 清空校验相关\n        this.$set(IDNumberField, 'isMultiFieldVerifyError', false);\n        this.$set(IDNumberField, 'multiFieldVerifyErrorMessage', '');\n        if (this.validFieldValuesLength === 0) {\n          // 没有有效数据，需要处理关联的必选逻辑\n          this.$set(IDNumberFieldColumn, 'multiRelevancyMandatory', false);\n        }\n      }\n    },\n\n    /**\n     * 处理 Certificate Details KYC 中 field 的特殊关联逻辑\n     * Certificate Type 有效时， 其余 fieldType'输入框' 变成必选项； Certificate Type 无效时，其余 fieldType'输入框' 变成非必填\n     * @param {Array} row\n     * @param {Boolean} valid 多值kyc第一列是否有效\n     * @param {Boolean} editInit edit 时，初始化特殊多值kyc的关联必选逻辑\n     */\n    handleCertificateDetailsKYCGroup(row, valid, editInit) {\n      let inputFields = row.filter((field) => field.fieldType === '00');\n      let inputFieldColumns = this.kycFields.filter((colField) => colField.fieldType === '00');\n      if (valid) {\n        inputFields.forEach((field) => {\n          this.$set(field, 'multiRelevancyMandatory', true); // 校验规则处理\n        });\n        if (this.validFieldValuesLength === 1 || editInit) {\n          // 加入第一行有效数据时，需要处理关联的必选逻辑\n          inputFieldColumns.forEach((fieldCol) => {\n            this.$set(fieldCol, 'multiRelevancyMandatory', true); // 添加 * 号\n          });\n        }\n      } else {\n        inputFields.forEach((field) => {\n          this.$set(field, 'multiRelevancyMandatory', false); // 清空校验相关\n          this.$set(field, 'isMultiFieldVerifyError', false);\n          this.$set(field, 'multiFieldVerifyErrorMessage', '');\n        });\n        if (this.validFieldValuesLength === 0) {\n          // 没有有效数据，需要处理关联的必选逻辑\n          inputFieldColumns.forEach((fieldCol) => {\n            this.$set(fieldCol, 'multiRelevancyMandatory', false); // 添加 * 号\n          });\n        }\n      }\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\">\n.kyc-multi-group-tooltip {\n  padding: 5px;\n  border-color: $--fill_color--dark !important;\n  line-height: 14px !important;\n  color: $--status_color--error !important;\n  background-color: $--text_color--white !important;\n  .popper__arrow {\n    border-top-color: $--fill_color--dark !important;\n  }\n}\n</style>\n\n<style lang=\"scss\" scoped>\n.array-kyc-group {\n  margin-bottom: 20px;\n  .add_button {\n    color: $--primary_color;\n    border-color: $--primary_color;\n    margin-top: 20px;\n  }\n\n  .multi_table {\n    margin-top: 20px;\n  }\n\n  /deep/ .el-table td.el-table__cell {\n    div {\n      align-items: center;\n      width: 100%;\n    }\n    .el-form-item__error {\n      display: none !important;\n    }\n  }\n  /deep/ .el-table td.el-table__cell .el-date-editor.el-input,\n  /deep/ .el-table td.el-table__cell .el-date-editor.el-input__inner {\n    width: 100%;\n  }\n  /deep/ .el-table__body tr.hover-row > td.el-table__cell {\n    background-color: $--text_color--white;\n  }\n}\n.red-star {\n  color: $--status_color--error;\n  font-size: 22px;\n  position: relative;\n  top: 6px;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./array-kyc-group.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./array-kyc-group.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./array-kyc-group.vue?vue&type=template&id=498d0dda&scoped=true&\"\nimport script from \"./array-kyc-group.vue?vue&type=script&lang=js&\"\nexport * from \"./array-kyc-group.vue?vue&type=script&lang=js&\"\nimport style0 from \"./array-kyc-group.vue?vue&type=style&index=0&id=498d0dda&prod&lang=scss&\"\nimport style1 from \"./array-kyc-group.vue?vue&type=style&index=1&id=498d0dda&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"498d0dda\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div class=\"kyc-group--item\">\n    <kyc-group-label :label=\"item.realDisplayName\" />\n    <array-kyc-group v-if=\"isMultiKYCGroupType(item.groupId)\" :item=\"item\" />\n    <simple-kyc-group v-else :item=\"item\" />\n  </div>\n</template>\n\n<script>\nimport KycGroupLabel from './kyc-group-label.vue';\nimport SimpleKycGroup from './simple-kyc-group.vue';\nimport ArrayKycGroup from './array-kyc-group.vue';\nimport { isMultiKYCGroupType } from './utils';\nexport default {\n  name: 'KycGroupItem',\n  components: { KycGroupLabel, SimpleKycGroup, ArrayKycGroup },\n  props: {\n    item: {\n      type: Object,\n      default() {\n        return {};\n      },\n    },\n  },\n  methods: {\n    isMultiKYCGroupType,\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.kyc-group--item {\n  /deep/ .kycGroupLabel {\n    font-size: 14px;\n    line-height: 16px;\n    font-family: 'HuaweiSans-Medium';\n    color: $--text_color--strong;\n    padding-left: 8px;\n    border-left: 2px solid $--primary_color;\n    display: inline-block;\n  }\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./kyc-group-item.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./kyc-group-item.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./kyc-group-item.vue?vue&type=template&id=abe19e22&scoped=true&\"\nimport script from \"./kyc-group-item.vue?vue&type=script&lang=js&\"\nexport * from \"./kyc-group-item.vue?vue&type=script&lang=js&\"\nimport style0 from \"./kyc-group-item.vue?vue&type=style&index=0&id=abe19e22&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"abe19e22\",\n  null\n  \n)\n\nexport default component.exports","<template>\n  <div class=\"common-kyc-form\" v-loading=\"initLoading\">\n    <el-button\n      class=\"edit-button portal-operation-button\"\n      v-if=\"isEditMode && !editing && showEditButton\"\n      size=\"small\"\n      :loading=\"editClickLoading\"\n      @click=\"handleEditButtonClick\"\n      icon=\"el-icon-edit\"\n      >Edit</el-button\n    >\n    <!-- trust level info -->\n    <template v-if=\"ableEditTrustLevel && isEditingMode\">\n      <el-form\n        class=\"trust-level-form\"\n        ref=\"innerTrustLevelForm\"\n        key=\"innerTrustLevelForm\"\n        size=\"small\"\n        label-position=\"top\"\n        :model=\"trustLevelFormData\"\n        :rules=\"TRUST_LEVEL_FORM_RULES\"\n      >\n        <el-row :gutter=\"20\">\n          <el-col :span=\"8\">\n            <el-form-item label=\"Trust Level\" prop=\"trustLevel\">\n              <el-select v-model=\"trustLevelFormData.trustLevel\" @change=\"handleTrustLevelSelectChange\">\n                <el-option\n                  v-for=\"item in trustLevelList\"\n                  :key=\"item.trustLevelId\"\n                  :label=\"item.trustLevelName\"\n                  :value=\"item.trustLevelId\"\n                ></el-option>\n              </el-select>\n            </el-form-item>\n          </el-col>\n        </el-row>\n      </el-form>\n      <el-divider class=\"trust-level-container-divider\"></el-divider>\n    </template>\n    <!-- kyc info -->\n    <el-form\n      ref=\"innerKycForm\"\n      key=\"innerKycForm\"\n      size=\"small\"\n      label-position=\"top\"\n      :model=\"formData\"\n      :validate-on-rule-change=\"false\"\n      @validate=\"handleValidate\"\n    >\n      <kyc-group-item v-for=\"kycGroupItem in kycGroupList\" :key=\"kycGroupItem.groupId\" :item=\"kycGroupItem\" />\n    </el-form>\n    <!-- update remark info -->\n    <template v-if=\"isEditingMode\">\n      <el-form\n        class=\"remark-form\"\n        ref=\"remarkForm\"\n        key=\"remarkForm\"\n        size=\"small\"\n        label-position=\"top\"\n        :model=\"remarkFormData\"\n        :rules=\"REMARK_FORM_RULES\"\n      >\n        <el-form-item label=\"Remark\" prop=\"remark\">\n          <el-input v-model=\"remarkFormData.remark\" type=\"textarea\" placeholder=\"Please Enter\" :rows=\"4\"></el-input>\n        </el-form-item>\n      </el-form>\n      <div class=\"edit-button-list\">\n        <el-button size=\"small\" @click=\"handleEditResetClick\">Cancel</el-button>\n        <el-button type=\"primary\" size=\"small\" :loading=\"submitBtnLoading\" @click=\"handleEditSubmitClick\"\n          >Submit</el-button\n        >\n      </div>\n    </template>\n  </div>\n</template>\n\n<script>\nimport KycGroupItem from '@/components/kyc-common/kyc-group-item.vue';\nimport {\n  dealIdentityKYCConfig,\n  convertKYCConfig2FormData,\n  convertKYCDetail2FormData,\n  convertKYCEditInfo2FormData,\n  convertKYC2RequestParams,\n  MULTI_GROUP_ID_ARRAY,\n  getMultiRecordIdMap,\n  getMandatoryFieldId,\n  addKYCEchoData,\n  KYC_RULE_EXT_KEY,\n  equalSubmitAndInitEdit,\n} from '../utils';\nimport { TRUST_LEVEL_FORM_RULES, REMARK_FORM_RULES } from '../validator';\nimport KYC_API from './kyc-api.js';\nimport { cloneDeep, get } from 'lodash';\n\nexport default {\n  name: 'KycForm',\n  components: { KycGroupItem },\n  props: {\n    kycInfo: {\n      // 组件外用来承接 kyc 数据的接口\n      type: Object,\n      default: () => ({}),\n    },\n    identityType: [Number, String], // 实体type，用来查询实体的kyc配置\n    identityId: [Number, String], // 实体实例id\n    identityClassify: {\n      type: String,\n      default: 'customer',\n      validator: function (value) {\n        return ['customer', 'spOper', 'org', 'orgOper', 'group', 'bank'].includes(value);\n      },\n    },\n    mode: {\n      // 组件模式，不同场景[创建、编辑、详情、检查]使用不同的模式[create、edit、detail、review]\n      // workflow 业务有 对比修改前后两份 kyc 数据 的需求，添加 workflowDiff|workflowEdit 模式进行兼容。\n      type: String,\n      default: 'create',\n      validator: function (value) {\n        return ['create', 'edit', 'detail', 'review', 'workflowDiff', 'workflowEdit'].includes(value);\n      },\n    },\n    showEditButton: {\n      type: Boolean,\n      default: true,\n    },\n    reviewKycData: {\n      // 可直接预览展示的 kyc 数据\n      type: Object,\n      default: () => ({}),\n    },\n    adaptiveLayout: {\n      // kyc form 内部是否启用自适应布局\n      type: Boolean,\n      default: false,\n    },\n    // customer、organization、group 三个实体创建时KYC的必选项会受选择的 basic product 影响\n    basicProductId: [Number, String],\n    incomingData: {\n      // 支持外部传入一个自定义对象，用来兼容业务需要的数据\n      type: Object,\n      default: () => ({}),\n    },\n    roleIds: {\n      type: Array,\n      default: () => [],\n    },\n    // 更新时是否是修改自己的kyc\n    isSelfOrgOper: {\n      type: Boolean,\n      default: false,\n    },\n    // 创建时，需要回显kyc的数据\n    isDataEcho: {\n      type: Boolean,\n      default: false,\n    },\n  },\n  provide() {\n    return {\n      mode: this.mode,\n      kycForm: this,\n    };\n  },\n  data() {\n    return {\n      TRUST_LEVEL_FORM_RULES,\n      REMARK_FORM_RULES,\n      initLoading: false,\n\n      formData: {}, // 编辑的kyc数据\n      identityKYCDetail: {}, // 实体实例的 detail 数据\n      identityKYCEditInfo: {}, // 实体实例可编辑的 kyc 数据\n      multiRecordIdMap: {},\n\n      basicProductMandatory: [], // basic Product 关联的必选fieldId，用于create\n      trustLevelMandatory: [], // trust level 关联的必选fieldId，用于edit\n\n      editing: false, // 正在编辑\n      editClickLoading: false,\n      workflowEditLoading: false, // workflow编辑时传入的数据会更改，需要获取一个字段来判断以免编辑的数据出问题\n      trustLevelFormData: {\n        // trust level 表单数据\n        trustLevel: '',\n      },\n      trustLevelList: [], // trust level的可选数据\n      remarkFormData: {\n        // 编辑时的提交备注\n        remark: '',\n      },\n      submitBtnLoading: false,\n\n      kycRuleExtList: [], // kyc field 的额外校验配置\n    };\n  },\n  computed: {\n    kycGroupList() {\n      // kyc group 渲染配置\n      const groups = Object.values(this.formData);\n      groups.sort((prev, next) => prev.displayOrder - next.displayOrder);\n      return groups;\n    },\n    // 没有权限的groupId列表\n    groupDisableIdList() {\n      return this.kycGroupList.filter((group) => !group.groupEnable).map((item) => item.groupId);\n    },\n    isCreateMode() {\n      return this.mode === 'create';\n    },\n    isDetailMode() {\n      return this.mode === 'detail';\n    },\n    isEditMode() {\n      return ['edit', 'workflowEdit'].includes(this.mode);\n    },\n    isReviewMode() {\n      return this.mode === 'review';\n    },\n    isWorkflowDiffMode() {\n      return this.mode === 'workflowDiff';\n    },\n    isCreateOrEditMode() {\n      return ['create', 'edit'].includes(this.mode);\n    },\n    isEditOrDetailMode() {\n      return ['edit', 'detail'].includes(this.mode);\n    },\n    // eidt 模式下，未编辑\n    isEditReviewMode() {\n      return this.isEditMode && !this.editing;\n    },\n    // eidt 模式下，编辑中\n    isEditingMode() {\n      return this.isEditMode && this.editing;\n    },\n    isViewMode() {\n      return ['detail', 'review'].includes(this.mode) || this.isEditReviewMode || this.isWorkflowDiffMode;\n    },\n    ableEditTrustLevel() {\n      return ['customer', 'org', 'group'].includes(this.identityClassify);\n    },\n    // 需要数据回显\n    needKYCDataEcho() {\n      return this.incomingData['kycDataEcho'] && this.isDataEcho;\n    },\n    // 获取实体kyc配置\n    getIdentityKYCConfigApi() {\n      switch (this.identityClassify) {\n        case 'customer':\n          return KYC_API.getCustomerKYCConfig;\n        case 'org':\n          return KYC_API.getOrgKYCConfig;\n        case 'spOper':\n          return KYC_API.getSpOperatorKYCConfig;\n        case 'orgOper':\n          return KYC_API.getOrgOperatorKYCConfig;\n        case 'group':\n          return KYC_API.getGroupKYCConfig;\n        case 'bank':\n          return KYC_API.getBankKYCConfig;\n        default:\n          return KYC_API.getCustomerKYCConfig;\n      }\n    },\n    getIdentityKYCDetailApi() {\n      switch (this.identityClassify) {\n        case 'customer':\n          return KYC_API.getCustomerKYCDetail;\n        case 'org':\n          return KYC_API.getOrgKYCDetail;\n        case 'spOper':\n          return KYC_API.getSpOperatorKYCDetail;\n        case 'orgOper':\n          return KYC_API.getOrgOperatorKYCDetail;\n        case 'group':\n          return KYC_API.getGroupKYCDetail;\n        case 'bank':\n          return KYC_API.getBankKYCDetail;\n        default:\n          return KYC_API.getCustomerKYCDetail;\n      }\n    },\n    getIdentityKYCEditApi() {\n      switch (this.identityClassify) {\n        case 'customer':\n          return KYC_API.getCustomerKYCEditInfo;\n        case 'orgOper':\n          return KYC_API.getOrgOperatorKYCEditInfo;\n        case 'org':\n          return KYC_API.getOrgKYCEditInfo;\n        case 'group':\n          return KYC_API.getGroupKYCEditInfo;\n        default:\n          return KYC_API.getCustomerKYCEditInfo;\n      }\n    },\n    // productID改变时\n    changeBasicProduct() {\n      switch (this.identityClassify) {\n        case 'customer':\n          return KYC_API.changeBasicProduct;\n        case 'org':\n          return KYC_API.changeOrgBasicProduct;\n        case 'spOper':\n          return KYC_API.getSpOperatorKYCConfig;\n        case 'orgOper':\n          return KYC_API.getOrgOperatorKYCConfig;\n        case 'group':\n          return KYC_API.getGroupKYCConfigOnChangeBasicProduct;\n        default:\n          return KYC_API.changeBasicProduct;\n      }\n    },\n    checkTrustLevelChangeFuc() {\n      switch (this.identityClassify) {\n        case 'customer':\n          return KYC_API.checkTrustLevelChange;\n        case 'org':\n          return KYC_API.checkOrgTrustLevelChange;\n        case 'orgOper':\n          return KYC_API.checkOrgOperatorTrustLevelChange;\n        case 'group':\n          return KYC_API.checkGroupTrustLevelChange;\n        default:\n          return KYC_API.checkTrustLevelChange;\n      }\n    },\n    detailParams() {\n      switch (this.identityClassify) {\n        case 'customer':\n          return {\n            identityId: this.identityId,\n            customerId: this.identityId,\n          };\n        case 'spOper':\n          return this.identityId;\n        case 'bank':\n          return this.identityId;\n        case 'org':\n          return {\n            identityId: this.identityId,\n            identitySubType: this.identityType,\n          };\n        case 'orgOper':\n          return {\n            identityId: this.identityId,\n          };\n        default:\n          return {\n            identityId: this.identityId,\n            customerId: this.identityId,\n          };\n      }\n    },\n    // 更新实体的KYC调用的接口\n    updateKYCAPI() {\n      switch (this.identityClassify) {\n        case 'customer':\n          return KYC_API.updateIdentityKYC;\n        case 'org':\n          return KYC_API.updateOrgIdentityKYC;\n        case 'spOper':\n          return KYC_API.getSpOperatorKYCConfig;\n        case 'orgOper':\n          return KYC_API.updateOrgOperatorKYCConfig;\n        case 'group':\n          return KYC_API.updateGroupIdentityKYC;\n        default:\n          return KYC_API.updateIdentityKYC;\n      }\n    },\n  },\n  watch: {\n    // 向组件外同步kyc数据\n    formData: {\n      handler(value) {\n        if (value && this.isCreateOrEditMode) {\n          this.$emit('update:kycInfo', cloneDeep(value));\n        }\n      },\n      deep: true,\n    },\n    // 展示详情时，获取表单数据\n    identityKYCDetail: {\n      handler(value) {\n        if (value && this.isEditOrDetailMode) {\n          this.formData = cloneDeep(value);\n        }\n      },\n      deep: true,\n    },\n    // 编辑kyc时，获取表单数据\n    identityKYCEditInfo: {\n      handler(value) {\n        if (value && this.isEditMode) {\n          this.formData = cloneDeep(value);\n          setTimeout(() => {\n            // 6. 保存编辑前的 请求参数，用于 submit 时diff出 kyc是否有变化\n            this.originEditKYCData = this.getKYCRequestParams('update');\n          }, 0);\n        }\n      },\n      deep: true,\n    },\n    // 创建流程的review阶段，获取外部的review数据\n    reviewKycData: {\n      handler(value) {\n        if (this.isReviewMode) {\n          this.formData = cloneDeep(value);\n        }\n      },\n      deep: true,\n    },\n    // 创建时，外部传入的 basic product 发生变化\n    basicProductId(value) {\n      if (this.isCreateMode) {\n        if (value) {\n          this.getBasicProductMandatory();\n        } else {\n          this.basicProductMandatory = [];\n        }\n      }\n    },\n    roleIds(value) {\n      if (this.isCreateMode) {\n        if (value) {\n          this.getKYCConfig();\n        } else {\n          this.roleIds = [];\n        }\n      }\n    },\n    // 监听外部传入的数据变化\n    'incomingData.diffKYCData': {\n      handler(value) {\n        this.formData = convertKYCDetail2FormData(cloneDeep(value) || {});\n      },\n      deep: true,\n    },\n  },\n  async created() {\n    this.initLoading = true;\n    if (this.isCreateMode) {\n      // 获取实体 kyc 配置\n      await this.getKYCConfig();\n    } else if (this.isEditOrDetailMode) {\n      // 获取实体实例 kyc detail 数据\n      await this.getKYCDetail();\n    } else if (this.isWorkflowDiffMode) {\n      // sp portal workflow kyc对比需求\n      this.formData = convertKYCDetail2FormData(this.incomingData.diffKYCData || {});\n    } else {\n      // 直接使用 外部数据进行 review，常见于创建步骤最后一步\n      this.formData = this.reviewKycData;\n    }\n    this.initLoading = false;\n  },\n  methods: {\n    // 查询实体 KYC配置\n    getKYCConfig() {\n      let params = {};\n      if (this.identityClassify === 'org') {\n        params.identitySubType = this.identityType;\n      }\n      if (this.identityClassify === 'orgOper') {\n        params.roleIds = this.roleIds;\n      }\n      return this.getIdentityKYCConfigApi(params)\n        .then((res) => {\n          const { header, identityKYCDataBean = {} } = res;\n          if (header && header.success) {\n            // 获取kyc field的额外字段\n            this.kycRuleExtList = identityKYCDataBean[KYC_RULE_EXT_KEY] || [];\n            delete identityKYCDataBean[KYC_RULE_EXT_KEY];\n            // 获取kyc group配置\n            let data = identityKYCDataBean;\n            data = dealIdentityKYCConfig(data);\n            if (this.needKYCDataEcho) {\n              // 需要数据回显\n              data = addKYCEchoData(data, this.incomingData['kycDataEcho']);\n            }\n            this.formData = convertKYCConfig2FormData(data);\n            this.$emit('get-kyc-config-success', identityKYCDataBean); // 创建kyc时，添加kyc配置获取成功的自定义事件\n          }\n        })\n        .catch(() => {});\n    },\n    // 获取实体实例的 KYC数据\n    getKYCDetail() {\n      return this.getIdentityKYCDetailApi(this.detailParams)\n        .then((res) => {\n          const { header, identityKYCDataBean = {} } = res;\n          if (header && header.success) {\n            // 获取kyc field的额外字段\n            this.kycRuleExtList = identityKYCDataBean[KYC_RULE_EXT_KEY] || [];\n            delete identityKYCDataBean[KYC_RULE_EXT_KEY];\n            // 获取kyc详情数据\n            this.identityKYCDetail = convertKYCDetail2FormData(identityKYCDataBean);\n            this.$emit('get-kyc-detail-success', identityKYCDataBean); // 获取实体kyc详情时，添加详情数据获取成功的自定义事件\n          }\n        })\n        .catch(() => {});\n    },\n    // 获取实体实例 可编辑的 KYC数据\n    getKYCEditInfo() {\n      let params = {\n        identityId: this.identityId,\n      };\n      this.editClickLoading = true;\n      return this.getIdentityKYCEditApi(params)\n        .then((res) => {\n          const { header, identityKYCDataBean = {}, changeTrustLevelList = [], selectTrustLevelId } = res;\n          if (header && header.success) {\n            // 0. 获取kyc field的额外字段\n            this.kycRuleExtList = identityKYCDataBean[KYC_RULE_EXT_KEY] || [];\n            delete identityKYCDataBean[KYC_RULE_EXT_KEY];\n            // 1. 处理edit的kyc数据\n            // workflow业务编辑时会传入KYCDataBean\n            this.identityKYCEditInfo = convertKYCEditInfo2FormData(\n              this.mode === 'workflowEdit' ? cloneDeep(this.incomingData.diffKYCData) : identityKYCDataBean\n            );\n            // 2. 获取trust level的可选数据\n            if (changeTrustLevelList.length) {\n              this.trustLevelList = changeTrustLevelList;\n            }\n            // 3. 设置trust level的默认选项\n            if (selectTrustLevelId) {\n              this.trustLevelFormData.trustLevel = selectTrustLevelId;\n            }\n            // 4. 设置默认trust level的field必选项\n            let defaultTrustLevel = changeTrustLevelList.find((item) => item.trustLevelId === selectTrustLevelId);\n            if (defaultTrustLevel) {\n              this.trustLevelMandatory = defaultTrustLevel.mandatoryKycFieldIds;\n            }\n            // 5. 编辑时，从接口返回的初始数据中，提取出所有多值kyc记录的recodeId，用于更新时补充recodeId\n            this.multiRecordIdMap = getMultiRecordIdMap(cloneDeep(this.identityKYCEditInfo));\n            // 点击编辑按钮后，获取编辑数据成功后，添加自定义事件\n            this.$emit('get-kyc-editInfo-success', { identityKYCDataBean, changeTrustLevelList, selectTrustLevelId });\n            return true;\n          }\n        })\n        .catch(() => {})\n        .finally(() => {\n          this.editClickLoading = false;\n        });\n    },\n    // 创建流程中，获取选择的basic product关联的必选field\n    getBasicProductMandatory() {\n      let params = {\n        basicProductId: this.basicProductId,\n      };\n      if (this.identityClassify === 'org') {\n        params.identitySubType = this.identityType;\n      }\n      this.changeBasicProduct(params).then((res) => {\n        const { header, mandatoryKycFieldIds = [], mandatoryKycFieldList = [] } = res;\n        if (header && header.success) {\n          // 2023.01.10\n          // 当前 mandatoryKycFieldIds 字段只包含 fieldId，没有考虑不同kyc 组中会出现项目 field 的情况（group实体创建时发现了这个问题）\n          // mandatoryKycFieldList 字段就是为了解决这个问题加的\n          this.basicProductMandatory = ['group'].includes(this.identityClassify)\n            ? mandatoryKycFieldList\n            : mandatoryKycFieldIds;\n        }\n      });\n    },\n    // 获取 KYC 保存时的接口参数\n    getKYCRequestParams(type) {\n      return convertKYC2RequestParams(this.formData, type, type ? this.multiRecordIdMap : null);\n    },\n    // kyc info 的表单方法\n    validate(callback) {\n      return this.$refs.innerKycForm && this.$refs.innerKycForm.validate(callback);\n    },\n    validateField(props, callback) {\n      this.$refs.innerKycForm && this.$refs.innerKycForm.validateField(props, callback);\n    },\n    resetFields() {\n      this.$refs.innerKycForm && this.$refs.innerKycForm.resetFields();\n    },\n    clearValidate() {\n      this.$refs.innerKycForm && this.$refs.innerKycForm.clearValidate();\n    },\n    // Edit 按钮点击事件\n    async handleEditButtonClick() {\n      const res = await this.getKYCEditInfo();\n      if (res) {\n        this.editing = true;\n        // 进入edit后的自定义事件\n        this.$emit('start-edit-kyc');\n        // 个人中心页kyc处于编辑状态\n        this.$store.commit('baseStore/SET_KYCFORM_CHANGE', { personalSettings: true });\n      }\n    },\n    // edit模式下， 更改 trust level 下拉选项\n    handleTrustLevelSelectChange(value) {\n      let currTrustLevel = this.trustLevelList.find((item) => item.trustLevelId === value);\n      if (currTrustLevel) {\n        this.trustLevelMandatory = currTrustLevel.mandatoryKycFieldIds;\n      }\n    },\n    // Reset 按钮点击事件\n    handleEditResetClick() {\n       this.$confirm('Are you sure to cancel the operation?', {\n        confirmButtonText: 'Confirm',\n        cancelButtonText: 'Cancel',\n        closeOnClickModal: false,\n        type: 'warning',\n      }).then(() => {\n         // 1、触发 reset\n        this.formData = this.identityKYCDetail;\n        // 2、退出 editing 状态\n        this.editing = false;\n        // 3、初始化 remark 字段\n        this.remarkFormData.remark = '';\n        // 4、清空表单校验\n        this.clearValidate();\n        if (this.mode === 'workflowEdit') {\n          this.$emit('workflow-kyc-cancel');\n        }\n        this.$emit('edit-reset-click'); // 编辑时，点击reset按钮后的 自定义事件\n        // 5、个人中心页退出编辑kyc状态\n        this.$store.commit('baseStore/SET_KYCFORM_CHANGE', { personalSettings: false });\n      });\n    },\n    // Submit 按钮点击事件\n    handleEditSubmitClick() {\n      let validateForm = [this.$refs.innerKycForm.validate()];\n      if (this.$refs.innerTrustLevelForm) {\n        validateForm.push(this.$refs.innerTrustLevelForm.validate());\n      }\n      if (this.$refs.remarkForm) {\n        validateForm.push(this.$refs.remarkForm.validate());\n      }\n      Promise.all(validateForm)\n        .then(() => {\n          if (equalSubmitAndInitEdit(cloneDeep(this.originEditKYCData), this.getKYCRequestParams('update'))) {\n            // 编辑时，没有做任何修改\n            this.$confirm('There is no modification.', 'System Info', {\n              confirmButtonText: 'Confirm',\n              type: 'warning',\n              closeOnClickModal: false,\n              showCancelButton: false,\n            })\n              .then(() => {})\n              .catch(() => {});\n          } else {\n            this.handleSubmitProcess();\n          }\n        })\n        .catch((err) => {\n          // 1、找出所有校验失败字段所属的group\n          const groupIdList = Object.keys(err).map((item) => parseInt(item.split('.')[0]));\n          const groupDisableIdList = this.groupDisableIdList.map((groupId) => parseInt(groupId));\n          // 2、编辑时，如果没有权限的group中出现校验失败的，则给出提示\n          if (this.isEditMode && groupIdList.some((groupId) => groupDisableIdList.includes(groupId))) {\n            this.$message({\n              message: 'Missing KYC permission, please check KYC data permission and try again',\n              type: 'warning',\n            });\n          }\n        });\n    },\n    // 编辑KYC保存时，需要调用的接口\n    async handleSubmitProcess() {\n      // 1、检查trust level是否发生变化\n      let checkRes = await this.checkTrustLevelChange();\n      this.$emit('edit-check-trustlevel-change', checkRes); // 编辑提交时，添加检查trsutLevel是否变化结果的自定义事件\n      if (checkRes.header && checkRes.header.success) {\n        const { change } = checkRes;\n        let canDowngrading = true;\n        if (['customer', 'org', 'group'].indexOf(this.identityClassify) > 0) {\n          canDowngrading = checkRes.canDowngrading;\n        }\n        if (canDowngrading) {\n          if (change === true) {\n            // trust level 变化\n            this.$confirm(\n              'Modifying KYC infomation will cause a trust level change. Are you sure to continue?',\n              'Confirm',\n              {\n                confirmButtonText: 'Yes',\n                cancelButtonText: 'No',\n                type: 'warning',\n                closeOnClickModal: false,\n              }\n            )\n              .then(() => {\n                // 2、更新实体KYC\n                this.updateIdentityKYC();\n              })\n              .catch(() => {});\n          } else if (change === false) {\n            // trust level 无变化\n            // 2、更新实体KYC\n            this.updateIdentityKYC();\n          }\n        } else {\n          this.$confirm('The trust level cannot be downgraded to the current level.', 'System Info', {\n            confirmButtonText: 'Confirm',\n            showCancelButton: true,\n            type: 'info',\n            closeOnClickModal: false,\n          });\n        }\n        this.$store.dispatch('tagsView/delView', this.$route);\n        if (['group'].indexOf(this.identityClassify) < 0) {\n          this.$router.push('list');\n        }\n      } else {\n        // check接口调用失败\n      }\n    },\n    // 表单触发校验后，统一的回调事件\n    // 当前用来 处理多值kyc校验结果的展示\n    handleValidate(prop, valid, error) {\n      let propArr = prop.split('.');\n      if (MULTI_GROUP_ID_ARRAY.includes(parseInt(propArr[0]))) {\n        // 多值 KYC 的校验结果\n        let path = propArr.slice(0, -1);\n        let field = get(this.formData, path);\n        this.$set(field, 'isMultiFieldVerifyError', !valid);\n        this.$set(field, 'multiFieldVerifyErrorMessage', valid ? '' : error);\n      }\n    },\n    // 编辑时，检查trust level是否发生变化\n    checkTrustLevelChange() {\n      let params = {\n        identityId: this.identityId,\n        identityKYCData: this.getKYCRequestParams(),\n      };\n      this.submitBtnLoading = true;\n      return this.checkTrustLevelChangeFuc(params).finally(() => {\n        this.submitBtnLoading = false;\n      });\n    },\n    // 更新实体的KYC\n    updateIdentityKYC() {\n      // workflow业务需要将数据传给业务侧处理\n      if (this.mode === 'workflowEdit') {\n        this.$emit('workflow-kyc-submit', this.getKYCRequestParams('update'), this.remarkFormData.remark);\n        return;\n      }\n      let params = {\n        identityId: this.identityId,\n        identityKYCData: this.getKYCRequestParams('update'),\n        reason: this.remarkFormData.remark,\n      };\n      this.submitBtnLoading = true;\n      if (this.isSelfOrgOper) {\n        params.isSelfOrgOper = true;\n      }\n      this.updateKYCAPI(params)\n        .then(async (res) => {\n          const { header } = res;\n          if (header && header.success) {\n            if (res.taskId) {\n              this.$message.success('The request must be approved by another operator.');\n            } else {\n              this.$message.success('submitted successfully.');\n            }\n            // 添加编辑时提交成功的自定义事件\n            this.$emit('edit-submit-success', res);\n            this.editing = false;\n            // 重新请求KYC详情数据\n            this.initLoading = true;\n            await this.getKYCDetail();\n            this.initLoading = false;\n            // 初始化remark字段\n            this.remarkFormData.remark = '';\n          } else {\n            // 添加编辑时提交失败的自定义事件\n            this.$emit('edit-submit-failure', res);\n          }\n        })\n        .catch((err) => {\n          // 添加编辑时提交失败的自定义事件\n          this.$emit('edit-submit-failure', err);\n        })\n        .finally(() => {\n          this.submitBtnLoading = false;\n        });\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.common-kyc-form {\n  padding-bottom: 4px;\n  .edit-button {\n    margin-bottom: 20px;\n  }\n  .trust-level-form,\n  .remark-form {\n    /deep/ .el-form-item {\n      margin-bottom: 20px;\n    }\n  }\n  .trust-level-container-divider {\n    margin: 0 0 20px 0;\n  }\n  .edit-button-list {\n    display: flex;\n    align-items: center;\n    justify-content: flex-end;\n  }\n}\n</style>\n","import mod from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=2bc19ff8&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nimport style0 from \"./index.vue?vue&type=style&index=0&id=2bc19ff8&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"2bc19ff8\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./array-kyc-group.vue?vue&type=style&index=0&id=498d0dda&prod&lang=scss&\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=style&index=0&id=2bc19ff8&prod&lang=scss&scoped=true&\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./preferred-nc-lang.vue?vue&type=style&index=0&id=5b02730f&prod&lang=scss&scoped=true&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./kyc-group-item.vue?vue&type=style&index=0&id=abe19e22&prod&lang=scss&scoped=true&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./array-kyc-group.vue?vue&type=style&index=1&id=498d0dda&prod&lang=scss&scoped=true&\"","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./simple-kyc-group.vue?vue&type=style&index=0&id=9dcbfbba&prod&lang=scss&scoped=true&\"","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./region.vue?vue&type=style&index=0&id=0a58295c&prod&lang=scss&scoped=true&\""],"sourceRoot":""}