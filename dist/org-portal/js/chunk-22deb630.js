(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-22deb630"],{b396:function(e,t,a){},d2fa:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"group-task-container"},[t("div",{staticClass:"page-header"},[t("div",{staticClass:"title"},[e._v(e._s(e.projectObj.title))]),t("div",{staticClass:"desc"},[e._v(e._s(e.projectObj.desc))])]),t("div",{staticClass:"page-content"},[t("portal-form",{ref:"searchFormRef",attrs:{searchBtnLoading:e.searchLoading,"form-config-list":e.formConfigList,formRules:e.dateValidate,"form-data":e.formData},on:{"reset-btn-click":e.resetSearch,"search-btn-click":e.search}}),t("todo-info",{ref:"todoinfo",attrs:{todoInfoList:e.todoInfoList,needDelegateBtn:!1,searchLoading:e.searchTableLoading,pageSize:e.pageSize,sortCondition:e.sortTime,type:"groupTask"},on:{"check-change":e.checkTaskChange,"handle-size-change":e.handleSizeChange,"handle-sort-conditions":e.handleSortConditions,processing:e.processing}})],1),t("div",{staticClass:"page-dialog"},[t("el-dialog",{ref:"selectTaskNameDialogRef",attrs:{title:"Select Task Name",width:"800px",visible:e.taskNameDialogVisible,"close-on-click-modal":!1,"before-close":e.closeDialog},on:{"update:visible":function(t){e.taskNameDialogVisible=t},closed:e.closeDialog}},[t("portal-form",{ref:"dialogTaskNameForm",staticClass:"dialogTaskNameForm",attrs:{formRules:e.formRules,"form-config-list":e.taskNameSearchForm.formConfigList,"form-data":e.taskNameSearchForm.formData,needOperateBtn:!0,searchBtnLoading:e.dialogTaskNameFormBtnLoading,smallAutoColumn:2,bigAutoColumn:2},on:{"search-btn-click":e.selectTaskDialogSearch,"reset-btn-click":e.selectTaskDialogReset}}),t("table-page",{ref:"taskNameTableRef",attrs:{columns:e.dialogTable.columns,getTableData:e.dialogTable.getTableData,"is-search":e.dialogTable.isSearch,"is-check":!0,isSingleCheck:!0},on:{"single-selection-change":e.dialogTable.singleChange}}),t("div",{staticClass:"dialog-pagination"},[t("portal-pagination",{ref:"taskNameDialogPageRef",attrs:{total:e.taskNameCount,pageSize:e.taskNamePageSize,hidden:e.taskNameHasData},on:{pagination:e.handleTaskNameSizeChange}})],1),t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("button",{staticClass:"cancel-button",attrs:{size:"small"},on:{click:function(t){return t.preventDefault(),e.closeDialog.apply(null,arguments)}}},[e._v(" "+e._s(this.$t("common.button.cancel"))+" ")]),t("el-button",{directives:[{name:"preventReClick",rawName:"v-preventReClick"}],attrs:{type:"primary",size:"small"},on:{click:e.comfirmTaskNameHandler}},[e._v(e._s(this.$t("common.button.confirm")))])],1)],1),t("el-dialog",{attrs:{title:"Task Processing",width:"448px",visible:e.taskProcessDialogVisible,"close-on-click-modal":!1,"before-close":e.handleCancelClick},on:{"update:visible":function(t){e.taskProcessDialogVisible=t},closed:e.handleCancelClick}},[t("portal-form",{ref:"dialogProcessForm",staticClass:"dialogProcessForm",attrs:{"form-config-list":e.taskProcessForm,"form-data":e.taskProcessFormData,"form-rules":e.processFormRules,needOperateBtn:!1,needBottomLine:!1,smallAutoColumn:1,bigAutoColumn:1}},[t("template",{slot:"operationRadio"},[t("el-form-item",{attrs:{prop:"operation",label:"Current Bank"}},[t("el-radio-group",{model:{value:e.taskProcessFormData.operation,callback:function(t){e.$set(e.taskProcessFormData,"operation",t)},expression:"taskProcessFormData.operation"}},[t("el-radio",{attrs:{label:"approve"}},[e._v("Approve")]),t("el-radio",{attrs:{label:"reject"}},[e._v("Reject")])],1)],1),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"reject"===e.taskProcessFormData.operation&&/backinitiator/.test(e.currentData.actions),expression:"taskProcessFormData.operation === 'reject' && /backinitiator/.test(currentData.actions)"}]},[t("el-checkbox",{model:{value:e.initialSubmit,callback:function(t){e.initialSubmit=t},expression:"initialSubmit"}},[e._v("Let Initiator Modify and Resubmit")])],1)],1)],2),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("button",{staticClass:"cancel-button",attrs:{size:"small"},on:{click:function(t){return t.preventDefault(),e.handleCancelClick.apply(null,arguments)}}},[e._v(" "+e._s(this.$t("common.button.cancel"))+" ")]),t("el-button",{directives:[{name:"preventReClick",rawName:"v-preventReClick"}],attrs:{type:"primary",size:"small"},on:{click:e.handleConfirmClick}},[e._v(e._s(this.$t("common.button.submit")))])],1)],1),t("el-dialog",{staticClass:"process-dialog",attrs:{title:"Task Processing",width:"448px",visible:e.processOperationDialogVisible,"close-on-click-modal":!1},on:{"update:visible":function(t){e.processOperationDialogVisible=t},closed:e.handleProcessCancelClick}},[t("el-form",{ref:"processOptForm",attrs:{rules:e.processOptFormRules,model:e.processOperationFormData,"label-position":"top"}},[t("el-form-item",{staticClass:"process-operation-radio",attrs:{prop:"operation",label:"Action"}},[t("el-radio-group",{model:{value:e.processOperationFormData.operation,callback:function(t){e.$set(e.processOperationFormData,"operation",t)},expression:"processOperationFormData.operation"}},e._l(e.processOptionLists,(function(a){return t("el-radio",{key:a.value,staticClass:"operation-radio",attrs:{label:a.value}},[e._v(" "+e._s(a.label)+" ")])})),1)],1),t("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"reject"===e.processOperationFormData.operation&&/backinitiator/.test(e.currentData.actions),expression:"processOperationFormData.operation === 'reject' && /backinitiator/.test(currentData.actions)"}],staticClass:"test-checkbox"},[t("el-checkbox",{model:{value:e.processOperationFormData.initialSubmit,callback:function(t){e.$set(e.processOperationFormData,"initialSubmit",t)},expression:"processOperationFormData.initialSubmit"}},[e._v(" Let Initiator Modify and Resubmit ")])],1),"investigate"===e.processOperationFormData.operation?t("el-form-item",{attrs:{prop:"investigateOperator",label:"Operator"}},[t("el-radio-group",{model:{value:e.processOperationFormData.investigateOperator,callback:function(t){e.$set(e.processOperationFormData,"investigateOperator",t)},expression:"processOperationFormData.investigateOperator"}},[t("el-radio",{attrs:{label:"initiator"}},[e._v("Initiator")]),t("el-radio",{attrs:{label:"others"}},[e._v("Others")])],1)],1):e._e(),"others"===e.processOperationFormData.investigateOperator&&"investigate"===e.processOperationFormData.operation?t("el-form-item",{staticClass:"org-short-code",attrs:{prop:"selectOperatorList"}},[t("div",{staticClass:"multi-select-container",class:{"err-border":e.isCheckError}},[t("div",{staticClass:"select-tags"},[t("div",{staticClass:"select-scroll"},e._l(e.selectOperatorList,(function(a,s){return t("el-tag",{key:s,attrs:{type:"info",closable:!0},on:{close:function(t){return e.removeSelecteOperator(a)}}},[e._v(" "+e._s(a.roleName||a.userName)+" ")])})),1)]),t("div",{staticClass:"icon-e"},[t("span",{staticClass:"el-icon-ellipsis",on:{click:e.openMultiCheckDilog}})])])]):e._e(),"investigate"===e.processOperationFormData.operation?t("el-form-item",{attrs:{prop:"validityPeriod",label:"Validity Period"}},[t("el-radio-group",{model:{value:e.processOperationFormData.validityPeriod,callback:function(t){e.$set(e.processOperationFormData,"validityPeriod",t)},expression:"processOperationFormData.validityPeriod"}},[t("el-radio",{attrs:{label:"sameAsOriginal"}},[e._v("Same as Original")]),t("el-radio",{attrs:{label:"customized"}},[e._v("Customized")])],1)],1):e._e(),"investigate"===e.processOperationFormData.operation&&"customized"===e.processOperationFormData.validityPeriod?t("el-row",{staticClass:"task-detail-col",attrs:{gutter:6}},[t("el-col",{attrs:{span:4}},[t("el-form-item",{attrs:{rules:e.invesCustomizedDay,prop:"customizedDay"}},[t("el-input",{attrs:{size:"small",placeholder:e.$t("TAC.taskDetail.Days")},model:{value:e.processOptionTimeForm.customizedDay,callback:function(t){e.$set(e.processOptionTimeForm,"customizedDay",t)},expression:"processOptionTimeForm.customizedDay"}})],1)],1),t("el-col",{attrs:{span:3}},[e._v(e._s(e.$t("TAC.taskDetail.Days")))]),t("el-col",{attrs:{span:4}},[t("el-form-item",{attrs:{rules:e.invesCustomizedHours,prop:"customizedHours"}},[t("el-input",{attrs:{size:"small",placeholder:e.$t("TAC.taskDetail.Hours")},model:{value:e.processOptionTimeForm.customizedHours,callback:function(t){e.$set(e.processOptionTimeForm,"customizedHours",t)},expression:"processOptionTimeForm.customizedHours"}})],1)],1),t("el-col",{attrs:{span:3}},[e._v(e._s(e.$t("TAC.taskDetail.Hours")))]),t("el-col",{attrs:{span:5}},[t("el-form-item",{attrs:{rules:e.invesCustomizedMinutes,prop:"customizedMinutes"}},[t("el-input",{attrs:{size:"small",placeholder:e.$t("TAC.taskDetail.Minutes")},model:{value:e.processOptionTimeForm.customizedMinutes,callback:function(t){e.$set(e.processOptionTimeForm,"customizedMinutes",t)},expression:"processOptionTimeForm.customizedMinutes"}})],1)],1),t("el-col",{attrs:{span:4}},[e._v(e._s(e.$t("TAC.taskDetail.Minutes")))])],1):e._e(),t("el-form-item",{attrs:{label:"Remark",prop:"remark"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.processOperationFormData.remark,callback:function(t){e.$set(e.processOperationFormData,"remark",t)},expression:"processOperationFormData.remark"}})],1)],1),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("button",{staticClass:"cancel-button",attrs:{size:"small"},on:{click:function(t){t.preventDefault(),e.processOperationDialogVisible=!1}}},[e._v(" "+e._s(this.$t("common.button.cancel"))+" ")]),t("el-button",{directives:[{name:"preventReClick",rawName:"v-preventReClick"}],attrs:{type:"primary",size:"small"},on:{click:e.handleProcessConfirmClick}},[e._v(e._s(this.$t("common.button.submit")))])],1)],1),t("portal-dialog",{ref:"selectProcessOptDialogRef",staticClass:"select-operator-dialog",attrs:{title:"Investigate Task",dialogVisible:e.selectProcessOptDialogVisible,searchForm:e.processOptSearchFrom,needSearchFormBottomLine:!0,isOverflowHeight:!0,formRules:e.formRules,dialogTable:e.selectProcessOptDialogTable,searchLoading:e.selectProcessOptSearchLoading},on:{"update:dialogVisible":function(t){e.selectProcessOptDialogVisible=t},"update:dialog-visible":function(t){e.selectProcessOptDialogVisible=t},"update:searchLoading":function(t){e.selectProcessOptSearchLoading=t},"update:search-loading":function(t){e.selectProcessOptSearchLoading=t},"close-dialog":e.selectProcessOptCloseDialog,"search-reset":e.selectProcessOptDialogReset,"cancel-btn-click":e.selectProcessOptCloseDialog,"confirm-btn-click":e.comfirmselectProcessOptHandler}},[t("template",{slot:"operation"},[t("div",{staticClass:"check-operator"},[t("div",{staticClass:"check-label"},[e._v("Select Type")]),t("el-radio-group",{on:{change:e.processCheckChange},model:{value:e.assigneeType,callback:function(t){e.assigneeType=t},expression:"assigneeType"}},[t("el-radio",{attrs:{label:"operator"}},[e._v("Operator")]),t("el-radio",{attrs:{label:"role"}},[e._v("Role")])],1)],1)])],2),t("notification-dialog",{attrs:{dialogVisible:e.notificationDialogVisible},on:{"update:dialogVisible":function(t){e.notificationDialogVisible=t},"update:dialog-visible":function(t){e.notificationDialogVisible=t}}})],1)])},i=[],o=a("3186"),r=a("e4b0"),l=a("d91c"),c=a("bc38"),n=a("4c09"),p=a("4d26"),m=a("a10b"),h=a("8e76"),d=a("5a0c"),g=a.n(d),u={name:"groupTask",components:{PortalForm:o["a"],NotificationDialog:c["a"],TodoInfo:r["a"],TablePage:n["a"],PortalDialog:l["a"],PortalPagination:p["a"]},data(){return{invesCustomizedDay:[{validator:this.customizedDayValidator,message:"Enter a value between 0 and 100.",trigger:"change"}],invesCustomizedHours:[{validator:this.customizedHoursValidator,message:"Enter a value between 0 and 23.",trigger:"change"}],invesCustomizedMinutes:[{validator:this.customizedMinutesValidator,message:"Enter a value between 0 and 59.",trigger:"change"}],notificationDialogVisible:!1,projectObj:{title:this.$t("TAC.groupTask.title"),desc:this.$t("TAC.groupTask.desc")},searchTableLoading:!1,searchLoading:!1,taskNameSearchFormData:{taskName:"",taskType:""},searchFormPriority:[{value:"",label:"All"}],searchFormTaskType:[{value:"",label:"All"}],searchFormStatus:[{value:"",label:"All"}],formData:{taskNo:"",priority:"",taskName:"",taskType:"",status:"",dueTime:"",creationTime:[]},dateValidate:Object(m["a"])(),curSelectTaskNameToTaskType:"",tempTaskName:{},sortTime:"",todoInfoList:{todoInfoLists:[],sortData:[],taskType:!1,count:0},formRules:Object(m["c"])(),pageSize:10,checkLists:[],tempTaskHandle:[],taskNameHasData:!1,taskNameCount:0,taskNamePageSize:5,taskNameDialogVisible:!1,dialogTaskNameFormBtnLoading:!1,dialogTable:{columns:[{label:this.$t("TAC.myTodo.taskName"),prop:"taskName",align:"left"},{label:this.$t("TAC.myTodo.taskType"),prop:"taskType",align:"left"}],isSearch:!1,getTableData:this.getTaskNameDialogData,singleChange:this.taskNameDialigSelectChange},taskNameSearchLoading:!1,taskProcessDialogVisible:!1,taskProcessForm:[{prop:"operation",key:"operation",slotName:"operationRadio"},{formItemClass:"remark",label:"Remark",prop:"remark",key:"remark",comp:"el-input",bind:{type:"textarea"}}],taskProcessFormData:{operation:"",remark:""},processFormRules:Object(m["b"])(),operatorRadio:null,initialSubmit:!1,pickerOptions:{onPick:({maxDate:e,minDate:t})=>{this.selectDate=t.getTime(),e&&(this.selectDate="")},disabledDate:e=>{if(""!==this.selectDate){const t=2592e6,a=this.selectDate-t,s=this.selectDate+t;return e.getTime()<a||e.getTime()>s}}},processOperationDialogVisible:!1,processOptFormRules:{operation:[{required:!0,message:"Please select at least one.",trigger:"change"}],investigateOperator:[{required:!0,message:"Please select at least one.",trigger:"change"}],validityPeriod:[{required:!0,message:"Please select at least one.",trigger:"change"}],remark:[{required:!0,message:"Please enter content.",trigger:"blur"}],selectOperatorList:[{required:!0,message:"Please select at least one.",trigger:"change",validator:this.selectOperatorListValidator}],delegateOperatorList:[{required:!0,message:"Please select at least one.",trigger:"change",validator:this.selectOperatorListValidator}]},processOperationFormData:{operation:"",remark:"",investigateOperator:"",validityPeriod:"",initialSubmit:!1},delegateOperatorList:[],selectOperatorList:[],selectProcessOptSingleCheck:!0,selectProcessOptDialogVisible:!1,processOptionTimeForm:{customizedDay:"",customizedHours:"",customizedMinutes:""},delegateSearchFromData:{operatorType:"",shortCode:"",userName:"",firstName:"",middleName:"",lastName:""},delegateRoleSearchFormConfigList:[{label:this.$t("TAC.myTodo.roleName"),key:"roleName",prop:"roleName",comp:"el-input",bind:{clearable:!0,placeholder:this.$t("common.placeholder.enter")}},{label:this.$t("TAC.myTodo.roleCategory"),key:"roleCategory",prop:"roleCategory",comp:"el-select",options:[{value:"",label:"All"},{value:"3000",label:"Organization Operator"},{value:"5000",label:"Organization"},{value:"7000",label:"Group"},{value:"8000",label:"SP"}],bind:{placeholder:this.$t("common.placeholder.select")}}],delegateRoleSearchFormData:{roleName:"",roleCategory:""},delegateDialogTable:{columns:[{label:this.$t("TAC.myTodo.userName"),prop:"userName",align:"left"},{label:this.$t("TAC.myTodo.firstName"),prop:"firstName",align:"left"},{label:this.$t("TAC.myTodo.middleName"),prop:"middleName",align:"left"},{label:this.$t("TAC.myTodo.lastName"),prop:"lastName",align:"left"}],isSearch:!1,isSingleCheck:!0,hasPagination:!0,paginationConfig:{total:0,pageIndex:1,pageSize:5},getTableData:this.getDelegateDialogData,singleChange:this.delegateDialigSelectChange},selectProcessOptDialogTable:{columns:[{label:this.$t("TAC.myTodo.userName"),prop:"userName",align:"left"},{label:this.$t("TAC.myTodo.firstName"),prop:"firstName",align:"left"},{label:this.$t("TAC.myTodo.middleName"),prop:"middleName",align:"left"},{label:this.$t("TAC.myTodo.lastName"),prop:"lastName",align:"left"}],isSearch:!1,isSingleCheck:!0,hasPagination:!0,paginationConfig:{total:0,pageIndex:1,pageSize:5},getTableData:this.getDelegateDialogData,singleChange:this.singleCheckChange,onSelectionChange:this.multiCheckChange},selectProcessOptSearchLoading:!1,tempSingleCheck:{},tempMultiCheck:[],tempDelegateTableCol:[],assigneeType:"operator",newSearchType:!1,shortCodeConfig:{label:this.$t("TAC.myTodo.orgShortCode"),formItemClass:"short-code",key:"shortCode",prop:"shortCode",comp:"el-input",bind:{clearable:!0,placeholder:this.$t("common.placeholder.enter")}},isCheckError:!1,currentData:{}}},computed:{formConfigList(){return[{label:this.$t("TAC.myTodo.taskNo"),key:"taskNo",prop:"taskNo",comp:"el-input",bind:{clearable:!0,placeholder:this.$t("common.placeholder.enter")}},{label:this.$t("TAC.myTodo.priority"),key:"priority",prop:"priority",comp:"el-select",options:this.searchFormPriority,bind:{placeholder:this.$t("common.placeholder.select")}},{formItemClass:"org-short-code",label:this.$t("TAC.myTodo.taskName"),key:"taskName",prop:"taskName",comp:"el-input",bind:{clearable:!0,placeholder:this.$t("common.placeholder.select")},slots:[{comp:"el-link",name:"append",class:"short-code-icon",bind:{icon:"el-icon-more",underline:!1},event:{click:()=>{this.taskNameDialogVisible=!0,this.taskNameSearchForm.formData.taskType=this.searchFormTaskType[0].value,this.dialogTable.isSearch=!0}}}]},{label:this.$t("TAC.myTodo.taskType"),key:"taskType",prop:"taskType",comp:"el-select",options:this.searchFormTaskType,bind:{placeholder:this.$t("common.placeholder.select")}},{label:this.$t("TAC.myTodo.status"),key:"status",prop:"status",comp:"el-select",options:this.searchFormStatus,bind:{placeholder:this.$t("common.placeholder.enter")}},{formItemClass:"due-time",label:this.$t("TAC.myTodo.dueTime"),prop:"dueTime",key:"dueTime",comp:"el-date-picker",bind:{placeholder:this.$t("common.placeholder.select"),type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss"}},{label:this.$t("TAC.myTodo.creationTime"),formItemClass:"form-special-date-box",sameGroup:!0,prop:"creationTime",comp:[{key:"creationTime",comp:"el-date-picker",bind:{placeholder:this.$t("common.placeholder.enter"),align:"right",type:"datetimerange",format:"dd/MM/yyyy HH:mm:ss","picker-options":this.pickerOptions,"range-separator":"~","value-format":"yyyy-MM-dd HH:mm:ss","default-time":["00:00:00","23:59:59"],"start-placeholder":"Please select","end-placeholder":"Please select"}},{comp:"i",class:"el-icon-date data_icon"}]}]},taskNameSearchForm(){return{formConfigList:[{label:this.$t("TAC.myTodo.taskName"),key:"taskName",prop:"taskName",comp:"el-input",bind:{clearable:!0,placeholder:this.$t("common.placeholder.enter")}},{label:this.$t("TAC.myTodo.taskType"),key:"taskType",prop:"taskType",comp:"el-select",options:this.searchFormTaskType,bind:{placeholder:this.$t("common.placeholder.select")}}],formData:this.taskNameSearchFormData}},processOptionLists(){if(this.processOperationDialogVisible){let e=["approve","complete","redo","delegate","investigate","reject"];return this.currentData.actions.split(",").filter(t=>e.includes(t)).map(e=>{if(e)return{value:e,label:e.replace(e[0],e[0].toUpperCase())}})}return[]},processOptSearchFrom(){return"operator"===this.assigneeType?{formConfigList:[{label:this.$t("TAC.myTodo.operatorType"),key:"operatorType",prop:"operatorType",comp:"el-select",options:[{value:"orgOperator",label:"Organization Operator"},{value:"spOperator",label:"SP Operator"}],bind:{placeholder:this.$t("common.placeholder.select")}},{label:this.$t("TAC.myTodo.userName"),key:"userName",prop:"userName",comp:"el-input",bind:{clearable:!0,placeholder:this.$t("common.placeholder.enter")}},{label:this.$t("TAC.myTodo.firstName"),key:"firstName",prop:"firstName",comp:"el-input",bind:{clearable:!0,placeholder:this.$t("common.placeholder.enter")}},{label:this.$t("TAC.myTodo.middleName"),key:"middleName",prop:"middleName",comp:"el-input",bind:{clearable:!0,placeholder:this.$t("common.placeholder.enter")}},{label:this.$t("TAC.myTodo.lastName"),key:"lastName",prop:"lastName",comp:"el-input",bind:{clearable:!0,placeholder:this.$t("common.placeholder.enter")}}],formData:this.delegateSearchFromData}:{formConfigList:this.delegateRoleSearchFormConfigList,formData:this.delegateRoleSearchFormData}}},created(){this.formData.creationTime=[g()(new Date(new Date(g()().year(),g()().month(),g()().date(),0,0,0).getTime()-6048e5)).format("YYYY-MM-DD HH:mm:ss"),g()(new Date(g()().year(),g()().month(),g()().date(),23,59,59)).format("YYYY-MM-DD HH:mm:ss")],Object(h["v"])({dictCodes:["CPS.WORKFLOW.CONFIGURATION.PRIORITY","CPS.TASK.TYPE","CPS.WORKFLOW.TODO.TASK.STATE","WORK_FLOW_SORT_TIME"]}).then(e=>{e.header&&e.header.success&&(this.searchFormPriority=e.dictDetailsMap["CPS.WORKFLOW.CONFIGURATION.PRIORITY"],"All"!==this.searchFormPriority[0].label&&this.searchFormPriority.unshift({label:"All",value:""}),this.searchFormTaskType=e.dictDetailsMap["CPS.TASK.TYPE"],this.searchFormStatus=e.dictDetailsMap["CPS.WORKFLOW.TODO.TASK.STATE"],"All"!==this.searchFormStatus[0].label&&this.searchFormStatus.unshift({label:"All",value:""}),this.todoInfoList.sortData=e.dictDetailsMap["WORK_FLOW_SORT_TIME"],this.sortTime="CREATE_TIME_LATEST")})},beforeRouteEnter(e,t,a){a(e=>{e.searchTableLoading=!0,e.queryGroupTaskList()})},watch:{"processOptionTimeForm.customizedHours"(e){e>23&&(this.processOptionTimeForm.customizedHours=23)},"processOptionTimeForm.customizedMinutes"(e){e>59&&(this.processOptionTimeForm.customizedMinutes=59)},formData:{handler(e){this.curSelectTaskNameToTaskType!==e.taskType&&(this.formData.taskName="")},deep:!0},selectProcessOptSingleCheck(e){this.selectProcessOptDialogTable.isSingleCheck=!!e},delegateSearchFromData:{handler(e){"orgOperator"===e.operatorType?5===this.processOptSearchFrom.formConfigList.length&&(this.newSearchType=!0,this.processOptSearchFrom.formConfigList.splice(1,0,this.shortCodeConfig)):6===this.processOptSearchFrom.formConfigList.length&&(this.newSearchType=!1,this.processOptSearchFrom.formConfigList.splice(1,1)),""!==e.shortCode&&this.$refs.selectProcessOptDialogRef.$refs.dialogSearchForm.clearValidate("shortCode")},deep:!0},newSearchType(e){this.selectProcessOptDialogTable.getTableData=e?this.getOrgDelegateDialogData:this.getDelegateDialogData}},methods:{customizedDayValidator(e,t,a){let s=1*this.processOptionTimeForm.customizedDay;s<=100&&s>=0?a():(this.$refs.processOptForm.clearValidate("customizedMinutes"),this.$refs.processOptForm.clearValidate("customizedHours"),a(new Error))},customizedHoursValidator(e,t,a){let s=1*this.processOptionTimeForm.customizedHours;s<=23&&s>=0?a():(this.$refs.processOptForm.clearValidate("customizedMinutes"),this.$refs.processOptForm.clearValidate("customizedDay"),a(new Error))},customizedMinutesValidator(e,t,a){let s=1*this.processOptionTimeForm.customizedMinutes;s<=59&&s>=0?a():(this.$refs.processOptForm.clearValidate("customizedHours"),this.$refs.processOptForm.clearValidate("customizedDay"),a(new Error))},getFutureTime(){const e=this.processOptionTimeForm.customizedDay,t=this.processOptionTimeForm.customizedHours,a=this.processOptionTimeForm.customizedMinutes,s=e?Number(e):0,i=t?Number(t):0,o=a?Number(a):0,r=24*s*60+60*i+o,l=new Date,c=l.getMinutes();return l.setMinutes(c+r),l.toLocaleString().replace(/\//g,"-")},selectOperatorListValidator(e,t,a){if(!this.selectOperatorList.length)return this.isCheckError=!0,void a(new Error);this.isCheckError=!1,a()},handleProcessCancelClick(){this.tempTaskHandle.length>0?this.checkLists=this.tempTaskHandle.splice(0):this.checkLists.splice(0),this.$refs.processOptForm.resetFields(),this.isCheckError=!1,this.processOperationDialogVisible=!1,this.processOperationFormData.operation="approve",this.processOperationFormData.remark="",this.processOperationFormData.investigateOperator="",this.processOperationFormData.validityPeriod="",this.processOperationFormData.initialSubmit=!1},handleProcessConfirmClick(){this.$refs.processOptForm.validate(e=>{if(e){this.isCheckError=!1;let e=this.checkLists.map(e=>({processId:e.processId,taskId:e.taskId})),t=this.processOperationFormData.remark,a=!1,s=this.processOperationFormData.operation,i="role"==this.assigneeType?"3":"1",o=[];const r=1440*this.processOptionTimeForm.customizedDay+60*this.processOptionTimeForm.customizedHours+1*this.processOptionTimeForm.customizedMinutes;this.delegateOperatorList.length>0&&(o=this.delegateOperatorList.map(e=>e.roleId?{roleId:e.roleId}:{operatorId:e.identityId,operatorType:i})),this.selectOperatorList.length>0&&(o=this.selectOperatorList.map(e=>e.roleId?{roleId:e.roleId}:{operatorId:e.identityId,operatorType:i}));let l={};"approve"!==s&&"complete"!==s||(l={actionType:s,comments:t,processList:e,isBatch:a}),"reject"===s&&(this.processOperationFormData.initialSubmit&&(s="backinitiator"),l={actionType:s,comments:t,processList:e,isBatch:a}),"investigate"===s&&("initiator"===this.processOperationFormData.investigateOperator&&("sameAsOriginal"===this.processOperationFormData.validityPeriod&&(l={processList:e,isBatch:a,actionType:s,comments:t,isResetExpireTime:!1}),"customized"===this.processOperationFormData.validityPeriod&&(l={processList:e,isBatch:a,actionType:s,comments:t,taskExpireTimeInterval:r,isResetExpireTime:!0})),"others"===this.processOperationFormData.investigateOperator&&("sameAsOriginal"===this.processOperationFormData.validityPeriod&&(l={processList:e,isBatch:a,assigneeType:i,actionType:s,comments:t,assignee:o,isResetExpireTime:!1}),"customized"===this.processOperationFormData.validityPeriod&&(l={processList:e,isBatch:a,assigneeType:i,actionType:s,assignee:o,comments:t,taskExpireTimeInterval:r,isResetExpireTime:!0}))),Object(h["a"])(l).then(e=>{e.header&&e.header.success&&(this.$modal.msgSuccess("Operation succeeded."),this.checkLists=[],this.$refs.todoinfo.reset(),this.delegateOperatorList.splice(0),this.selectOperatorList.splice(0),this.$nextTick(()=>{this.queryGroupTaskList()}))}),this.processOperationDialogVisible=!1}})},selectProcessOptCloseDialog(){this.$refs.selectProcessOptDialogRef.$refs.dialogSearchForm.resetFields(),this.selectProcessOptDialogVisible=!1},selectProcessOptDialogReset(){this.$refs.selectProcessOptDialogRef.$refs.dialogSearchForm.resetFields(),Object.keys(this.$refs.selectProcessOptDialogRef.$refs.dialogSearchForm.formData).forEach(e=>{this.$refs.selectProcessOptDialogRef.$refs.dialogSearchForm.formData[e]=""}),this.newSearchType=!1,this.delegateSearchFromData.operatorType="spOperator",this.$nextTick(()=>{this.delegateRoleSearchFormData.roleName="",this.selectProcessOptDialogTable.isSearch=!0})},comfirmselectProcessOptHandler(){if(this.selectProcessOptSingleCheck){if(0===Object.keys(this.tempSingleCheck).length)return void this.$modal.msgError("Please select at least one.");this.delegateOperatorList.splice(0),this.delegateOperatorList.push(this.tempSingleCheck),this.$refs.processOptForm.validateField("selectOperatorList",()=>{}),this.selectProcessOptCloseDialog()}else{if(0===this.tempMultiCheck.length)return void this.$modal.msgError("Please select at least one.");this.selectOperatorList=this.tempMultiCheck,this.$refs.processOptForm.validateField("selectOperatorList",()=>{}),this.selectProcessOptCloseDialog()}},processCheckChange(e){"role"===e?(this.tempDelegateTableCol=JSON.parse(JSON.stringify(this.selectProcessOptDialogTable.columns)),this.selectProcessOptDialogTable.columns=[{label:this.$t("TAC.myTodo.role"),prop:"roleName",align:"left"},{label:this.$t("TAC.myTodo.description"),prop:"description",align:"left"},{label:this.$t("TAC.myTodo.roleCategory"),prop:"roleCategory",align:"left"}],this.selectProcessOptDialogTable.getTableData=this.qeuryRoleData,this.$nextTick(()=>{this.selectProcessOptDialogTable.isSearch=!0})):(this.selectProcessOptDialogTable.columns=this.tempDelegateTableCol,this.selectProcessOptDialogTable.getTableData=this.getDelegateDialogData,this.selectProcessOptDialogReset(),this.processOptSearchFrom.formData.operatorType="spOperator",this.$nextTick(()=>{this.selectProcessOptDialogTable.isSearch=!0}))},singleCheckChange(e){this.tempSingleCheck=e},multiCheckChange(e){this.tempMultiCheck=e},getDelegateDialogData(){return new Promise(e=>{let t={operatorType:20,status:"03",userName:this.delegateSearchFromData.userName,firstName:this.delegateSearchFromData.firstName,middleName:this.delegateSearchFromData.middleName,lastName:this.delegateSearchFromData.lastName,pageNo:this.delegateDialogTable.paginationConfig.pageIndex,pageSize:this.delegateDialogTable.paginationConfig.pageSize};Object(h["h"])(t).then(t=>{if(this.selectProcessOptSearchLoading=!1,this.selectProcessOptDialogTable.isSearch=!1,t.header&&t.header.success)return t.list.forEach((e,a)=>{t.list[a].id=e.identityId}),t.totalRecords=t.total,e(t)})})},async getOrgDelegateDialogData(){let e={shortCode:this.delegateSearchFromData.shortCode,operatorName:this.delegateSearchFromData.userName,selectType:"operator",status:"03",operatorType:30,pageSize:this.delegateDialogTable.paginationConfig.pageSize,pageNo:this.delegateDialogTable.paginationConfig.pageIndex},t=await Object(h["o"])(e);if(this.selectProcessOptSearchLoading=!1,this.selectProcessOptDialogTable.isSearch=!1,t.header&&t.header.success){let e=t.list.map(e=>(e.id=e.operatorId,e));return{header:t.header,list:e,totalRecords:t.totalSize}}},removeSelected(e){this.delegateOperatorList.splice(this.delegateOperatorList.indexOf(e),1)},openSingleCheckDilog(){this.selectProcessOptSingleCheck=!0,this.selectProcessOptDialogVisible=!0},openMultiCheckDilog(){this.selectProcessOptSingleCheck=!1,this.processOptSearchFrom.formData.operatorType="spOperator",this.selectProcessOptDialogVisible=!0},removeSelecteOperator(e){this.selectOperatorList.splice(this.selectOperatorList.indexOf(e),1),this.selectOperatorList.length&&this.$refs.processOptForm.validateField("selectOperatorList",()=>{})},qeuryRoleData(){let e={selectType:"role",roleName:this.delegateRoleSearchFormData.roleName,roleCategory:this.delegateRoleSearchFormData.roleCategory,pageNo:this.delegateDialogTable.paginationConfig.pageIndex,pageSize:this.delegateDialogTable.paginationConfig.pageSize};return new Promise(t=>{Object(h["q"])(e).then(e=>{if(this.selectProcessOptSearchLoading=!1,this.delegateDialogTable.isSearch=!1,this.selectProcessOptDialogTable.isSearch=!1,e.header&&e.header.success){let a=e.list.map(e=>{switch(e.id=e.roleId,e.roleType){case"2000":e.roleCategory="Sp Operator";break;case"3000":e.roleCategory="Organization Operator";break;case"5000":e.roleCategory="Organization";break;case"7000":e.roleCategory="GROUP";break;case"8000":e.roleCategory="SP";break;default:break}return e});this.delegateRoleSearchFormData.roleCategory&&(a=a.filter(e=>e.roleType.includes(this.delegateRoleSearchFormData.roleCategory))),t({header:e.header,list:a.slice((this.delegateDialogTable.paginationConfig.pageIndex-1)*this.delegateDialogTable.paginationConfig.pageSize,this.delegateDialogTable.paginationConfig.pageSize*this.delegateDialogTable.paginationConfig.pageIndex),totalRecords:a.length})}})})},resetSearch(){this.$refs.searchFormRef.resetFields(),this.queryGroupTaskList()},queryGroupTaskList(e=1,t=10){this.searchTableLoading=!0;let a="";this.formData.taskType.length>1?this.searchFormTaskType.some(e=>{if(e.label===this.formData.taskType)return a=e.value,!0}):a=this.formData.taskType;let s={taskId:this.formData.taskNo||"",taskName:this.formData.taskName||"",priority:this.formData.priority||null,category:a,status:this.formData.status||null,dueTime:this.formData.dueTime||null,pageNo:e,createTimeFrom:this.formData.creationTime[0],createTimeTo:this.formData.creationTime[1],sortingMode:this.sortTime||"CREATE_TIME_LATEST",pageSize:t};Object(h["j"])({taskVO:s}).then(e=>{this.searchTableLoading=!1,this.searchLoading=!1,e.header&&e.header.success&&(this.todoInfoList.count=e.count,this.todoInfoList.todoInfoLists.splice(0),e.taskDTOList.forEach(e=>{let t=e.createTime.split(" "),a=t[0].split("-"),s=a[2]+"/"+a[1]+"/"+a[0]+" "+t[1],i=e.expireTime.split(" "),o=i[0].split("-"),r=o[2]+"/"+o[1]+"/"+o[0]+" "+i[1];e.title=e.taskId+"-"+e.taskName,e.createTime=s,e.expireTime=r,this.todoInfoList.todoInfoLists.push(e)}))})},selectTaskDialogSearch(){this.dialogTable.isSearch=!0,this.dialogTaskNameFormBtnLoading=!0},handleSortConditions(e){this.sortTime=e,this.queryGroupTaskList()},handleSizeChange(e){let t=e.pageIndex,a=e.pageSize;this.pageSize=e.pageSize,this.queryGroupTaskList(t,a)},search(){this.$refs.searchFormRef.validate(e=>{e&&(this.searchLoading=!0,this.searchTableLoading=!0,this.queryGroupTaskList())})},taskNameDialigSelectChange(e){this.tempTaskName=e},async getTaskNameDialogData(){let e="",t="";this.searchFormTaskType.some(e=>{if(e.value===this.taskNameSearchFormData.taskType)return t=e.label,!0}),t&&"All"!==t&&(e="Transaction and Action"===t?"TRANSATION_AND_ACTION":t.toUpperCase().split(" ").join("_"));let a={taskNameCondition:this.taskNameSearchFormData.taskName,taskTypeCondition:e},s=await Object(h["t"])(a);if(this.dialogTaskNameFormBtnLoading=!1,this.dialogTable.isSearch=!1,s.taskTypeList&&s.taskTypeList.length>0){this.taskNameCount=s.taskTypeList.length,this.taskNameHasData=!1;let e=s.taskTypeList.map(e=>(e.taskType=e.category,e));return this.taskNameDialogList=e,{header:{success:!0},list:e.slice(0,this.taskNamePageSize)}}},comfirmTaskNameHandler(){if(this.tempTaskName&&Object.keys(this.tempTaskName).length){if(this.formData.taskName=this.tempTaskName.taskName,"TRANSATION_AND_ACTION"===this.tempTaskName.taskType)this.formData.taskType="Transaction and Action",this.curSelectTaskNameToTaskType="Transaction and Action";else if(this.tempTaskName.taskType){let e=this.tempTaskName.taskType.toLocaleLowerCase().split("_").map(e=>e.replace(e[0],e[0].toLocaleUpperCase()));this.formData.taskType=e.join(" "),this.curSelectTaskNameToTaskType=e.join(" ")}this.$refs.dialogTaskNameForm.resetFields(),this.tempTaskName=null,this.taskNameDialogVisible=!1}else this.$modal.msgError("Please select at least one.")},checkTaskChange(e){if(e.isCheck)this.checkLists.push(e);else{let t=this.checkLists.findIndex(t=>t.taskId===e.taskId);this.checkLists.splice(t,1)}},checkProcess(e){return"Paused"!==e.taskState&&e.processFlag},processing(e){if(e)this.checkLists.length>0&&(this.tempTaskHandle=this.checkLists.splice(0)),this.currentData=e,this.checkLists.push(e),this.processOperationDialogVisible=!0;else if(this.checkLists.length>0){let e=this.checkLists.map(e=>this.checkProcess(e));if(e.includes(!1))return void this.$modal.alertWarning("Operation failed because the selected records contain records cannot be resolved");if(this.checkLists.length>1){let e=[];if(this.checkLists.reduce((t,a)=>(t.taskType===a.taskType?e.push(!0):e.push(!1),a)),e.includes(!1))return void(this.notificationDialogVisible=!0)}this.taskProcessDialogVisible=!0}else this.$modal.alertWarning("Select at least one record.")},closeDialog(){this.$refs.dialogTaskNameForm.resetFields(),this.tempTaskName=null,this.dialogTable.isSearch=!1,this.taskNameDialogVisible=!1},selectTaskDialogReset(){this.$refs.dialogTaskNameForm.resetFields(),this.dialogTable.isSearch=!0},handleCancelClick(){this.$refs.dialogProcessForm.resetFields(),this.taskProcessDialogVisible=!1,this.tempTaskHandle.forEach(e=>{this.checkLists.push(e)})},handleConfirmClick(){this.$refs.dialogProcessForm.validate(e=>{e&&this.$modal.confirm("","Are you sure to submit?",{cancelButtonText:this.$t("common.button.cancel"),confirmButtonText:this.$t("common.button.confirm")}).then(e=>{if("confirm"===e){let e=this.checkLists.length>1,t=this.checkLists.map(e=>({processId:e.processId,taskId:e.taskId})),a=this.taskProcessFormData.operation;"reject"===a&&this.initialSubmit&&(a="backinitiator"),Object(h["a"])({actionType:a,comments:this.taskProcessFormData.remark,isBatch:e,processList:t}).then(e=>{e.header&&e.header.success&&(this.checkLists.splice(0),this.$modal.msgSuccess("Operation succeeded."),this.taskProcessDialogVisible=!1,this.queryMyToDoTaskLists())})}},()=>{})})},handleTaskNameSizeChange(e){let t=e.pageIndex,a=e.pageSize;this.taskNamePageSize=e.pageSize,this.$refs.taskNameTableRef.tableData=this.taskNameDialogList.slice((t-1)*this.taskNamePageSize,(t-1)*this.taskNamePageSize+a)}}},T=u,k=(a("e66c"),a("2877")),b=Object(k["a"])(T,s,i,!1,null,"75405adf",null);t["default"]=b.exports},e66c:function(e,t,a){"use strict";a("b396")}}]);
//# sourceMappingURL=chunk-22deb630.js.map