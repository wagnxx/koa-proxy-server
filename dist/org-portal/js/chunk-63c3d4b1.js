(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-63c3d4b1"],{"0fb1":function(e,t,a){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",{class:{"portal-add-popup":!0,[e.checkBoxClass]:!0,"portal-add-popup--no-pagination":!e.hasPagination}},[t("el-dialog",{staticClass:"search",attrs:{title:e.addForm.title,visible:e.productVisible,width:"800px","close-on-click-modal":!1,"before-close":e.cancel},on:{"update:visible":function(t){e.productVisible=t}}},[t("div",{staticClass:"topTitle"},[e._v(e._s(e.$t("IDC.orgCustomer.selectedProduct")))]),t("div",{staticClass:"selected-container"},[t("div",{staticClass:"show-selected-div"},e._l(e.getObjFlatValue(e.uncommitSelectionache,e.addForm.idKey),(function(a,i){return t("el-tag",{key:i,attrs:{type:"info",closable:!0},on:{close:function(t){return e.removeSelected(a)}}},[e._v(" "+e._s(a.productName)+" ")])})),1)]),t("table-page",{ref:"data-table",attrs:{size:"small",idKey:"productId","is-check":e.isCheck,"is-check-memory":!0,"is-search":e.refreshTableFlag,"has-pagination":e.hasPagination,columns:e.addForm.columns,pagination:e.paginationConfig,getTableData:e.getTableData,"init-checks":e.multipleChecks,"id-key":e.addForm.idKey,"expand-row-keys":e.expands,sortArr:["productName","productDesc"]},on:{fetchData:e.fetchData,"selection-change":e.onSelectionChange}}),t("div",{attrs:{slot:"footer"},slot:"footer"},[t("el-button",{attrs:{id:"cancel",size:"small"},on:{click:e.cancel}},[e._v(e._s(e.$t("common.button.cancel"))+" ")]),t("el-button",{directives:[{name:"preventReClick",rawName:"v-preventReClick"}],attrs:{id:"confirm",size:"small",type:"primary"},on:{click:e.submit}},[e._v(" "+e._s(e.$t("common.button.confirm"))+" ")])],1)],1)],1)},o=[],r=a("4c09"),l={name:"addPrompt",components:{TablePage:r["a"]},props:{productVisible:{type:Boolean,default:!1},hasCheckBox:{type:Boolean,default:!0},hasPagination:{type:Boolean,default:!1},isCheck:{type:Boolean,default:!1},isCheckMemory:{type:Boolean,default:!1},isShowCloseBtn:{type:Boolean,default:!1},tableData:{type:Array,default:()=>[]},initChecks:{type:Array,default:()=>[]},options:{type:Object,default:()=>({})},addForm:{type:Object,default:()=>{}},submitCallBack:{type:String,default:()=>""},childSearch:{type:Function,default:null},smallAutoColumn:{type:Number,default:3,validate:e=>!(24%e)},bigAutoColumn:{type:Number,default:4,validate:e=>!(24%e)}},watch:{productVisible(e){e&&(this.refreshTableFlag=!0,this.multipleSelection=this.getCheckedSelection()),this.firstLoadTableEnd=!1}},data(){return{expands:[],paginationConfig:{total:this.addForm&&this.addForm.columns&&this.addForm.columns.length||0,pageIndex:1,pageSize:5},multipleSelection:[],multipleSelectionCache:{},uncommitSelectionache:{},refreshTableFlag:!1,searchLoading:!1,param:{},multipleChecks:this.initChecks,initChecksCache:this.initChecks,firstLoadTableEnd:!1}},computed:{formConfigList(){return this.addForm&&this.addForm.searchForm&&this.addForm.searchForm.formConf},formData(){return this.addForm&&this.addForm.searchForm&&this.addForm.searchForm.formData},checkBoxClass(){const e=this.hasCheckBox;return e?"checkbox-on":"checkbox-off"}},methods:{getCheckedSelection(){const e=this.addForm.idKey||"id",t=this.initChecks.map(t=>t[e]),a=this.getObjFlatValue(this.multipleSelectionCache,e);return a?a.filter(a=>t.includes(a[e])):[]},fetchData(e){this.paginationConfig.total=e.total,this.searchLoading=!1,this.$emit("data-fetcher",e)},filterListByField(e,t){return e.reduce((e,a)=>{if(!e.length)return[...e,a];const i=e.some(e=>e[t]===a[t]);return i?e:[...e,a]},[])},getObjFlatValue(e,t){let a=Object.values(e);return a=a.reduce((e,t)=>e.length?[...e,...t]:[...t],[]),a=this.filterListByField(a,t),a},onSelectionChange(e){const t=this.addForm.idKey,a=this.paginationConfig.pageIndex;let i=this.initChecksCache,o=this.multipleSelectionCache[a]||[];const r=e.map(e=>e[t]),l=o.filter(e=>!r.includes(e[t])),s=l.map(e=>e[t]);i=i.filter(e=>!s.includes(e[t])),this.initChecksCache=[...i],this.multipleSelectionCache[a]=[...e],this.multipleSelection=this.getObjFlatValue(this.multipleSelectionCache,t),this.uncommitSelectionache={...this.multipleSelectionCache}},async getTableData(e){let t=null;const a=this.addForm.idKey;this.tableData.length>0?t=this.tableData:(this.param.searchKey&&(e.searchKey=this.param.searchKey),t=await this.childSearch(e));const i=this.getObjFlatValue(this.uncommitSelectionache,a),o=this.firstLoadTableEnd?this.initChecksCache:this.initChecks;this.firstLoadTableEnd=!0;const r=[...o,...i],l=r.map(e=>e[a]),s=t.list||[],n=s.some(e=>l.includes(e[a]));let c=[];return n&&(c=r),window.requestIdleCallback(()=>{this.multipleChecks=c}),this.refreshTableFlag=!1,t},submit(){const e=this.options;this.$emit("submit-call-back",this.multipleSelection,e),this.$emit("update:productVisible",!1),this.multipleChecks=[]},cancel(){this.$emit("update:productVisible",!1),this.multipleChecks=[]},handleSelect(e){let t=e.data.row.productId;-1===this.expands.indexOf(t)?this.expands.push(t):this.expands.splice(this.expands.indexOf(t),1)},removeSelected(e){this.$refs["data-table"].$refs.tableRef.toggleRowSelection(e)}},filters:{obj2str(e){const t=[];return t.push(Object.values(e)[1]),t.join(",")}},created(){},mounted(){},activated(){}},s=l,n=(a("953e"),a("2877")),c=Object(n["a"])(s,i,o,!1,null,"40730a68",null);t["a"]=c.exports},"1e7b":function(e,t,a){},"3d79":function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"d",(function(){return p})),a.d(t,"b",(function(){return P})),a.d(t,"c",(function(){return O}));var i=a("02e3"),o=a("cb9d"),r=a("5a0c"),l=a.n(r);const s={COMP_DISPLAY:"dd/MM/yyyy HH:mm",DAYJS_DISPLAY:"DD/MM/YYYY HH:mm",COMP_VALUE:"yyyy-MM-dd HH:mm",DAYJS:"YYYY-MM-DD HH:mm"},n={pattern:/^((13[5-9])|(1[4-9][0-9]))[0-9]{8}$/,message:"Please Enter a correct IMSI.",trigger:"blur"},c={type:"email",message:"Please enter only letters(a-z),numbers(0-9),periods(.),and at(@).",trigger:"blur"},d=e=>e(new Error("Query short code exception."));let u=(e,t)=>({required:!0,trigger:["blur","change"],validator(t,a,i){let o="";if(!a)return o="Please select content",e.parentOrgName="",i(new Error(o));const r=a.length,l=4,s=12;if(r>=4&&r<=s)return i();o=`Must be between ${l} and ${s} characters`,e.parentOrgName="",i(new Error(o))}}),p=(e,t)=>({parentShortCode:[u(e,t),f(e,t),{trigger:"change"}],shortCode:[i["e"],i["n"],h()],merchName:[i["e"],v(e.orgNameRegex),g()],notificationChannel:[i["z"]],phoneNumber:[n,i["q"],y(e)],email:[c,i["q"],w(e)],language:[i["z"]],selectedProdList:[m(e)]});const m=e=>{const t=(t,a,i)=>{const o=e.selectedProdList;if(!o||!o.length)return i(new Error("Please select one product."));i()};return{validator:t}};let h=()=>{const e=(e,t,a)=>{Object(o["j"])(t).then(e=>{e.header&&e.header.success?"Invalid"===e.check?a(new Error("The Organization short code is invalid.")):"Exist"===e.check?a(new Error("The Organization Short Code Already Exsists.")):a():a(new Error("Query short code error."))}).catch(e=>d(a))};return{validator:e,trigger:"blur"}},f=(e,t)=>{const a=(a,i,r)=>{Object(o["j"])(i).then(a=>{if(!a.header||!a.header.success)return e.parentOrgName="",void r(new Error("Query short code error."));"Exist"===a.check?b(e,t,r):"Invalid"===a.check?(e.parentOrgName="",r(new Error("The short code is invalid."))):(e.parentOrgName="",r(new Error("The short code is not existed.")))}).catch(e=>d(r))};return{validator:a,trigger:"blur"}},b=(e,t,a)=>{t.identityModel="",t.subAgentExpansionModel="",Object(o["u"])({shortCode:e.parentShortCode}).then(i=>{if(i.header&&i.header.success&&i.organizationInfo){let o=i.organizationInfo;""===o.subAgentExpansionModel||"0003"===o.subAgentExpansionModel?(e.parentOrgName="",a(new Error("The short code does not allow sub-organizations."))):"0002"===o.subAgentExpansionModel?(e.parentId=o.organizationId,e.parentOrgName=o.organizationName,t.parentIdentityModel=o.subAgentExpansionModel,a()):o.subAgentExpansionModel!="000"+e.selectedProdList[0].productProperties.ORG_IDENTITY_MODEL?a(new Error("SelectedProduct not match subAgentExpansionModel.")):(e.parentId=o.organizationId,e.parentOrgName=o.organizationName,t.parentIdentityModel=o.subAgentExpansionModel,a())}}).catch(()=>{e.parentOrgName="",a(new Error("Query organization list exception."))})},g=()=>{const e=(e,t,a)=>{Object(o["g"])({merchantName:t}).then(e=>{e.header&&e.header.success?"Invalid"===e.check?a(new Error("The organization name is invalid.")):"Exist"===e.check?a(new Error("The organization name is existed.")):a():a(new Error("Query organization name error."))}).catch(()=>{a(new Error("Query organization name exception."))})};return{validator:e,trigger:"blur"}},v=e=>({validator:(t,a,i)=>{new RegExp(e).test(a)?i():i(new Error(e+"."))},trigger:"blur"}),y=e=>C(e,"1001"),w=e=>C(e,"1011"),C=(e,t)=>({validator:(a,i,o)=>{""===i&&e.notificationChannel===t?o(new Error("Please enter content")):o()},trigger:"blur"});const E={validationExpression:[i["e"],i["m"]],validationMode:[i["z"]],allowPartialPayement:[i["z"]]};let P=()=>({identityModel:[i["z"]],subAgentExpansionModel:[i["z"]],ruleProfile:[i["z"]],aggregatorModel:[i["z"]],centralOwnedModel:[i["z"]],...E});const O=(e,t,a)=>{let i=(e,i,o)=>{if("effectiveTime"===a?t.effectiveErrorMessage="":t.expireErrorMessage="",!t)return o();const r="The date must be later than  Effective Date.",n="The date must be earlier than  Expiry Date.",c=l()(t.effectiveTime,s.DAYJS),d=l()(t.expireTime,s.DAYJS),u=c<d;return u?o():"effectiveTime"===a?(t.effectiveErrorMessage=n,o(new Error(n))):"expireTime"===a?(t.expireErrorMessage=r,o(new Error(r))):void o(new Error("Invalid time."))};return[{required:!0,message:"Please enter context"},{validator:i,trigger:"change"}]}},"4d86":function(e,t,a){"use strict";a("c6ed")},"689d":function(e,t,a){"use strict";a.d(t,"a",(function(){return i})),a.d(t,"e",(function(){return o})),a.d(t,"f",(function(){return r})),a.d(t,"c",(function(){return l})),a.d(t,"d",(function(){return s})),a.d(t,"b",(function(){return n}));const i=(e,t,...a)=>e(...a).then(e=>e.header&&e.header.success?e[t]:null).catch(()=>null),o=e=>{const t=Object.keys(e),a=Object.values(e);return Promise.all(a).then(e=>{const a=t.map((t,a)=>[t,e[a]]);return Object.fromEntries(a)})},r=(e,t,a=!1)=>i=>{const o={label:i[t],value:i[e]};return a?o:{...i,...o}},l=(e,t,a)=>{const i=e.find(e=>e[a]===t);return i},s=(e,t)=>{const a=l(e,t,"value")||{};return a["label"]},n=(e,t)=>{if(t||(t=new Map),!(e instanceof Object))return e;if(t.get(e))return t.get(e);let a;a=e instanceof Function?e.prototype?function(){return e.apply(this,arguments)}:(...t)=>e.call(void 0,...t):e instanceof Array?[]:e instanceof Date?new Date(e-0):e instanceof RegExp?new RegExp(e.sourceData,e.flags):{},t.set(e,a);for(let i in e)Object.hasOwnProperty.call(e,i)&&(a[i]=n(e[i],t));return a}},"7c5e":function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return r})),a.d(t,"e",(function(){return l})),a.d(t,"a",(function(){return s})),a.d(t,"d",(function(){return n}));var i=a("d8d3");const o={NEW:"00",PENDING_ACTIVE:"02",ACTIVE:"03",SUSPENDED:"04",FROZEN:"05",CLOSED:"06",CAPPED:"07",DORMANT:"08"};function r(e){return i["c"][e]||"-"}function l(e){const t={[o.ACTIVE]:"ACTIVE",[o.SUSPENDED]:"SUSPENDED",[o.FROZEN]:"FROZEN"};return t[e]}const s={CAN_MAKE_AGGREGATOR:"0000",CAN_MAKE_OWNED:"0001",CAN_MAKE_ALLTYPE:"0002",NONEHIERARCHY:"0003",AGGREGATOR:"0100",CENTRAL_OWNED:"0101"},n=e=>{switch(e){case s.CAN_MAKE_AGGREGATOR:return"Can Make Aggregator";case s.CAN_MAKE_OWNED:return"Can Make Owned";case s.CAN_MAKE_ALLTYPE:return"Can Make AllType";case s.NONEHIERARCHY:return"NoneHierarchy";case s.AGGREGATOR:return"Aggregator";case s.CENTRAL_OWNED:return"Central Owned";default:return}}},"7e99":function(e,t,a){},"953e":function(e,t,a){"use strict";a("1e7b")},ac21:function(e,t,a){"use strict";a.d(t,"a",(function(){return s}));var i=a("02e3"),o=a("cb9d");const r=async(e,t,a)=>{const i={SUCCUSS:"el-form-item--valiate-succuss",PENDING:"el-form-item--valiate-pending",ERROR:"el-form-item--valiate-error"},r=a[0],l="The organization name is invalid.",s=/^([0-9A-Za-z\\_\\^\\|\\/ ]{2,128})$/;if(r.validateStatus=i.PENDING,!s.test(e))return r.validateStatus=i.ERROR,void t(new Error(l));r.validateStatus=i.PENDING;try{const a=await Object(o["h"])({organizationName:e});if(a.header&&a.header.success&&!0===a.flag)return r.validateStatus=i.SUCCUSS,void t();if(!1===a.flag){let e=a.description;return r.validateStatus=i.ERROR,void t(new Error(e))}r.validateStatus=i.ERROR,t(new Error(l))}catch(n){r.validateStatus=i.ERROR,t(new Error("Check organization name exception."))}},l=e=>({trigger:"blur",validator(t,a,i){r(a,i,e)}}),s=e=>({identityStatus:[i["z"]],ruleProfile:[i["z"]],remark:[i["e"]],newOrganizationName:[i["e"],l(e)]})},ad03:function(e,t,a){"use strict";var i=function(){var e=this,t=e._self._c;return t("div",{staticClass:"panel"},[e.showBillValid?t("div",{staticClass:"panel-header"},[e._v(e._s(e.$t("IDC.organizationDetail.productDesc")))]):e._e(),t("el-form",{ref:"productForm",attrs:{"label-width":"100px","label-position":"top",model:e.productObj,rules:e.productFormRules}},[t("div",{staticClass:"content-wrapper"},[t("div",{staticClass:"sub-block"},["edit"!==e.mode||e.isEditModel?e._e():t("el-row",{staticStyle:{margin:"20px 0"}},[t("el-col",[t("el-button",{attrs:{size:"small",type:"primary",plain:""},on:{click:e.productBtnClickHandle}},[t("i",{staticClass:"el-icon-edit el-icon--right"}),e._v(" "+e._s(e.$t("common.button.edit"))+" ")])],1)],1),t("div",{staticClass:"sub-block__title sub-block__title--normal"},[e._v(e._s(e.$t("IDC.organization.product")))]),e.isEditModel?t("el-row",{staticStyle:{margin:"20px 0"}},[t("el-col",[t("el-button",{attrs:{size:"small",plain:"",type:"primary",icon:"el-icon-plus"},on:{click:e.productBtnClickHandle}},[e._v(e._s(e.$t("common.button.add")))])],1)],1):e._e(),t("div",{staticClass:"product-table-container"},[t("org-product-table",e._b({ref:"producuntRef",staticClass:"product-table",attrs:{columns:e.productColumnsConfig,"out-side-table-data":e.getAllProduct},scopedSlots:e._u([{key:"effectiveTime",fn:function(a){return[e.isEditModel&&(a.data.row.isEditModel||a.data.row.isNewItem)?t("el-form-item",{attrs:{prop:a.data.$index<e.productObj.productList.length?"productList."+a.data.$index+".effectiveTime":"selectedProduct."+(a.data.$index-e.productObj.productList.length)+".effectiveTime",rules:e.rules.dateRule(a.data.row,"effectiveTime")}},[t("el-tooltip",{attrs:{effect:"light",placement:"top-start","popper-class":"product-datepicker-tooltip","arrow-offset":40,content:a.data.row.effectiveErrorMessage,disabled:!a.data.row.effectiveErrorMessage}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{"value-format":e.DATE_FORMAT.COMP_VALUE,format:e.DATE_FORMAT.COMP_DISPLAY,type:"datetime",size:"small",placeholder:e.$t("common.placeholder.enter"),"picker-options":e.pickerProdTimeStart(a.data.row),disabled:e.checkEffectived(a.data.row)},on:{change:function(t){return e.onDatePickerChange(a,"effectiveTime")}},model:{value:a.data.row.effectiveTime,callback:function(t){e.$set(a.data.row,"effectiveTime",t)},expression:"scope.data.row.effectiveTime"}})],1)],1):t("span",{domProps:{textContent:e._s(e.formatDisplayDate(a.data.row.effectiveTime))}})]}},{key:"expireTime",fn:function(a){return[e.isEditModel&&(a.data.row.isEditModel||a.data.row.isNewItem)?t("el-form-item",{attrs:{prop:a.data.$index<e.productObj.productList.length?"productList."+a.data.$index+".expireTime":"selectedProduct."+(a.data.$index-e.productObj.productList.length)+".expireTime",rules:e.rules.dateRule(a.data.row,"expireTime")}},[t("el-tooltip",{attrs:{effect:"light",placement:"top-start","popper-class":"product-datepicker-tooltip","arrow-offset":40,content:a.data.row.expireErrorMessage,disabled:!a.data.row.expireErrorMessage}},[t("el-date-picker",{staticStyle:{width:"100%"},attrs:{"value-format":e.DATE_FORMAT.COMP_VALUE,format:e.DATE_FORMAT.COMP_DISPLAY,type:"datetime",size:"small",placeholder:e.$t("common.placeholder.enter"),"picker-options":e.pickerProdTimeEnd(a.data.row)},on:{change:function(t){return e.onDatePickerChange(a,"expireTime")}},model:{value:a.data.row.expireTime,callback:function(t){e.$set(a.data.row,"expireTime",t)},expression:"scope.data.row.expireTime"}})],1)],1):t("span",{domProps:{textContent:e._s(e.formatDisplayDate(a.data.row.expireTime))}})]}},{key:"status",fn:function(a){return[e.isEditModel&&(a.data.row.isEditModel||a.data.row.isNewItem)?t("el-select",{attrs:{size:"small"},model:{value:a.data.row.productStatus,callback:function(t){e.$set(a.data.row,"productStatus",t)},expression:"scope.data.row.productStatus"}},e._l(e.productStatusList,(function(e,a){return t("el-option",{key:a,attrs:{label:e.name,value:e.code}})})),1):t("div",{staticClass:"col-status"},[a.data.row.productStatus===e.PRODUCT_STATUS.ACTIVE.code?t("svg-icon",{staticClass:"status status-active",attrs:{"icon-class":"circle"}}):a.data.row.productStatus===e.PRODUCT_STATUS.SUSPENDED.code?t("svg-icon",{staticClass:"status status-deaf",attrs:{"icon-class":"circle"}}):a.data.row.productStatus===e.PRODUCT_STATUS.CLOSED.code?t("svg-icon",{staticClass:"status status-inactive",attrs:{"icon-class":"circle"}}):e._e(),e._v(" "+e._s(e.showProductStatus(a.data.row.productStatus))+" ")],1)]}},{key:"chargeProfile",fn:function(a){return[e.isEditModel&&(a.data.row.isEditModel||a.data.row.isNewItem)?t("el-select",{attrs:{placeholder:e.$t("common.placeholder.select"),size:"small"},model:{value:a.data.row.chargeProfileId,callback:function(t){e.$set(a.data.row,"chargeProfileId",t)},expression:"scope.data.row.chargeProfileId"}},e._l(a.data.row.chargeProfiles,(function(e,a){return t("el-option",{key:a,attrs:{label:e.chargeProfileName,value:e.chargeProfileId}})})),1):t("span",{domProps:{textContent:e._s(e.getChargeProfileLabelById(a.data.row.chargeProfiles,a.data.row.chargeProfileId))}})]}},{key:"operation",fn:function(a){return[a.data.row.isNewItem?t("el-button",{attrs:{type:"text",size:"small"},on:{click:()=>e.deletNewProductFromSelected(a.data.row)}},[e._v("Delete")]):a.data.row.isEditModel?t("el-button",{attrs:{type:"text",size:"small"},on:{click:()=>e.cancelCurrentRowOperation(a.data.row)}},[e._v("Cancel")]):a.data.row.isEditModel?e._e():t("el-button",{attrs:{type:"text",size:"small"},on:{click:()=>e.setRowOperationModel(a.data.row,!0)}},[e._v("Edit")])]}},{key:"productName",fn:function(a){return[t("span",{domProps:{textContent:e._s(a.data.row.productName)}})]}}])},"org-product-table",e.getProductStyleOptions,!1))],1)],1),e.showBillReferenceNumberValidation?t("div",[t("div",{staticClass:"title"},[e._v("Bill Reference Number Validation")]),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"Validation Mode",prop:"payBillValidateForm.validationMode"}},[e.isViewMode?t("span",{domProps:{textContent:e._s(e.getValidationMode(e.productObj.payBillValidateForm.validationMode))}}):t("el-select",{attrs:{placeholder:e.$t("common.placeholder.select"),size:"small"},model:{value:e.productObj.payBillValidateForm.validationMode,callback:function(t){e.$set(e.productObj.payBillValidateForm,"validationMode",t)},expression:"productObj.payBillValidateForm.validationMode"}},e._l(e.validationModeOptions,(function(e,a){return t("el-option",{key:a,attrs:{value:e.value,label:e.label}})})),1)],1)],1),e.showRegularExpression?t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"Regular Expression",prop:"payBillValidateForm.validationExpression"}},[e.isViewMode?t("span",{domProps:{textContent:e._s(e.productObj.payBillValidateForm.validationExpression)}}):t("el-input",{attrs:{placeholder:e.$t("common.placeholder.enter"),size:"small"},model:{value:e.productObj.payBillValidateForm.validationExpression,callback:function(t){e.$set(e.productObj.payBillValidateForm,"validationExpression",t)},expression:"productObj.payBillValidateForm.validationExpression"}})],1)],1):e._e()],1),t("el-row",{attrs:{gutter:20}},[t("el-col",{attrs:{span:8}},[t("el-form-item",{attrs:{label:"Allow Partial Bill Payment",prop:"payBillValidateForm.allowPartialPayement"}},[e.isViewMode?t("span",{domProps:{textContent:e._s("1"===e.productObj.payBillValidateForm.allowPartialPayement?"YES":"NO")}}):t("div",[t("el-radio",{attrs:{label:"1",size:"small"},model:{value:e.productObj.payBillValidateForm.allowPartialPayement,callback:function(t){e.$set(e.productObj.payBillValidateForm,"allowPartialPayement",t)},expression:"productObj.payBillValidateForm.allowPartialPayement"}},[e._v("YES")]),t("el-radio",{attrs:{label:"0",size:"small"},model:{value:e.productObj.payBillValidateForm.allowPartialPayement,callback:function(t){e.$set(e.productObj.payBillValidateForm,"allowPartialPayement",t)},expression:"productObj.payBillValidateForm.allowPartialPayement"}},[e._v("NO")])],1)])],1)],1)],1):e._e(),t("div",{staticStyle:{"margin-top":"20px"}},[e.isEditModel?t("el-form-item",{attrs:{label:e.$t("IDC.groupDetail.label.Remark"),prop:"remark"}},[t("el-input",{attrs:{rows:4,type:"textarea",placeholder:"Please enter"},model:{value:e.productObj.remark,callback:function(t){e.$set(e.productObj,"remark",t)},expression:"productObj.remark"}})],1):e._e()],1)])]),e.isEditModel?t("div",{staticClass:"flex flex-jus-end"},[t("el-button",{staticClass:"cancel-button",attrs:{id:"cancel",size:"small"},on:{click:e.resetEvn}},[e._v("Cancel ")]),t("el-button",{directives:[{name:"preventReClick",rawName:"v-preventReClick"}],attrs:{id:"submitProduct",type:"primary",size:"small",loading:e.submitLoading},on:{click:e.submitEvn}},[e._v(" Submit ")])],1):e._e(),t("product-dialog",{attrs:{productVisible:e.showProductPopup,addForm:e.popupConf,isCheck:!0,isCheckMemory:!0,hasPagination:!1,childSearch:e.getProduct},on:{"update:productVisible":function(t){e.showProductPopup=t},"update:product-visible":function(t){e.showProductPopup=t},"submit-call-back":e.addProduct}})],1)},o=[],r=a("0fb1"),l=a("fc5e6"),s=a("cb9d"),n=a("689d"),c=a("7dfc"),d=a("3d79"),u=a("5a0c"),p=a.n(u),m=a("02e3");const h={ACTIVE:{code:"01",name:"Active"},SUSPENDED:{code:"02",name:"Suspended"},CLOSED:{code:"03",name:"Closed"}},f="YYYY-MM-DD HH:mm";var b={name:"ProductInfo",components:{OrgProductTable:l["a"],productDialog:r["a"]},props:{identityId:{type:String,required:!0},mode:{type:String,default:"edit",enum:["edit","review"]},showBillValid:{type:Boolean,default:!0},isReceiveData:{type:Boolean,default:!1},receiveProductData:{type:Array,default:()=>[]}},inject:["orgDetailView"],data(){return{DATE_FORMAT:d["a"],PRODUCT_STATUS:h,isEditModel:!1,submitLoading:!1,productObj:{remark:"",productList:[],selectedProduct:[],time:{unit:null,value:null},payBillValidateForm:{validationMode:"",allowPartialPayement:"",validationExpression:""}},validationModeOptions:[{label:"External Validation",value:"2"},{label:"Internal and External",value:"3"},{label:"Internal Validation",value:"1"},{label:"No Validation",value:"0"}],closedProducts:[],closedProductColumns:[{label:this.$t("IDC.organization.table.productName"),prop:"productName",align:"left"},{label:this.$t("IDC.organization.table.effectiveDate"),prop:"effectiveTime",align:"left"},{label:this.$t("IDC.organization.table.expiryDate"),prop:"expireTime",align:"left"},{label:this.$t("IDC.organization.table.chargeProfile"),prop:"chargeProfile",align:"left",__slotName:"chargeProfile"},{label:this.$t("common.label.description"),prop:"productDesc",align:"left"},{label:this.$t("common.label.status"),prop:"status",align:"left",__slotName:"status"}],showProductPopup:!1,popupConf:{idKey:"productId",title:"Add Product",label:"Product Name",columns:[{label:"Product Name",prop:"productName",align:"left"},{label:"Description",prop:"productDesc",align:"left"}],searchForm:{formData:{name:null},formConf:[{label:"Product Name",key:"name",prop:"name",comp:"el-input",bind:{clearable:!0,placeholder:this.$t("common.placeholder.enter")}}]}},rules:{dateRule:(e,t)=>Object(d["c"])(this,e,t)},payBillCheckRule:{}}},computed:{productColumnsConfig(){let e={label:this.$t("IDC.organization.table.productName"),prop:"productName",align:"left","min-width":200},t={label:this.$t("IDC.organization.table.productName"),prop:"productName",align:"left",width:200,fixed:"left",__slotName:"productName"};const a=[{label:this.$t("IDC.organization.businessOperationsGroup"),prop:"businessOperationsGroup",align:"left","min-width":250},{label:this.$t("IDC.organization.table.effectiveDate"),prop:"effectiveTime",align:"left",__slotName:"effectiveTime","min-width":220},{label:this.$t("IDC.organization.table.expiryDate"),prop:"expireTime",align:"left",__slotName:"expireTime","min-width":220},{label:this.$t("IDC.organization.chargeProfile"),prop:"chargeProfile",align:"left",__slotName:"chargeProfile","min-width":200},{label:this.$t("common.label.description"),prop:"productDesc",align:"left","min-width":200},{label:this.$t("common.label.status"),prop:"status",align:"left",__slotName:"status","min-width":150}];return this.isEditModel?(a.unshift(e),a.push({label:this.$t("common.label.operation"),"min-width":100,align:"left",__slotName:"operation",fixed:"right"}),a):(a.unshift(t),a)},getAllProduct(){return[].concat(this.productObj.productList,this.productObj.selectedProduct)},getProductStyleOptions(){return this.getAllProduct.length>=10?{height:"520"}:{}},productStatusList(){const e=Object.values(this.PRODUCT_STATUS);return e},showBillReferenceNumberValidation(){const e=this.getAllProduct||[];return e.some(e=>{if(e.productProperties)return void 0!=e.productProperties.BILL_REF_NUM_RULE})&&this.showBillValid},showRegularExpression(){const e=this.productObj.payBillValidateForm;return e.validationMode&&"0"!==e.validationMode&&"2"!==e.validationMode},isViewMode(){return!this.isEditModel},productFormRules(){return{payBillValidateForm:this.isViewMode?{}:{validationExpression:[m["e"]],validationMode:[m["z"]],allowPartialPayement:[m["z"]]},remark:[m["e"]]}}},created(){this.isReceiveData||this.init()},watch:{"orgDetailView.payBillCheckRule":{handler(e){this.payBillCheckRule={...e},this.productObj.payBillValidateForm={...e}},deep:!0,immediate:!0},receiveProductData:{handler(e){this.productObj.productList=Object(n["b"])(e).map(e=>{const t=e.effectiveDate.replace("T"," "),a=e.expireDate.replace("T"," "),i=Object(c["a"])(t,d["a"].DAYJS,f),o=Object(c["a"])(a,d["a"].DAYJS,f);return e.effectiveTime=i,e.expireTime=o,e.effectiveErrorMessage="",e.expireErrorMessage="",e.chargeProfiles=e.chargeProfiles||[],e.originRow=Object(n["b"])(e),e})},deep:!0,immediate:!0}},methods:{init(){this.initProduct()},async initProduct(){const e={identityId:this.identityId};let t=await Object(n["a"])(s["L"],"list",e);t=Object(n["b"])(t),this.productObj.productList.length=0,this.productObj.selectedProduct.length=0,t&&(t=t.map(e=>{const t=e.effectiveDate.replace("T"," "),a=e.expireDate.replace("T"," "),i=Object(c["a"])(t,d["a"].DAYJS,f),o=Object(c["a"])(a,d["a"].DAYJS,f);return e.effectiveTime=i,e.expireTime=o,e.effectiveErrorMessage="",e.expireErrorMessage="",e.originRow=Object(n["b"])(e),e}),this.productObj.productList.push(...t))},async initClosedProduct(){this.identityId;let e=[];e&&(e=e.map(e=>{const t=e.effectiveDate.replace("T"," "),a=e.expireDate.replace("T"," "),i=Object(c["a"])(t,d["a"].DAYJS,f),o=Object(c["a"])(a,d["a"].DAYJS,f);return e.effectiveTime=i,e.expireTime=o,e}),this.closedProducts=e)},refreshProuduct(){this.initProduct()},showProductStatus(e){const t=Object.values(h),a=Object(n["c"])(t,e,"code")||{};return a.name||"-"},getChargeProfileLabelById(e,t){const a=Object(n["c"])(e,t,"chargeProfileId")||{};return a.chargeProfileName||"-"},productBtnClickHandle(){this.isEditModel?this.showProductPopup=!0:this.changeEditModel(!0)},async getProduct(){let e={header:{success:!1},list:[]};this.prodLoading=!0;try{const t={identityId:this.identityId},a=await Object(n["a"])(s["z"],"list",t);e.list=a,e.header.success=!0}catch(t){}return this.prodLoading=!1,e.list=e.list.filter(e=>!this.getAllProduct.find(t=>t.productId===e.productId)),e},resetEvn(){this.$confirm("Are you sure to cancel the operation?",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",closeOnClickModal:!1,type:"warning"}).then(()=>{this.refreshProuduct(),this.changeEditModel(!1),this.productObj.payBillValidateForm={...this.payBillCheckRule},this.$emit("product-cancel")})},submitEvn(){this.$refs.productForm.validate(e=>{if(!e)return;const t=this.getAllProduct.map(e=>({productId:e.productId,effectiveTime:e.effectiveTime,expireTime:e.expireTime,chargeProfileId:e.chargeProfileId,status:e.productStatus}));if(this.isReceiveData){const e={products:t,remark:this.productObj.remark};return void this.$emit("product-submit",e)}this.submitLoading=!0;const a=this.productObj.payBillValidateForm,i={newOrganizationProducts:t,receiverIdentityId:this.identityId};this.showBillReferenceNumberValidation&&(i.payBillCheckRule={validationMode:a.validationMode,validationExpression:a.validationExpression,allowPartialPayement:a.allowPartialPayement,notifyText:a.notifyText}),Object(s["c"])(i).then(e=>{e.header&&e.header.success&&(e.taskId?this.$message.success("The request must be approved by another operator."):this.$message.success("Submit Successful"),this.refreshProuduct(),this.changeEditModel(!1),this.showBillReferenceNumberValidation&&(this.payBillCheckRule={...a}))}).finally(()=>{this.submitLoading=!1})})},changeEditModel(e){this.isEditModel=e},setRowOperationModel(e,t){e&&"undefined"!==typeof t&&this.$set(e,"isEditModel",t)},cancelCurrentRowOperation(e){if(!e)return;const t=e.originRow;t&&(e.effectiveTime=t.effectiveTime,e.expireTime=t.expireTime,e.chargeProfile=t.chargeProfile,e.productStatus=t.productStatus),this.setRowOperationModel(e,!1)},deletNewProductFromSelected(e){e&&this.$modal.confirm("Are you sure to delete it?","Delete",{confirmButtonText:"Confirm",cancelButtonText:"Cancel",closeOnClickModal:!1,type:"warning"}).then(()=>{let t=this.productObj.selectedProduct.findIndex(t=>t===e);-1!=t&&this.productObj.selectedProduct.splice(t,1)})},addProduct(e){let t=Object(n["b"])(this.productObj.selectedProduct),a=Object(n["b"])(e);a=a.map(e=>{const a=t.find(t=>t.productId===e.productId);e.isEditModel=!!a&&a.isEditModel;const i=Object(c["a"])(e.effectiveDate,d["a"].DAYJS,f),o=Object(c["a"])(e.expireDate,d["a"].DAYJS,f);return e.effectiveTime=i,e.expireTime=o,e.isNewItem=!0,e.productStatus=h.ACTIVE.code,e.effectiveErrorMessage="",e.expireErrorMessage="",e.originRow=Object(n["b"])(e),e}),this.productObj.selectedProduct.push(...a)},getOptionsLabelByValue(e,t){const a=Object(n["d"])(e,t);return a||"-"},formatDisplayDate(e){const t=Object(c["a"])(e,d["a"].DAYJS_DISPLAY,f);return t},validationModeChange(e){e&&"No Validation"!==e||(this.regularExpression="")},pickerProdTimeStart(e={}){return{disabledDate(t){const a=t.getTime()<=Date.now(),i=p()(e.effectiveTime,d["a"].DAYJS),o=Date.now()>new Date(i);return!(!a&&!o)||t.getTime()<Date.now()}}},pickerProdTimeEnd(e={}){return{disabledDate(e){const t=e.getTime()<Date.now();return t}}},checkEffectived(e={}){if(e.effectiveTime){const t=p()(e.effectiveTime,d["a"].DAYJS);return Date.now()>new Date(t)}return!1},onDatePickerChange(e,t){let a;a="effectiveTime"===t?"expireTime":"effectiveTime";const i=e.data.$index<this.productObj.productList.length?"productList."+e.data.$index+"."+a:"selectedProduct."+(e.data.$index-this.productObj.productList.length)+"."+a;this.$nextTick(()=>{"effectiveTime"===a?e.data.row.effectiveErrorMessage="":e.data.row.expireErrorMessage="",this.$refs.productForm.clearValidate([i])})},getValidationMode(e){switch(e){case"0":return"No Validation";case"1":return"Internal Validation";case"2":return"External Validation";case"3":return"Internal and External"}}}},g=b,v=(a("f320"),a("2877")),y=Object(v["a"])(g,i,o,!1,null,"154f17b4",null);t["a"]=y.exports},c6ed:function(e,t,a){},dbea:function(e,t,a){"use strict";var i=function(){var e=this,t=e._self._c;return t("el-dialog",e._g(e._b({staticClass:"portal-dialog",attrs:{"destroy-on-close":!0,visible:e.showDialog,title:e.conf.title,width:e.width,"close-on-click-modal":e.closeOnClickModal,"show-close":e.showClose,"before-close":e.beforeClose},on:{"update:visible":function(t){e.showDialog=t},open:e.open,close:e.close,opened:e.opened,closed:e.closed}},"el-dialog",e.$attrs,!1),e.$listeners),[t("el-form",{ref:"dialog-form",attrs:{model:e.dialogForm,rules:e.validationRules}},[t("section",[t("div",{staticClass:"label"},[e._v(e._s(e.conf.label))]),t("div",{staticClass:"value"},[e._v(e._s(e.conf.value))]),e._l(e.props,(function(a){return t("el-form-item",e._b({key:a.key,class:[a.validateStatus,a.itemClass],attrs:{label:a.label,prop:a.key}},"el-form-item",a.itemBind,!1),["select"===a.type?t("el-select",{attrs:{size:"small",placeholder:"Please select"},model:{value:e.dialogForm[a.key],callback:function(t){e.$set(e.dialogForm,a.key,t)},expression:"dialogForm[prop.key]"}},e._l(a.options,(function(e){return t("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1):"input"===a.type?t("el-input",e._b({class:a.eleClass,attrs:{size:"small",placeholder:"Please enter the content"},model:{value:e.dialogForm[a.key],callback:function(t){e.$set(e.dialogForm,a.key,t)},expression:"dialogForm[prop.key]"}},"el-input",a.elementBind,!1)):"textarea"===a.type?t("el-input",{attrs:{type:"textarea",rows:3,placeholder:"Please enter"},model:{value:e.dialogForm[a.key],callback:function(t){e.$set(e.dialogForm,a.key,t)},expression:"dialogForm[prop.key]"}}):e._e()],1)}))],2),t("section",[t("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{staticClass:"btn-option",attrs:{size:"small",plain:""},on:{click:e.cancel}},[e._v("Cancel")]),t("el-button",{directives:[{name:"loading",rawName:"v-loading",value:e.submitLoading,expression:"submitLoading"},{name:"preventReClick",rawName:"v-preventReClick"}],staticClass:"btn-option",attrs:{size:"small",type:"primary"},on:{click:function(t){return e.submit(e.conf.prop)}}},[e._v("Submit")])],1)])])],1)},o=[],r=a("ac21"),l={name:"ContentItemEditDialog",props:{visible:{type:Boolean,default:!0},submitLoading:{type:Boolean,default:!1},title:{type:String,default:""},width:{type:String,default:"448px"},closeOnClickModal:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},config:{type:Object,default:()=>{}},data:{type:Object,default:()=>{}}},data(){return{showDialog:!1,dialogForm:{},conf:{},props:[],text:"",validationRules:{}}},watch:{visible:{handler(e){this.showDialog=e},immediate:!0},config:{handler(e){if(e&&(this.conf=JSON.parse(JSON.stringify(e))||{},this.conf.properties&&this.conf.properties.length)){const e=this.conf.properties,t={};for(const a of e)a.useDefult&&(t[a.key]=a.default);this.dialogForm=t,this.props=e,this.validationRules=Object(r["a"])(this.props),this.$forceUpdate()}},immediate:!0,deep:!0},showDialog:{handler(e){this.$nextTick(()=>{this.$refs["dialog-form"]&&this.$refs["dialog-form"].clearValidate(),this.$emit("show-dialog",e),this.$emit("update:visible",e)})},immediate:!0}},created(){},activated(){},methods:{beforeClose(){this.close()},open(){},opened(){},close(){this.showDialog=!1,this.$refs["dialog-form"].resetFields()},closed(){},cancel(){this.close()},submit(e){this.$refs["dialog-form"].validate(t=>{t&&this.$emit("on-submit",e,this.dialogForm)})}}},s=l,n=(a("4d86"),a("2877")),c=Object(n["a"])(s,i,o,!1,null,"08488c31",null);t["a"]=c.exports},f320:function(e,t,a){"use strict";a("7e99")},fc5e6:function(e,t,a){"use strict";var i=function(){var e=this,t=e._self._c;return t("el-table",e._b({key:e.tableKey,ref:"tableRef",staticClass:"orgTable",attrs:{"empty-text":"No records found.","header-cell-style":e.headerStyle,data:e.outSideTableData,size:e.size,border:e.border,"row-key":e.idKey,"max-height":e.maxHeight}},"el-table",e.$attrs,!1),[e._l(e.columns,(function(a,i){return[t("el-table-column",e._b({key:i,attrs:{sortable:e.sortFun(a),width:a.width||"",formatter:a.formatter||e.formatterHandle},scopedSlots:e._u([a.__slotName?{key:"default",fn:function(t){return[e._t(a.__slotName,null,{data:t})]}}:null],null,!0)},"el-table-column",a,!1))]}))],2)},o=[],r={name:"org-product-table",props:{columns:{type:Array,default:()=>[]},size:{type:String,default:"medium"},idKey:{type:String,default:"id"},sortArr:{type:Array,default:()=>[]},pageParam:{type:Object,default:()=>({pageOffset:"pageNo",pageSize:"pageSize"})},hasPagination:{type:Boolean,default:!0},pagination:{type:Object,default:()=>({total:0,pageIndex:1})},pageSizes:{type:Array,default(){return[10,20,50,100]}},outSideTableData:{type:Array,default:()=>[]},border:{type:Boolean,default:!0},initChecks:{type:Array,default:()=>[]},maxHeight:{type:[Number,String]}},data(){return{tableKey:(new Date).getTime(),headerStyle:{"background-color":""+this.GlobalStyleVariables.fillLightColor,"font-size":"14px","font-family":"HuaweiSans-Medium","font-weight":500,color:""+this.GlobalStyleVariables.textEmphasisColor}}},methods:{sortFun(e){const t=this.sortArr&&this.sortArr.indexOf(e.prop)>-1;return!!t&&(!!e["sort-method"]||"custom")},formatterHandle(e,t){const a=t.property;let i=e,o="",r=a&&a.split(".");return r.forEach(e=>{"object"===typeof i[e]?i=i[e]:o=i[e]}),""!==o&&null!==o&&void 0!==o?o:"-"}}},l=r,s=a("2877"),n=Object(s["a"])(l,i,o,!1,null,null,null);t["a"]=n.exports}}]);
//# sourceMappingURL=chunk-63c3d4b1.js.map